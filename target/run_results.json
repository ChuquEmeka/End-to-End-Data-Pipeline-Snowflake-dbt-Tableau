{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.9.0b1", "generated_at": "2024-10-10T08:35:07.359240Z", "invocation_id": "d6670582-ea8d-48a0-b254-4d06fc081081", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-10T08:34:56.267609Z", "completed_at": "2024-10-10T08:34:56.282728Z"}, {"name": "execute", "started_at": "2024-10-10T08:34:56.282728Z", "completed_at": "2024-10-10T08:34:57.439680Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.3138244152069092, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01b797c2-0001-9a82-0000-98f10001b242"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.dbt_transformations.dim_customer", "compiled": true, "compiled_code": "\n\nWITH customer_data AS (\n    SELECT\n        c.value:CustomerID::int AS CustomerID,\n        c.value:CustomerName::string AS CustomerName,\n        c.value:Email::string AS Email,\n        c.value:PhoneNumber::string AS PhoneNumber,\n        c.value:LoyaltyStatus::string AS LoyaltyStatus\n    FROM EMEKA_MARKET_DATA.RAW_SALES_DATA.SALES_DATA,\n    LATERAL FLATTEN(input => Customer) AS c\n)\n\nSELECT DISTINCT\n    CustomerID,  \n    CustomerName, \n    Email, \n    PhoneNumber, \n    LoyaltyStatus\nFROM customer_data", "relation_name": "EMEKA_MARKET_DATA.RAW_SALES_DATA.dim_customer", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-10T08:34:57.581433Z", "completed_at": "2024-10-10T08:34:57.602179Z"}, {"name": "execute", "started_at": "2024-10-10T08:34:57.604363Z", "completed_at": "2024-10-10T08:34:58.896709Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.4310767650604248, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01b797c2-0001-9a61-0000-98f10001a26e"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.dbt_transformations.dim_location", "compiled": true, "compiled_code": "\n\nWITH location_data AS (\n    SELECT\n        l.value:LocationID::int AS LocationID,\n        l.value:Country::string AS Country,\n        l.value:City::string AS City,\n        l.value:PostalCode::string AS PostalCode,\n        l.value:Region::string AS Region\n    FROM EMEKA_MARKET_DATA.RAW_SALES_DATA.SALES_DATA,\n    LATERAL FLATTEN(input => Location) AS l\n)\n-- Deduplicating by LocationID\nSELECT DISTINCT (LocationID) \n    LocationID, \n    Country, \n    City, \n    PostalCode, \n    Region\nFROM location_data", "relation_name": "EMEKA_MARKET_DATA.RAW_SALES_DATA.dim_location", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-10T08:34:59.012510Z", "completed_at": "2024-10-10T08:34:59.033568Z"}, {"name": "execute", "started_at": "2024-10-10T08:34:59.034578Z", "completed_at": "2024-10-10T08:35:00.091593Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.1892306804656982, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01b797c2-0001-9a5b-0000-98f100015c32"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.dbt_transformations.dim_product", "compiled": true, "compiled_code": "\n\nWITH product_data AS (\n    SELECT\n        p.value:ProductID::int AS ProductID,\n        p.value:ProductName::string AS ProductName,\n        p.value:Category::string AS Category,\n        p.value:UnitCost::float AS UnitCost,\n        p.value:UnitPrice::float AS UnitPrice\n    FROM EMEKA_MARKET_DATA.RAW_SALES_DATA.SALES_DATA,\n    LATERAL FLATTEN(input => Product) AS p\n)\n-- Deduplicating by ProductID\nSELECT DISTINCT (ProductID) \n    ProductID, \n    ProductName, \n    Category, \n    UnitCost, \n    UnitPrice\nFROM product_data", "relation_name": "EMEKA_MARKET_DATA.RAW_SALES_DATA.dim_product", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-10T08:35:00.217369Z", "completed_at": "2024-10-10T08:35:00.217369Z"}, {"name": "execute", "started_at": "2024-10-10T08:35:00.217369Z", "completed_at": "2024-10-10T08:35:01.386660Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.2791504859924316, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01b797c2-0001-9a82-0000-98f10001b246"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.dbt_transformations.dim_promotion", "compiled": true, "compiled_code": "\n\nWITH promotion_data AS (\n    SELECT\n        p.value:PromotionID::int AS PromotionID,\n        p.value:PromotionName::string AS PromotionName,\n        p.value:DiscountRate::float AS DiscountRate\n    FROM EMEKA_MARKET_DATA.RAW_SALES_DATA.SALES_DATA,\n    LATERAL FLATTEN(input => Promotion) AS p\n)\n-- Deduplicating by PromotionID\nSELECT DISTINCT (PromotionID) \n    PromotionID, \n    PromotionName, \n    DiscountRate\nFROM promotion_data", "relation_name": "EMEKA_MARKET_DATA.RAW_SALES_DATA.dim_promotion", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-10T08:35:01.496519Z", "completed_at": "2024-10-10T08:35:01.512986Z"}, {"name": "execute", "started_at": "2024-10-10T08:35:01.514799Z", "completed_at": "2024-10-10T08:35:02.448058Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.0771276950836182, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01b797c3-0001-9a5b-0000-98f100015c36"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.dbt_transformations.dim_review", "compiled": true, "compiled_code": "\n\nWITH review_data AS (\n    SELECT\n        r.value:ReviewID::int AS ReviewID,\n        r.value:ProductID::int AS ProductID,\n        r.value:CustomerID::int AS CustomerID,\n        r.value:Rating::int AS Rating,\n        r.value:Comment::string AS Comment\n    FROM EMEKA_MARKET_DATA.RAW_SALES_DATA.SALES_DATA,\n    LATERAL FLATTEN(input => Review) AS r\n)\n-- Deduplicating by ReviewID\nSELECT DISTINCT(ReviewID) \n    ReviewID, \n    ProductID, \n    CustomerID, \n    Rating, \n    Comment\nFROM review_data", "relation_name": "EMEKA_MARKET_DATA.RAW_SALES_DATA.dim_review", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-10T08:35:02.590206Z", "completed_at": "2024-10-10T08:35:02.590206Z"}, {"name": "execute", "started_at": "2024-10-10T08:35:02.590206Z", "completed_at": "2024-10-10T08:35:03.704088Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.2254457473754883, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01b797c3-0001-9a82-0000-98f10001b24a"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.dbt_transformations.dim_shipping", "compiled": true, "compiled_code": "\n\nWITH shipping_data AS (\n    SELECT\n        s.value:ShippingID::int AS ShippingID,\n        s.value:Method::string AS Method,\n        s.value:Cost::float AS Cost\n    FROM EMEKA_MARKET_DATA.RAW_SALES_DATA.SALES_DATA,\n    LATERAL FLATTEN(input => Shipping) AS s\n)\n-- Deduplicating by ShippingID\nSELECT DISTINCT(ShippingID) \n    ShippingID, \n    Method, \n    Cost\nFROM shipping_data", "relation_name": "EMEKA_MARKET_DATA.RAW_SALES_DATA.dim_shipping", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-10T08:35:03.831277Z", "completed_at": "2024-10-10T08:35:03.831277Z"}, {"name": "execute", "started_at": "2024-10-10T08:35:03.831277Z", "completed_at": "2024-10-10T08:35:05.124214Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.4194581508636475, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01b797c3-0001-9a61-0000-98f10001a272"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.dbt_transformations.fact_sales", "compiled": true, "compiled_code": "\n\nWITH sales_data AS (\n    SELECT\n        SaleID,\n        Quantity,\n        SaleDate,  -- Avoid keyword conflict by renaming\n        LocationID,\n        CustomerID,\n        ProductID,\n        PromotionID,\n        ShippingID,\n        ReviewID\n    FROM EMEKA_MARKET_DATA.RAW_SALES_DATA.SALES_DATA\n)\n\nSELECT \n    SaleID,\n    Quantity,\n    SaleDate,\n    LocationID,\n    CustomerID,\n    ProductID,\n    PromotionID,\n    ShippingID,\n    ReviewID\nFROM sales_data", "relation_name": "EMEKA_MARKET_DATA.RAW_SALES_DATA.fact_sales", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-10T08:35:05.271160Z", "completed_at": "2024-10-10T08:35:05.276157Z"}, {"name": "execute", "started_at": "2024-10-10T08:35:05.276157Z", "completed_at": "2024-10-10T08:35:07.218865Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 2.0744173526763916, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01b797c3-0001-9a61-0000-98f10001a276"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.dbt_transformations.dim_profit_cost", "compiled": true, "compiled_code": "\n\nWITH sales_data AS (\n    -- Get the necessary fields from the sales fact table\n    SELECT\n        ProductID,\n        SUM(Quantity) AS total_quantity\n    FROM EMEKA_MARKET_DATA.RAW_SALES_DATA.fact_sales\n    GROUP BY ProductID\n),\n\nproduct_data AS (\n    -- Get the necessary fields from the product dimension table\n    SELECT\n        ProductID,\n        UnitCost,\n        UnitPrice\n    FROM EMEKA_MARKET_DATA.RAW_SALES_DATA.dim_product\n)\n\n-- Join the sales data with the product data to calculate total cost, revenue, and profit\nSELECT \n    p.ProductID,\n    s.total_quantity,\n    (s.total_quantity * p.UnitPrice) AS total_revenue,\n    (s.total_quantity * p.UnitCost) AS total_cost,\n    ((s.total_quantity * p.UnitPrice) - (s.total_quantity * p.UnitCost)) AS total_profit\nFROM sales_data s\nJOIN product_data p\n    ON s.ProductID = p.ProductID", "relation_name": "EMEKA_MARKET_DATA.RAW_SALES_DATA.dim_profit_cost", "batch_results": null}], "elapsed_time": 13.126501083374023, "args": {"skip_nodes_if_on_run_start_fails": false, "use_colors": true, "log_path": "C:\\Users\\User\\Desktop\\dbt-Transformations\\logs", "show_resource_report": false, "quiet": false, "defer": false, "printer_width": 80, "require_explicit_package_overrides_for_builtin_materializations": true, "state_modified_compare_vars": false, "use_colors_file": true, "populate_cache": true, "log_level": "info", "vars": {}, "partial_parse_file_diff": true, "static_parser": true, "profiles_dir": "C:\\Users\\User\\.dbt", "project_dir": "C:\\Users\\User\\Desktop\\dbt-Transformations", "warn_error_options": {"include": [], "exclude": []}, "strict_mode": false, "source_freshness_run_project_hooks": false, "log_format_file": "debug", "log_level_file": "debug", "write_json": true, "empty": false, "require_resource_names_without_spaces": false, "favor_state": false, "print": true, "log_format": "default", "partial_parse": true, "which": "run", "select": [], "send_anonymous_usage_stats": true, "introspect": true, "invocation_command": "dbt run", "macro_debugging": false, "exclude": [], "indirect_selection": "eager", "cache_selected_only": false, "state_modified_compare_more_unrendered_values": false, "version_check": true, "log_file_max_bytes": 10485760}}