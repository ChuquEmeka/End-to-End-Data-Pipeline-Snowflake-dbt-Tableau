{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.9.0b1", "generated_at": "2024-10-10T10:17:10.863241Z", "invocation_id": "05fc2d3f-f05e-424e-b2d0-8ef52cd19c55", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-10T10:16:59.296287Z", "completed_at": "2024-10-10T10:16:59.312778Z"}, {"name": "execute", "started_at": "2024-10-10T10:16:59.313775Z", "completed_at": "2024-10-10T10:17:01.136512Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.9699923992156982, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01b79828-0001-9a76-0000-98f10001d012"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.dbt_transformations.dim_customer", "compiled": true, "compiled_code": "\n\nWITH customer_data AS (\n    SELECT\n        c.value:CustomerID::int AS CustomerID,\n        c.value:CustomerName::string AS CustomerName,\n        c.value:Email::string AS Email,\n        c.value:PhoneNumber::string AS PhoneNumber,\n        c.value:LoyaltyStatus::string AS LoyaltyStatus\n    FROM EMEKA_MARKET_DATA.RAW_SALES_DATA.SALES_DATA,\n    LATERAL FLATTEN(input => Customer) AS c\n)\n\nSELECT DISTINCT\n    CustomerID,  \n    CustomerName, \n    Email, \n    PhoneNumber, \n    LoyaltyStatus\nFROM customer_data", "relation_name": "EMEKA_MARKET_DATA.RAW_SALES_DATA.dim_customer", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-10T10:17:01.276841Z", "completed_at": "2024-10-10T10:17:01.280837Z"}, {"name": "execute", "started_at": "2024-10-10T10:17:01.281751Z", "completed_at": "2024-10-10T10:17:02.728082Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.5690972805023193, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01b79829-0001-9a8c-0000-98f10001c02a"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.dbt_transformations.dim_location", "compiled": true, "compiled_code": "\n\nWITH location_data AS (\n    SELECT\n        l.value:LocationID::int AS LocationID,\n        l.value:Country::string AS Country,\n        l.value:City::string AS City,\n        l.value:PostalCode::string AS PostalCode,\n        l.value:Region::string AS Region\n    FROM EMEKA_MARKET_DATA.RAW_SALES_DATA.SALES_DATA,\n    LATERAL FLATTEN(input => Location) AS l\n)\n-- Deduplicating by LocationID\nSELECT DISTINCT (LocationID) \n    LocationID, \n    Country, \n    City, \n    PostalCode, \n    Region\nFROM location_data", "relation_name": "EMEKA_MARKET_DATA.RAW_SALES_DATA.dim_location", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-10T10:17:02.850955Z", "completed_at": "2024-10-10T10:17:02.853997Z"}, {"name": "execute", "started_at": "2024-10-10T10:17:02.854923Z", "completed_at": "2024-10-10T10:17:04.124236Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.3995137214660645, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01b79829-0001-9a82-0000-98f10001b2d6"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.dbt_transformations.dim_product", "compiled": true, "compiled_code": "\n\nWITH product_data AS (\n    SELECT\n        p.value:ProductID::int AS ProductID,\n        p.value:ProductName::string AS ProductName,\n        p.value:Category::string AS Category,\n        p.value:UnitCost::float AS UnitCost,\n        p.value:UnitPrice::float AS UnitPrice\n    FROM EMEKA_MARKET_DATA.RAW_SALES_DATA.SALES_DATA,\n    LATERAL FLATTEN(input => Product) AS p\n)\n-- Deduplicating by ProductID\nSELECT DISTINCT (ProductID) \n    ProductID, \n    ProductName, \n    Category, \n    UnitCost, \n    UnitPrice\nFROM product_data", "relation_name": "EMEKA_MARKET_DATA.RAW_SALES_DATA.dim_product", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-10T10:17:04.259632Z", "completed_at": "2024-10-10T10:17:04.268089Z"}, {"name": "execute", "started_at": "2024-10-10T10:17:04.269182Z", "completed_at": "2024-10-10T10:17:05.206161Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.0834276676177979, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01b79829-0001-9a8c-0000-98f10001c02e"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.dbt_transformations.dim_promotion", "compiled": true, "compiled_code": "\n\nWITH promotion_data AS (\n    SELECT\n        p.value:PromotionID::int AS PromotionID,\n        p.value:PromotionName::string AS PromotionName,\n        p.value:DiscountRate::float AS DiscountRate\n    FROM EMEKA_MARKET_DATA.RAW_SALES_DATA.SALES_DATA,\n    LATERAL FLATTEN(input => Promotion) AS p\n)\n-- Deduplicating by PromotionID\nSELECT DISTINCT (PromotionID) \n    PromotionID, \n    PromotionName, \n    DiscountRate\nFROM promotion_data", "relation_name": "EMEKA_MARKET_DATA.RAW_SALES_DATA.dim_promotion", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-10T10:17:05.353654Z", "completed_at": "2024-10-10T10:17:05.358641Z"}, {"name": "execute", "started_at": "2024-10-10T10:17:05.360641Z", "completed_at": "2024-10-10T10:17:06.480809Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.2465972900390625, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01b79829-0001-9a76-0000-98f10001d016"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.dbt_transformations.dim_review", "compiled": true, "compiled_code": "\n\nWITH review_data AS (\n    SELECT\n        r.value:ReviewID::int AS ReviewID,\n        r.value:ProductID::int AS ProductID,\n        r.value:CustomerID::int AS CustomerID,\n        r.value:Rating::int AS Rating,\n        r.value:Comment::string AS Comment\n    FROM EMEKA_MARKET_DATA.RAW_SALES_DATA.SALES_DATA,\n    LATERAL FLATTEN(input => Review) AS r\n)\n-- Deduplicating by ReviewID\nSELECT DISTINCT(ReviewID) \n    ReviewID, \n    ProductID, \n    CustomerID, \n    Rating, \n    Comment\nFROM review_data", "relation_name": "EMEKA_MARKET_DATA.RAW_SALES_DATA.dim_review", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-10T10:17:06.603785Z", "completed_at": "2024-10-10T10:17:06.607781Z"}, {"name": "execute", "started_at": "2024-10-10T10:17:06.608782Z", "completed_at": "2024-10-10T10:17:07.669931Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.2023646831512451, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01b79829-0001-9a82-0000-98f10001b2da"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.dbt_transformations.dim_shipping", "compiled": true, "compiled_code": "\n\nWITH shipping_data AS (\n    SELECT\n        s.value:ShippingID::int AS ShippingID,\n        s.value:Method::string AS Method,\n        s.value:Cost::float AS Cost\n    FROM EMEKA_MARKET_DATA.RAW_SALES_DATA.SALES_DATA,\n    LATERAL FLATTEN(input => Shipping) AS s\n)\n-- Deduplicating by ShippingID\nSELECT DISTINCT(ShippingID) \n    ShippingID, \n    Method, \n    Cost\nFROM shipping_data", "relation_name": "EMEKA_MARKET_DATA.RAW_SALES_DATA.dim_shipping", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-10T10:17:07.817240Z", "completed_at": "2024-10-10T10:17:07.822249Z"}, {"name": "execute", "started_at": "2024-10-10T10:17:07.823164Z", "completed_at": "2024-10-10T10:17:09.255873Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.5664048194885254, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01b79829-0001-9a76-0000-98f10001d01a"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.dbt_transformations.fact_sales", "compiled": true, "compiled_code": "\n\nWITH sales_data AS (\n    -- Get the necessary fields from the raw sales data\n    SELECT\n        SaleID,\n        Quantity,\n        SaleDate,\n        LocationID,\n        CustomerID,\n        ProductID,\n        PromotionID,\n        ShippingID,\n        ReviewID\n    FROM EMEKA_MARKET_DATA.RAW_SALES_DATA.SALES_DATA\n),\n\nproduct_data AS (\n    -- Get the necessary fields from the product dimension table\n    SELECT\n        p.ProductID,\n        p.UnitCost,\n        p.UnitPrice\n    FROM EMEKA_MARKET_DATA.RAW_SALES_DATA.dim_product AS p\n)\n\n-- Join the sales data with the product data to calculate total cost, revenue, and profit\nSELECT \n    s.SaleID,\n    s.Quantity,\n    s.SaleDate,\n    s.LocationID,\n    s.CustomerID,\n    s.ProductID,\n    s.PromotionID,\n    s.ShippingID,\n    s.ReviewID,\n    (s.Quantity * p.UnitPrice) AS total_revenue,\n    (s.Quantity * p.UnitCost) AS total_cost,\n    ((s.Quantity * p.UnitPrice) - (s.Quantity * p.UnitCost)) AS total_profit\nFROM sales_data s\nJOIN product_data p\n    ON s.ProductID = p.ProductID", "relation_name": "EMEKA_MARKET_DATA.RAW_SALES_DATA.fact_sales", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-10T10:17:09.390469Z", "completed_at": "2024-10-10T10:17:09.396462Z"}, {"name": "execute", "started_at": "2024-10-10T10:17:09.397480Z", "completed_at": "2024-10-10T10:17:10.728360Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.4596590995788574, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01b79829-0001-9a76-0000-98f10001d01e"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.dbt_transformations.dim_profit_cost", "compiled": true, "compiled_code": "\n\nWITH sales_data AS (\n    -- Get the necessary fields from the sales fact table\n    SELECT\n        ProductID,\n        SUM(Quantity) AS total_quantity\n    FROM EMEKA_MARKET_DATA.RAW_SALES_DATA.fact_sales\n    GROUP BY ProductID\n),\n\nproduct_data AS (\n    -- Get the necessary fields from the product dimension table\n    SELECT\n        ProductID,\n        UnitCost,\n        UnitPrice\n    FROM EMEKA_MARKET_DATA.RAW_SALES_DATA.dim_product\n)\n\n-- Join the sales data with the product data to calculate total cost, revenue, and profit\nSELECT \n    p.ProductID,\n    s.total_quantity,\n    (s.total_quantity * p.UnitPrice) AS total_revenue,\n    (s.total_quantity * p.UnitCost) AS total_cost,\n    ((s.total_quantity * p.UnitPrice) - (s.total_quantity * p.UnitCost)) AS total_profit\nFROM sales_data s\nJOIN product_data p\n    ON s.ProductID = p.ProductID", "relation_name": "EMEKA_MARKET_DATA.RAW_SALES_DATA.dim_profit_cost", "batch_results": null}], "elapsed_time": 13.50036072731018, "args": {"project_dir": "C:\\Users\\User\\Desktop\\dbt-Transformations", "profiles_dir": "C:\\Users\\User\\.dbt", "printer_width": 80, "log_path": "C:\\Users\\User\\Desktop\\dbt-Transformations\\logs", "defer": false, "log_file_max_bytes": 10485760, "which": "run", "print": true, "vars": {}, "warn_error_options": {"include": [], "exclude": []}, "send_anonymous_usage_stats": true, "partial_parse_file_diff": true, "require_resource_names_without_spaces": false, "write_json": true, "populate_cache": true, "state_modified_compare_vars": false, "state_modified_compare_more_unrendered_values": false, "skip_nodes_if_on_run_start_fails": false, "invocation_command": "dbt run", "empty": false, "strict_mode": false, "log_level": "info", "select": [], "favor_state": false, "source_freshness_run_project_hooks": false, "exclude": [], "introspect": true, "log_format_file": "debug", "static_parser": true, "show_resource_report": false, "use_colors_file": true, "log_level_file": "debug", "require_explicit_package_overrides_for_builtin_materializations": true, "cache_selected_only": false, "indirect_selection": "eager", "log_format": "default", "quiet": false, "use_colors": true, "version_check": true, "partial_parse": true, "macro_debugging": false}}