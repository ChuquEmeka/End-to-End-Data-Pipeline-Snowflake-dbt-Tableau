[0m15:53:10.656452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7F4122410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7F6079090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7F6078E80>]}


============================== 15:53:10.662934 | f7954437-3890-4cef-8be5-0be6c2d5cbd9 ==============================
[0m15:53:10.662934 [info ] [MainThread]: Running with dbt=1.9.0-b1
[0m15:53:10.664927 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'logs', 'profiles_dir': 'C:\\Users\\User\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt init emekamarkt', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:53:10.695824 [warn ] [MainThread]: [ConfigFolderDirectory]: Unable to parse dict {'dir': WindowsPath('C:/Users/User/.dbt')}
[0m15:53:10.696824 [info ] [MainThread]: Creating dbt configuration folder at 
[0m15:53:10.699824 [debug] [MainThread]: Starter project path: C:\Users\User\Desktop\dbt-Transformations\dbt-env\lib\site-packages\dbt\include\starter_project
[0m15:53:10.776326 [info ] [MainThread]: 
Your new dbt project "emekamarkt" was created!

For more information on how to configure the profiles.yml file,
please consult the dbt documentation here:

  https://docs.getdbt.com/docs/configure-your-profile

One more thing:

Need help? Don't hesitate to reach out to us via GitHub issues or on Slack:

  https://community.getdbt.com/

Happy modeling!

[0m15:53:10.779328 [info ] [MainThread]: Setting up your profile.
[0m15:53:59.039612 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m15:53:59.040619 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m15:58:41.640635 [info ] [MainThread]: Profile emekamarkt written to C:\Users\User\.dbt\profiles.yml using target's profile_template.yml and your supplied values. Run 'dbt debug' to validate the connection.
[0m15:58:41.642649 [debug] [MainThread]: Command `dbt init` succeeded at 15:58:41.642649 after 331.09 seconds
[0m15:58:41.644636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7F4122410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7F60A3E50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7F6078DC0>]}
[0m15:58:41.645638 [debug] [MainThread]: Flushing usage events
[0m15:58:42.201305 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:59:34.591608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F92C67E410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F92E607AC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F92E607D30>]}


============================== 15:59:34.595531 | aaa2e98e-05e3-4cc7-8231-e8cf8e548a0a ==============================
[0m15:59:34.595531 [info ] [MainThread]: Running with dbt=1.9.0-b1
[0m15:59:34.597527 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\User\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:59:34.625055 [info ] [MainThread]: dbt version: 1.9.0-b1
[0m15:59:34.625850 [info ] [MainThread]: python version: 3.10.7
[0m15:59:34.627262 [info ] [MainThread]: python path: C:\Users\User\Desktop\dbt-Transformations\dbt-env\Scripts\python.exe
[0m15:59:34.628274 [info ] [MainThread]: os info: Windows-10-10.0.22631-SP0
[0m15:59:34.780717 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m15:59:34.781694 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m15:59:34.831623 [info ] [MainThread]: Using profiles dir at C:\Users\User\.dbt
[0m15:59:34.833539 [info ] [MainThread]: Using profiles.yml file at C:\Users\User\.dbt\profiles.yml
[0m15:59:34.834542 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\User\Desktop\dbt-Transformations\dbt_project.yml
[0m15:59:34.836289 [info ] [MainThread]: adapter type: redshift
[0m15:59:34.837295 [info ] [MainThread]: adapter version: 1.8.1
[0m15:59:34.838328 [info ] [MainThread]: Configuration:
[0m15:59:34.839328 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m15:59:34.840348 [info ] [MainThread]:   dbt_project.yml file [[31mERROR not found[0m]
[0m15:59:34.841313 [info ] [MainThread]: Required dependencies:
[0m15:59:34.842296 [debug] [MainThread]: Executing "git --help"
[0m15:59:34.868298 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m15:59:34.870301 [debug] [MainThread]: STDERR: "b''"
[0m15:59:34.871297 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m15:59:34.872303 [info ] [MainThread]: Connection:
[0m15:59:34.873297 [info ] [MainThread]:   host: default-workgroup.863518444424.eu-north-1.redshift-serverless.amazonaws.com
[0m15:59:34.874435 [info ] [MainThread]:   user: admin
[0m15:59:34.875721 [info ] [MainThread]:   port: 5439
[0m15:59:34.876519 [info ] [MainThread]:   database: dev
[0m15:59:34.877528 [info ] [MainThread]:   method: database
[0m15:59:34.878526 [info ] [MainThread]:   cluster_id: None
[0m15:59:34.879526 [info ] [MainThread]:   iam_profile: None
[0m15:59:34.880525 [info ] [MainThread]:   schema: public
[0m15:59:34.881525 [info ] [MainThread]:   sslmode: prefer
[0m15:59:34.882526 [info ] [MainThread]:   region: None
[0m15:59:34.883572 [info ] [MainThread]:   sslmode: prefer
[0m15:59:34.884567 [info ] [MainThread]:   region: None
[0m15:59:34.884567 [info ] [MainThread]:   iam_profile: None
[0m15:59:34.885562 [info ] [MainThread]:   autocreate: False
[0m15:59:34.886526 [info ] [MainThread]:   db_groups: []
[0m15:59:34.887528 [info ] [MainThread]:   ra3_node: False
[0m15:59:34.887528 [info ] [MainThread]:   connect_timeout: None
[0m15:59:34.888529 [info ] [MainThread]:   role: None
[0m15:59:34.890825 [info ] [MainThread]:   retries: 1
[0m15:59:34.891770 [info ] [MainThread]:   autocommit: True
[0m15:59:34.892770 [info ] [MainThread]: Registered adapter: redshift=1.8.1
[0m15:59:34.895970 [debug] [MainThread]: Acquiring new redshift connection 'debug'
[0m15:59:34.900864 [debug] [MainThread]: Using redshift connection "debug"
[0m15:59:34.901807 [debug] [MainThread]: On debug: select 1 as id
[0m15:59:34.901807 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:59:34.905868 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:59:34.906861 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:59:56.237952 [debug] [MainThread]: Redshift adapter: Got a retryable error when attempting to open a redshift connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
('connection time out', TimeoutError(10060, 'A connection attempt failed because the connected party did not properly respond after a period of time, or established connection failed because connected host has failed to respond', None, 10060, None))
[0m15:59:56.239991 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m16:00:17.289264 [debug] [MainThread]: Redshift adapter: Error running SQL: select 1 as id
[0m16:00:17.290266 [debug] [MainThread]: Redshift adapter: Rolling back transaction.
[0m16:00:17.291731 [debug] [MainThread]: On debug: No close available on handle
[0m16:00:17.292826 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m16:00:17.294750 [info ] [MainThread]: [31m2 checks failed:[0m
[0m16:00:17.295170 [info ] [MainThread]: Project loading failed for the following reason:
 project path <C:\Users\User\Desktop\dbt-Transformations\dbt_project.yml> not found

[0m16:00:17.297180 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  ('connection time out', TimeoutError(10060, 'A connection attempt failed because the connected party did not properly respond after a period of time, or established connection failed because connected host has failed to respond', None, 10060, None))

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m16:00:17.301178 [debug] [MainThread]: Command `dbt debug` failed at 16:00:17.301178 after 42.79 seconds
[0m16:00:17.302181 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m16:00:17.303178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F92C67E410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F92E447460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F92E5D0940>]}
[0m16:00:17.304182 [debug] [MainThread]: Flushing usage events
[0m16:00:17.829366 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:03:09.705277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001896658E350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001896851BAC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001896851BCA0>]}


============================== 16:03:09.710370 | 0bea5d76-e7cb-40bf-978d-67aa894ebb8d ==============================
[0m16:03:09.710370 [info ] [MainThread]: Running with dbt=1.9.0-b1
[0m16:03:09.712275 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\User\\.dbt', 'log_path': 'C:\\Users\\User\\Desktop\\dbt-Transformations\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m16:03:09.747356 [info ] [MainThread]: dbt version: 1.9.0-b1
[0m16:03:09.748361 [info ] [MainThread]: python version: 3.10.7
[0m16:03:09.749352 [info ] [MainThread]: python path: C:\Users\User\Desktop\dbt-Transformations\dbt-env\Scripts\python.exe
[0m16:03:09.750358 [info ] [MainThread]: os info: Windows-10-10.0.22631-SP0
[0m16:03:09.956023 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m16:03:09.957136 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m16:03:10.013282 [info ] [MainThread]: Using profiles dir at C:\Users\User\.dbt
[0m16:03:10.015166 [info ] [MainThread]: Using profiles.yml file at C:\Users\User\.dbt\profiles.yml
[0m16:03:10.016163 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\User\Desktop\dbt-Transformations\dbt_project.yml
[0m16:03:10.018186 [info ] [MainThread]: adapter type: redshift
[0m16:03:10.019170 [info ] [MainThread]: adapter version: 1.8.1
[0m16:03:10.024158 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m16:03:10.026168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '0bea5d76-e7cb-40bf-978d-67aa894ebb8d', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018968DB5C60>]}
[0m16:03:10.128713 [info ] [MainThread]: Configuration:
[0m16:03:10.129640 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m16:03:10.130676 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m16:03:10.132076 [info ] [MainThread]: Required dependencies:
[0m16:03:10.133087 [debug] [MainThread]: Executing "git --help"
[0m16:03:10.158556 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m16:03:10.159564 [debug] [MainThread]: STDERR: "b''"
[0m16:03:10.160554 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m16:03:10.161555 [info ] [MainThread]: Connection:
[0m16:03:10.163550 [info ] [MainThread]:   host: default-workgroup.863518444424.eu-north-1.redshift-serverless.amazonaws.com
[0m16:03:10.164716 [info ] [MainThread]:   user: admin
[0m16:03:10.165736 [info ] [MainThread]:   port: 5439
[0m16:03:10.166782 [info ] [MainThread]:   database: dev
[0m16:03:10.167731 [info ] [MainThread]:   method: database
[0m16:03:10.168828 [info ] [MainThread]:   cluster_id: None
[0m16:03:10.169733 [info ] [MainThread]:   iam_profile: None
[0m16:03:10.170842 [info ] [MainThread]:   schema: public
[0m16:03:10.171734 [info ] [MainThread]:   sslmode: prefer
[0m16:03:10.173737 [info ] [MainThread]:   region: None
[0m16:03:10.174728 [info ] [MainThread]:   sslmode: prefer
[0m16:03:10.175732 [info ] [MainThread]:   region: None
[0m16:03:10.177730 [info ] [MainThread]:   iam_profile: None
[0m16:03:10.178745 [info ] [MainThread]:   autocreate: False
[0m16:03:10.179730 [info ] [MainThread]:   db_groups: []
[0m16:03:10.181730 [info ] [MainThread]:   ra3_node: False
[0m16:03:10.182781 [info ] [MainThread]:   connect_timeout: None
[0m16:03:10.183794 [info ] [MainThread]:   role: None
[0m16:03:10.184728 [info ] [MainThread]:   retries: 1
[0m16:03:10.185736 [info ] [MainThread]:   autocommit: True
[0m16:03:10.187727 [info ] [MainThread]: Registered adapter: redshift=1.8.1
[0m16:03:10.189733 [debug] [MainThread]: Acquiring new redshift connection 'debug'
[0m16:03:10.193727 [debug] [MainThread]: Using redshift connection "debug"
[0m16:03:10.194729 [debug] [MainThread]: On debug: select 1 as id
[0m16:03:10.195739 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:03:10.202730 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m16:03:10.204823 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m16:03:31.492777 [debug] [MainThread]: Redshift adapter: Got a retryable error when attempting to open a redshift connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
('connection time out', TimeoutError(10060, 'A connection attempt failed because the connected party did not properly respond after a period of time, or established connection failed because connected host has failed to respond', None, 10060, None))
[0m16:03:31.493762 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m16:03:52.557426 [debug] [MainThread]: Redshift adapter: Error running SQL: select 1 as id
[0m16:03:52.559515 [debug] [MainThread]: Redshift adapter: Rolling back transaction.
[0m16:03:52.560517 [debug] [MainThread]: On debug: No close available on handle
[0m16:03:52.562529 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m16:03:52.564423 [info ] [MainThread]: [31m1 check failed:[0m
[0m16:03:52.566306 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  ('connection time out', TimeoutError(10060, 'A connection attempt failed because the connected party did not properly respond after a period of time, or established connection failed because connected host has failed to respond', None, 10060, None))

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m16:03:52.570580 [debug] [MainThread]: Command `dbt debug` failed at 16:03:52.570580 after 42.95 seconds
[0m16:03:52.571588 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m16:03:52.572544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001896658E350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018968DCC6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000189678CCC40>]}
[0m16:03:52.573809 [debug] [MainThread]: Flushing usage events
[0m16:03:56.193622 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:00:15.029649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230CF48E2B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230D108A7C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230D108A2E0>]}


============================== 09:00:15.036694 | c8be2098-5a28-4560-985e-e61bb719ec88 ==============================
[0m09:00:15.036694 [info ] [MainThread]: Running with dbt=1.9.0-b1
[0m09:00:15.037608 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\User\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\User\\Desktop\\dbt-Transformations\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt debug', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:00:15.074925 [info ] [MainThread]: dbt version: 1.9.0-b1
[0m09:00:15.075944 [info ] [MainThread]: python version: 3.9.12
[0m09:00:15.075944 [info ] [MainThread]: python path: C:\Users\User\anaconda3\python.exe
[0m09:00:15.076926 [info ] [MainThread]: os info: Windows-10-10.0.22631-SP0
[0m09:00:15.492647 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m09:00:15.493734 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m09:00:15.559814 [info ] [MainThread]: Using profiles dir at C:\Users\User\.dbt
[0m09:00:15.560724 [info ] [MainThread]: Using profiles.yml file at C:\Users\User\.dbt\profiles.yml
[0m09:00:15.561731 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\User\Desktop\dbt-Transformations\dbt_project.yml
[0m09:00:15.564063 [info ] [MainThread]: adapter type: redshift
[0m09:00:15.564619 [info ] [MainThread]: adapter version: 1.8.1
[0m09:00:15.568717 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m09:00:15.569627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'c8be2098-5a28-4560-985e-e61bb719ec88', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230D18AABE0>]}
[0m09:00:15.664834 [info ] [MainThread]: Configuration:
[0m09:00:15.665477 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m09:00:15.666494 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m09:00:15.667176 [info ] [MainThread]: Required dependencies:
[0m09:00:15.668062 [debug] [MainThread]: Executing "git --help"
[0m09:00:15.697874 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m09:00:15.697874 [debug] [MainThread]: STDERR: "b''"
[0m09:00:15.698967 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m09:00:15.699980 [info ] [MainThread]: Connection:
[0m09:00:15.700983 [info ] [MainThread]:   host: default-workgroup.863518444424.eu-north-1.redshift-serverless.amazonaws.com
[0m09:00:15.700983 [info ] [MainThread]:   user: admin
[0m09:00:15.703009 [info ] [MainThread]:   port: 5439
[0m09:00:15.703976 [info ] [MainThread]:   database: dev
[0m09:00:15.704975 [info ] [MainThread]:   method: database
[0m09:00:15.705974 [info ] [MainThread]:   cluster_id: None
[0m09:00:15.706973 [info ] [MainThread]:   iam_profile: None
[0m09:00:15.707994 [info ] [MainThread]:   schema: public
[0m09:00:15.708975 [info ] [MainThread]:   sslmode: prefer
[0m09:00:15.710974 [info ] [MainThread]:   region: None
[0m09:00:15.712980 [info ] [MainThread]:   sslmode: prefer
[0m09:00:15.715500 [info ] [MainThread]:   region: None
[0m09:00:15.716499 [info ] [MainThread]:   iam_profile: None
[0m09:00:15.717527 [info ] [MainThread]:   autocreate: False
[0m09:00:15.718499 [info ] [MainThread]:   db_groups: []
[0m09:00:15.719493 [info ] [MainThread]:   ra3_node: False
[0m09:00:15.720507 [info ] [MainThread]:   connect_timeout: None
[0m09:00:15.721505 [info ] [MainThread]:   role: None
[0m09:00:15.722507 [info ] [MainThread]:   retries: 1
[0m09:00:15.723503 [info ] [MainThread]:   autocommit: True
[0m09:00:15.724504 [info ] [MainThread]: Registered adapter: redshift=1.8.1
[0m09:00:15.725530 [debug] [MainThread]: Acquiring new redshift connection 'debug'
[0m09:00:15.732522 [debug] [MainThread]: Using redshift connection "debug"
[0m09:00:15.733585 [debug] [MainThread]: On debug: select 1 as id
[0m09:00:15.734503 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:00:15.738501 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m09:00:15.740501 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m09:00:17.593580 [debug] [MainThread]: SQL status: SUCCESS in 1.859 seconds
[0m09:00:17.596482 [debug] [MainThread]: On debug: Close
[0m09:00:17.597522 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m09:00:17.598443 [info ] [MainThread]: [32mAll checks passed![0m
[0m09:00:17.601444 [debug] [MainThread]: Command `dbt debug` succeeded at 09:00:17.600439 after 2.67 seconds
[0m09:00:17.601444 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m09:00:17.602451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230CF48E2B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230D18AA370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230D190EC10>]}
[0m09:00:17.603451 [debug] [MainThread]: Flushing usage events
[0m09:00:18.164349 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:31:58.384856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001949E0EE410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194A001D180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194A001CFA0>]}


============================== 09:31:58.391760 | 6937e5f9-5089-4786-97b6-1ab1bd8592ec ==============================
[0m09:31:58.391760 [info ] [MainThread]: Running with dbt=1.9.0-b1
[0m09:31:58.392707 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\User\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\User\\Desktop\\dbt-Transformations\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m09:32:01.003726 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m09:32:01.004830 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m09:32:01.104755 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m09:32:01.105345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '6937e5f9-5089-4786-97b6-1ab1bd8592ec', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194A090A290>]}
[0m09:32:01.275832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6937e5f9-5089-4786-97b6-1ab1bd8592ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194A08DCF10>]}
[0m09:32:01.328348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6937e5f9-5089-4786-97b6-1ab1bd8592ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194A0747370>]}
[0m09:32:01.331348 [info ] [MainThread]: Registered adapter: redshift=1.8.1
[0m09:32:01.375773 [debug] [MainThread]: checksum: 342eadeaabeb3b1e51584f606df2b5b2518c39ec1d5d83f52b4bb1c68a4f38ed, vars: {}, profile: , target: , version: 1.9.0b1
[0m09:32:01.378378 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m09:32:01.380378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '6937e5f9-5089-4786-97b6-1ab1bd8592ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194A0A03E80>]}
[0m09:32:03.408130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6937e5f9-5089-4786-97b6-1ab1bd8592ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194A0BC29B0>]}
[0m09:32:03.531740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6937e5f9-5089-4786-97b6-1ab1bd8592ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194A0B95ED0>]}
[0m09:32:03.532726 [info ] [MainThread]: Found 489 macros
[0m09:32:03.533728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6937e5f9-5089-4786-97b6-1ab1bd8592ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194A0B95000>]}
[0m09:32:03.535725 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m09:32:03.537159 [debug] [MainThread]: Command end result
[0m09:32:03.568715 [debug] [MainThread]: Command `dbt run` succeeded at 09:32:03.567710 after 5.27 seconds
[0m09:32:03.569712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001949E0EE410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001949E45F940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194A0BC3D60>]}
[0m09:32:03.570227 [debug] [MainThread]: Flushing usage events
[0m09:32:04.124581 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:34:20.037849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D21FBE440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D23EED1B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D23EECFD0>]}


============================== 09:34:20.042084 | ef1c2ebc-7c51-4edd-bfab-c20d130ef127 ==============================
[0m09:34:20.042084 [info ] [MainThread]: Running with dbt=1.9.0-b1
[0m09:34:20.044086 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\User\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\User\\Desktop\\dbt-Transformations\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m09:34:20.221761 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m09:34:20.222756 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m09:34:20.384935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ef1c2ebc-7c51-4edd-bfab-c20d130ef127', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D2086EC20>]}
[0m09:34:20.436937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ef1c2ebc-7c51-4edd-bfab-c20d130ef127', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D246173A0>]}
[0m09:34:20.439483 [info ] [MainThread]: Registered adapter: redshift=1.8.1
[0m09:34:20.451583 [debug] [MainThread]: checksum: 342eadeaabeb3b1e51584f606df2b5b2518c39ec1d5d83f52b4bb1c68a4f38ed, vars: {}, profile: , target: , version: 1.9.0b1
[0m09:34:20.512451 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m09:34:20.513279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ef1c2ebc-7c51-4edd-bfab-c20d130ef127', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D23A0B3D0>]}
[0m09:34:21.379017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ef1c2ebc-7c51-4edd-bfab-c20d130ef127', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D248D6650>]}
[0m09:34:21.435580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ef1c2ebc-7c51-4edd-bfab-c20d130ef127', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D24A14E20>]}
[0m09:34:21.435580 [info ] [MainThread]: Found 489 macros
[0m09:34:21.437583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ef1c2ebc-7c51-4edd-bfab-c20d130ef127', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D24A15570>]}
[0m09:34:21.438673 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m09:34:21.440685 [debug] [MainThread]: Command end result
[0m09:34:21.470299 [debug] [MainThread]: Command `dbt run` succeeded at 09:34:21.470299 after 1.52 seconds
[0m09:34:21.471300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D21FBE440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D22329030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D249F89A0>]}
[0m09:34:21.472414 [debug] [MainThread]: Flushing usage events
[0m09:34:21.968230 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:37:10.296313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D6D26E3E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D6F19D0F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D6F19CF10>]}


============================== 09:37:10.300322 | 65bab0c5-47e5-44fe-b56f-a648498082cf ==============================
[0m09:37:10.300322 [info ] [MainThread]: Running with dbt=1.9.0-b1
[0m09:37:10.301319 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\User\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\User\\Desktop\\dbt-Transformations\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:37:10.467850 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m09:37:10.468850 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m09:37:10.628704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '65bab0c5-47e5-44fe-b56f-a648498082cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D6BB1FB50>]}
[0m09:37:10.681298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '65bab0c5-47e5-44fe-b56f-a648498082cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D6FA5F160>]}
[0m09:37:10.683049 [info ] [MainThread]: Registered adapter: redshift=1.8.1
[0m09:37:10.693783 [debug] [MainThread]: checksum: 342eadeaabeb3b1e51584f606df2b5b2518c39ec1d5d83f52b4bb1c68a4f38ed, vars: {}, profile: , target: , version: 1.9.0b1
[0m09:37:10.825219 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:37:10.826225 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:37:10.831215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '65bab0c5-47e5-44fe-b56f-a648498082cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D6FDE0130>]}
[0m09:37:10.895937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '65bab0c5-47e5-44fe-b56f-a648498082cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D6FDBFB80>]}
[0m09:37:10.897927 [info ] [MainThread]: Found 489 macros
[0m09:37:10.898927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '65bab0c5-47e5-44fe-b56f-a648498082cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D6FDBFD30>]}
[0m09:37:10.900930 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m09:37:10.904928 [debug] [MainThread]: Command end result
[0m09:37:10.944426 [debug] [MainThread]: Command `dbt run` succeeded at 09:37:10.944426 after 0.72 seconds
[0m09:37:10.946440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D6D26E3E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D6FB82440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D6E5BB3A0>]}
[0m09:37:10.947439 [debug] [MainThread]: Flushing usage events
[0m09:37:11.469471 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:08:55.635974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002081DB8E280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002081F78A490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002081F7530D0>]}


============================== 10:08:55.639949 | c78951ac-394c-4b01-a140-a0ff52d8707c ==============================
[0m10:08:55.639949 [info ] [MainThread]: Running with dbt=1.9.0-b1
[0m10:08:55.641893 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\User\\Desktop\\dbt-Transformations\\logs', 'profiles_dir': 'C:\\Users\\User\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt debug', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:08:55.668320 [info ] [MainThread]: dbt version: 1.9.0-b1
[0m10:08:55.669719 [info ] [MainThread]: python version: 3.9.12
[0m10:08:55.670631 [info ] [MainThread]: python path: C:\Users\User\anaconda3\python.exe
[0m10:08:55.671644 [info ] [MainThread]: os info: Windows-10-10.0.22631-SP0
[0m10:08:55.965116 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m10:08:55.966116 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m10:08:56.019258 [info ] [MainThread]: Using profiles dir at C:\Users\User\.dbt
[0m10:08:56.019885 [info ] [MainThread]: Using profiles.yml file at C:\Users\User\.dbt\profiles.yml
[0m10:08:56.020578 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\User\Desktop\dbt-Transformations\dbt_project.yml
[0m10:08:56.023589 [info ] [MainThread]: adapter type: redshift
[0m10:08:56.024585 [info ] [MainThread]: adapter version: 1.8.1
[0m10:08:56.119380 [info ] [MainThread]: Configuration:
[0m10:08:56.120915 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m10:08:56.121923 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m10:08:56.123948 [info ] [MainThread]: Required dependencies:
[0m10:08:56.124675 [debug] [MainThread]: Executing "git --help"
[0m10:08:56.147659 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m10:08:56.148762 [debug] [MainThread]: STDERR: "b''"
[0m10:08:56.149658 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m10:08:56.150293 [info ] [MainThread]: Connection:
[0m10:08:56.152308 [info ] [MainThread]:   host: default-workgroup.863518444424.eu-north-1.redshift-serverless.amazonaws.com
[0m10:08:56.153303 [info ] [MainThread]:   user: admin
[0m10:08:56.154304 [info ] [MainThread]:   port: 5439
[0m10:08:56.155301 [info ] [MainThread]:   database: dev
[0m10:08:56.156301 [info ] [MainThread]:   method: database
[0m10:08:56.157302 [info ] [MainThread]:   cluster_id: None
[0m10:08:56.158300 [info ] [MainThread]:   iam_profile: None
[0m10:08:56.158300 [info ] [MainThread]:   schema: public
[0m10:08:56.159325 [info ] [MainThread]:   sslmode: prefer
[0m10:08:56.160302 [info ] [MainThread]:   region: None
[0m10:08:56.161299 [info ] [MainThread]:   sslmode: prefer
[0m10:08:56.162316 [info ] [MainThread]:   region: None
[0m10:08:56.163303 [info ] [MainThread]:   iam_profile: None
[0m10:08:56.164320 [info ] [MainThread]:   autocreate: False
[0m10:08:56.165308 [info ] [MainThread]:   db_groups: []
[0m10:08:56.167302 [info ] [MainThread]:   ra3_node: False
[0m10:08:56.168318 [info ] [MainThread]:   connect_timeout: None
[0m10:08:56.169311 [info ] [MainThread]:   role: None
[0m10:08:56.169311 [info ] [MainThread]:   retries: 1
[0m10:08:56.170308 [info ] [MainThread]:   autocommit: True
[0m10:08:56.171308 [info ] [MainThread]: Registered adapter: redshift=1.8.1
[0m10:08:56.172308 [debug] [MainThread]: Acquiring new redshift connection 'debug'
[0m10:08:56.178326 [debug] [MainThread]: Using redshift connection "debug"
[0m10:08:56.178326 [debug] [MainThread]: On debug: select 1 as id
[0m10:08:56.179311 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:08:56.183563 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m10:08:56.189561 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m10:08:56.891988 [debug] [MainThread]: Redshift adapter: Error running SQL: select 1 as id
[0m10:08:56.892988 [debug] [MainThread]: Redshift adapter: Rolling back transaction.
[0m10:08:56.893990 [debug] [MainThread]: On debug: No close available on handle
[0m10:08:56.894991 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m10:08:56.900338 [info ] [MainThread]: [31m1 check failed:[0m
[0m10:08:56.901338 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  {'S': 'FATAL', 'C': '28000', 'M': 'password authentication failed for user "admin"', 'F': '/home/ec2-user/padb/src/pg/src/backend/libpq/auth.c', 'L': '425', 'R': 'auth_failed'}

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m10:08:56.904339 [debug] [MainThread]: Command `dbt debug` failed at 10:08:56.904339 after 1.36 seconds
[0m10:08:56.906809 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m10:08:56.907865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002081DB8E280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002082001A460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002082E3D0970>]}
[0m10:08:56.908817 [debug] [MainThread]: Flushing usage events
[0m10:08:57.442024 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:13:48.363233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B7153E310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B7313AA30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B73172FA0>]}


============================== 10:13:48.368233 | 28fbc263-4d1f-402f-b032-ae34d015a8c3 ==============================
[0m10:13:48.368233 [info ] [MainThread]: Running with dbt=1.9.0-b1
[0m10:13:48.370236 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\User\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\User\\Desktop\\dbt-Transformations\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt debug', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:13:48.400571 [info ] [MainThread]: dbt version: 1.9.0-b1
[0m10:13:48.402587 [info ] [MainThread]: python version: 3.9.12
[0m10:13:48.403571 [info ] [MainThread]: python path: C:\Users\User\anaconda3\python.exe
[0m10:13:48.404579 [info ] [MainThread]: os info: Windows-10-10.0.22631-SP0
[0m10:13:48.697829 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m10:13:48.697829 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m10:13:48.750974 [info ] [MainThread]: Using profiles dir at C:\Users\User\.dbt
[0m10:13:48.752327 [info ] [MainThread]: Using profiles.yml file at C:\Users\User\.dbt\profiles.yml
[0m10:13:48.753345 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\User\Desktop\dbt-Transformations\dbt_project.yml
[0m10:13:48.755888 [info ] [MainThread]: adapter type: redshift
[0m10:13:48.756897 [info ] [MainThread]: adapter version: 1.8.1
[0m10:13:48.855684 [info ] [MainThread]: Configuration:
[0m10:13:48.857106 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m10:13:48.858196 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m10:13:48.859205 [info ] [MainThread]: Required dependencies:
[0m10:13:48.860310 [debug] [MainThread]: Executing "git --help"
[0m10:13:48.884308 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m10:13:48.885203 [debug] [MainThread]: STDERR: "b''"
[0m10:13:48.885203 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m10:13:48.887721 [info ] [MainThread]: Connection:
[0m10:13:48.888721 [info ] [MainThread]:   host: default-workgroup.863518444424.eu-north-1.redshift-serverless.amazonaws.com
[0m10:13:48.889717 [info ] [MainThread]:   user: admin
[0m10:13:48.890724 [info ] [MainThread]:   port: 5439
[0m10:13:48.893137 [info ] [MainThread]:   database: dev
[0m10:13:48.894141 [info ] [MainThread]:   method: database
[0m10:13:48.895137 [info ] [MainThread]:   cluster_id: None
[0m10:13:48.896135 [info ] [MainThread]:   iam_profile: None
[0m10:13:48.897133 [info ] [MainThread]:   schema: public
[0m10:13:48.898132 [info ] [MainThread]:   sslmode: prefer
[0m10:13:48.899138 [info ] [MainThread]:   region: None
[0m10:13:48.900137 [info ] [MainThread]:   sslmode: prefer
[0m10:13:48.901144 [info ] [MainThread]:   region: None
[0m10:13:48.902132 [info ] [MainThread]:   iam_profile: None
[0m10:13:48.903130 [info ] [MainThread]:   autocreate: False
[0m10:13:48.904138 [info ] [MainThread]:   db_groups: []
[0m10:13:48.904138 [info ] [MainThread]:   ra3_node: False
[0m10:13:48.905150 [info ] [MainThread]:   connect_timeout: None
[0m10:13:48.906176 [info ] [MainThread]:   role: None
[0m10:13:48.907157 [info ] [MainThread]:   retries: 1
[0m10:13:48.908159 [info ] [MainThread]:   autocommit: True
[0m10:13:48.909158 [info ] [MainThread]: Registered adapter: redshift=1.8.1
[0m10:13:48.911155 [debug] [MainThread]: Acquiring new redshift connection 'debug'
[0m10:13:48.917342 [debug] [MainThread]: Using redshift connection "debug"
[0m10:13:48.918349 [debug] [MainThread]: On debug: select 1 as id
[0m10:13:48.918349 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:13:48.922875 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m10:13:48.923877 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m10:13:50.497374 [debug] [MainThread]: Redshift adapter: Error running SQL: select 1 as id
[0m10:13:50.498374 [debug] [MainThread]: Redshift adapter: Rolling back transaction.
[0m10:13:50.499357 [debug] [MainThread]: On debug: No close available on handle
[0m10:13:50.500357 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m10:13:50.500828 [info ] [MainThread]: [31m1 check failed:[0m
[0m10:13:50.501688 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  {'S': 'FATAL', 'C': '28000', 'M': 'password authentication failed for user "admin"', 'F': '/home/ec2-user/padb/src/pg/src/backend/libpq/auth.c', 'L': '425', 'R': 'auth_failed'}

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m10:13:50.504718 [debug] [MainThread]: Command `dbt debug` failed at 10:13:50.503703 after 2.22 seconds
[0m10:13:50.504718 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m10:13:50.505700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B7153E310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B739CA760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B7FD80A30>]}
[0m10:13:50.506702 [debug] [MainThread]: Flushing usage events
[0m10:13:51.005123 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:14:58.305605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A1604DE310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A1620DA940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A1620DAC70>]}


============================== 10:14:58.310697 | d2645c5a-82dc-4ba3-9111-bb6f08429a80 ==============================
[0m10:14:58.310697 [info ] [MainThread]: Running with dbt=1.9.0-b1
[0m10:14:58.311647 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\User\\Desktop\\dbt-Transformations\\logs', 'profiles_dir': 'C:\\Users\\User\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m10:14:58.337392 [info ] [MainThread]: dbt version: 1.9.0-b1
[0m10:14:58.338788 [info ] [MainThread]: python version: 3.9.12
[0m10:14:58.340099 [info ] [MainThread]: python path: C:\Users\User\anaconda3\python.exe
[0m10:14:58.341108 [info ] [MainThread]: os info: Windows-10-10.0.22631-SP0
[0m10:14:58.644473 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m10:14:58.645482 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m10:14:58.701668 [info ] [MainThread]: Using profiles dir at C:\Users\User\.dbt
[0m10:14:58.703517 [info ] [MainThread]: Using profiles.yml file at C:\Users\User\.dbt\profiles.yml
[0m10:14:58.704537 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\User\Desktop\dbt-Transformations\dbt_project.yml
[0m10:14:58.706484 [info ] [MainThread]: adapter type: redshift
[0m10:14:58.707493 [info ] [MainThread]: adapter version: 1.8.1
[0m10:14:58.806207 [info ] [MainThread]: Configuration:
[0m10:14:58.807112 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m10:14:58.808473 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m10:14:58.809484 [info ] [MainThread]: Required dependencies:
[0m10:14:58.810481 [debug] [MainThread]: Executing "git --help"
[0m10:14:58.833886 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m10:14:58.834933 [debug] [MainThread]: STDERR: "b''"
[0m10:14:58.835904 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m10:14:58.837157 [info ] [MainThread]: Connection:
[0m10:14:58.838115 [info ] [MainThread]:   host: default-workgroup.863518444424.eu-north-1.redshift-serverless.amazonaws.com
[0m10:14:58.839125 [info ] [MainThread]:   user: admin
[0m10:14:58.840121 [info ] [MainThread]:   port: 5439
[0m10:14:58.841122 [info ] [MainThread]:   database: dev
[0m10:14:58.842124 [info ] [MainThread]:   method: database
[0m10:14:58.843125 [info ] [MainThread]:   cluster_id: None
[0m10:14:58.843125 [info ] [MainThread]:   iam_profile: None
[0m10:14:58.844393 [info ] [MainThread]:   schema: public
[0m10:14:58.845408 [info ] [MainThread]:   sslmode: prefer
[0m10:14:58.846409 [info ] [MainThread]:   region: None
[0m10:14:58.848413 [info ] [MainThread]:   sslmode: prefer
[0m10:14:58.850420 [info ] [MainThread]:   region: None
[0m10:14:58.851413 [info ] [MainThread]:   iam_profile: None
[0m10:14:58.852410 [info ] [MainThread]:   autocreate: False
[0m10:14:58.853405 [info ] [MainThread]:   db_groups: []
[0m10:14:58.854406 [info ] [MainThread]:   ra3_node: False
[0m10:14:58.855407 [info ] [MainThread]:   connect_timeout: None
[0m10:14:58.856407 [info ] [MainThread]:   role: None
[0m10:14:58.857414 [info ] [MainThread]:   retries: 1
[0m10:14:58.858405 [info ] [MainThread]:   autocommit: True
[0m10:14:58.859406 [info ] [MainThread]: Registered adapter: redshift=1.8.1
[0m10:14:58.860405 [debug] [MainThread]: Acquiring new redshift connection 'debug'
[0m10:14:58.866414 [debug] [MainThread]: Using redshift connection "debug"
[0m10:14:58.867407 [debug] [MainThread]: On debug: select 1 as id
[0m10:14:58.868421 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:14:58.873405 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m10:14:58.875405 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m10:15:00.457658 [debug] [MainThread]: Redshift adapter: Error running SQL: select 1 as id
[0m10:15:00.459656 [debug] [MainThread]: Redshift adapter: Rolling back transaction.
[0m10:15:00.461661 [debug] [MainThread]: On debug: No close available on handle
[0m10:15:00.462654 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m10:15:00.465735 [info ] [MainThread]: [31m1 check failed:[0m
[0m10:15:00.467631 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  {'S': 'FATAL', 'C': '28000', 'M': 'password authentication failed for user "admin"', 'F': '/home/ec2-user/padb/src/pg/src/backend/libpq/auth.c', 'L': '425', 'R': 'auth_failed'}

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m10:15:00.475647 [debug] [MainThread]: Command `dbt debug` failed at 10:15:00.475647 after 2.26 seconds
[0m10:15:00.477643 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m10:15:00.479732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A1604DE310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A16296A4C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A170D20A00>]}
[0m10:15:00.481724 [debug] [MainThread]: Flushing usage events
[0m10:15:00.996365 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:16:43.989585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A3B63AE2B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A3B7FA8580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A3B7FA8A00>]}


============================== 10:16:43.994633 | 1acb369a-c413-46fc-a351-1b1cd2b1f2ac ==============================
[0m10:16:43.994633 [info ] [MainThread]: Running with dbt=1.9.0-b1
[0m10:16:43.995586 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\User\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\User\\Desktop\\dbt-Transformations\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m10:16:44.024102 [info ] [MainThread]: dbt version: 1.9.0-b1
[0m10:16:44.025129 [info ] [MainThread]: python version: 3.9.12
[0m10:16:44.027101 [info ] [MainThread]: python path: C:\Users\User\anaconda3\python.exe
[0m10:16:44.028126 [info ] [MainThread]: os info: Windows-10-10.0.22631-SP0
[0m10:16:44.425347 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m10:16:44.426348 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m10:16:44.487631 [info ] [MainThread]: Using profiles dir at C:\Users\User\.dbt
[0m10:16:44.488699 [info ] [MainThread]: Using profiles.yml file at C:\Users\User\.dbt\profiles.yml
[0m10:16:44.489637 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\User\Desktop\dbt-Transformations\dbt_project.yml
[0m10:16:44.491637 [info ] [MainThread]: adapter type: redshift
[0m10:16:44.492638 [info ] [MainThread]: adapter version: 1.8.1
[0m10:16:44.603345 [info ] [MainThread]: Configuration:
[0m10:16:44.604035 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m10:16:44.605230 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m10:16:44.606243 [info ] [MainThread]: Required dependencies:
[0m10:16:44.607251 [debug] [MainThread]: Executing "git --help"
[0m10:16:44.631660 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m10:16:44.631660 [debug] [MainThread]: STDERR: "b''"
[0m10:16:44.632672 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m10:16:44.634761 [info ] [MainThread]: Connection:
[0m10:16:44.635760 [info ] [MainThread]:   host: default-workgroup.863518444424.eu-north-1.redshift-serverless.amazonaws.com
[0m10:16:44.636759 [info ] [MainThread]:   user: admin
[0m10:16:44.638761 [info ] [MainThread]:   port: 5439
[0m10:16:44.639806 [info ] [MainThread]:   database: dev
[0m10:16:44.640806 [info ] [MainThread]:   method: database
[0m10:16:44.641828 [info ] [MainThread]:   cluster_id: None
[0m10:16:44.642835 [info ] [MainThread]:   iam_profile: None
[0m10:16:44.643835 [info ] [MainThread]:   schema: public
[0m10:16:44.644834 [info ] [MainThread]:   sslmode: prefer
[0m10:16:44.645836 [info ] [MainThread]:   region: None
[0m10:16:44.645836 [info ] [MainThread]:   sslmode: prefer
[0m10:16:44.646836 [info ] [MainThread]:   region: None
[0m10:16:44.647836 [info ] [MainThread]:   iam_profile: None
[0m10:16:44.648837 [info ] [MainThread]:   autocreate: False
[0m10:16:44.649840 [info ] [MainThread]:   db_groups: []
[0m10:16:44.650835 [info ] [MainThread]:   ra3_node: False
[0m10:16:44.651835 [info ] [MainThread]:   connect_timeout: None
[0m10:16:44.652836 [info ] [MainThread]:   role: None
[0m10:16:44.652836 [info ] [MainThread]:   retries: 1
[0m10:16:44.653834 [info ] [MainThread]:   autocommit: True
[0m10:16:44.654845 [info ] [MainThread]: Registered adapter: redshift=1.8.1
[0m10:16:44.657243 [debug] [MainThread]: Acquiring new redshift connection 'debug'
[0m10:16:44.663267 [debug] [MainThread]: Using redshift connection "debug"
[0m10:16:44.664266 [debug] [MainThread]: On debug: select 1 as id
[0m10:16:44.664266 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:16:44.668443 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m10:16:44.670446 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m10:16:46.389380 [debug] [MainThread]: SQL status: SUCCESS in 1.725 seconds
[0m10:16:46.392498 [debug] [MainThread]: On debug: Close
[0m10:16:46.395415 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m10:16:46.397396 [info ] [MainThread]: [32mAll checks passed![0m
[0m10:16:46.400482 [debug] [MainThread]: Command `dbt debug` succeeded at 10:16:46.400482 after 2.49 seconds
[0m10:16:46.401483 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m10:16:46.402397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A3B63AE2B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A3B7FA8550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A3B75675E0>]}
[0m10:16:46.403439 [debug] [MainThread]: Flushing usage events
[0m10:16:46.932277 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:23:17.718832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028E9A6EE2B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028E9C274910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028E95FC7BE0>]}


============================== 10:23:17.722919 | fd293bc1-ad9b-4415-b200-475f1dbc7c8a ==============================
[0m10:23:17.722919 [info ] [MainThread]: Running with dbt=1.9.0-b1
[0m10:23:17.723841 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\User\\Desktop\\dbt-Transformations\\logs', 'profiles_dir': 'C:\\Users\\User\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt debug', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:23:17.752064 [info ] [MainThread]: dbt version: 1.9.0-b1
[0m10:23:17.753061 [info ] [MainThread]: python version: 3.9.12
[0m10:23:17.754066 [info ] [MainThread]: python path: C:\Users\User\anaconda3\python.exe
[0m10:23:17.755069 [info ] [MainThread]: os info: Windows-10-10.0.22631-SP0
[0m10:23:17.758068 [error] [MainThread]: Encountered an error:
Runtime Error
  Syntax error near line 6
  ------------------------------
  3  |     dev:
  4  |       dbname: dev
  5  |       host: default-workgroup.863518444424.eu-north-1.redshift-serverless.amazonaws.com
  6  |       password: {{ env_var('REDSHIFT_PASSWORD') }}
  7  |       port: 5439
  8  |       schema: public
  9  |       threads: 1
  
  Raw Error:
  ------------------------------
  while constructing a mapping
    in "<unicode string>", line 6, column 17:
            password: {{ env_var('REDSHIFT_PASSWORD') }}
                      ^
  found unhashable key
    in "<unicode string>", line 6, column 18:
            password: {{ env_var('REDSHIFT_PASSWORD') }}
                       ^
[0m10:23:17.763075 [debug] [MainThread]: Command `dbt debug` failed at 10:23:17.763075 after 0.08 seconds
[0m10:23:17.764063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028E9A6EE2B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028E9C35E730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028E9C35E3D0>]}
[0m10:23:17.765072 [debug] [MainThread]: Flushing usage events
[0m10:23:18.388225 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:23:43.495178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B5E28CE2E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B5E44CACD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B5E4503F40>]}


============================== 10:23:43.499252 | 807f7882-412f-46ef-bf37-cccf101f5bae ==============================
[0m10:23:43.499252 [info ] [MainThread]: Running with dbt=1.9.0-b1
[0m10:23:43.501161 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\User\\Desktop\\dbt-Transformations\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\User\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt debug', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:23:43.518513 [info ] [MainThread]: dbt version: 1.9.0-b1
[0m10:23:43.520519 [info ] [MainThread]: python version: 3.9.12
[0m10:23:43.521514 [info ] [MainThread]: python path: C:\Users\User\anaconda3\python.exe
[0m10:23:43.523521 [info ] [MainThread]: os info: Windows-10-10.0.22631-SP0
[0m10:23:43.832226 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m10:23:43.832226 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m10:23:43.884670 [info ] [MainThread]: Using profiles dir at C:\Users\User\.dbt
[0m10:23:43.885677 [info ] [MainThread]: Using profiles.yml file at C:\Users\User\.dbt\profiles.yml
[0m10:23:43.887694 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\User\Desktop\dbt-Transformations\dbt_project.yml
[0m10:23:43.889550 [info ] [MainThread]: adapter type: redshift
[0m10:23:43.890033 [info ] [MainThread]: adapter version: 1.8.1
[0m10:23:43.991703 [info ] [MainThread]: Configuration:
[0m10:23:43.992618 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m10:23:43.993697 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m10:23:43.994620 [info ] [MainThread]: Required dependencies:
[0m10:23:43.995786 [debug] [MainThread]: Executing "git --help"
[0m10:23:44.018270 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m10:23:44.019333 [debug] [MainThread]: STDERR: "b''"
[0m10:23:44.020237 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m10:23:44.021235 [info ] [MainThread]: Connection:
[0m10:23:44.022246 [info ] [MainThread]:   host: default-workgroup.863518444424.eu-north-1.redshift-serverless.amazonaws.com
[0m10:23:44.023269 [info ] [MainThread]:   user: admin
[0m10:23:44.024281 [info ] [MainThread]:   port: 5439
[0m10:23:44.025251 [info ] [MainThread]:   database: dev
[0m10:23:44.027245 [info ] [MainThread]:   method: database
[0m10:23:44.028233 [info ] [MainThread]:   cluster_id: None
[0m10:23:44.030236 [info ] [MainThread]:   iam_profile: None
[0m10:23:44.031479 [info ] [MainThread]:   schema: public
[0m10:23:44.032479 [info ] [MainThread]:   sslmode: prefer
[0m10:23:44.033486 [info ] [MainThread]:   region: None
[0m10:23:44.034478 [info ] [MainThread]:   sslmode: prefer
[0m10:23:44.035585 [info ] [MainThread]:   region: None
[0m10:23:44.036600 [info ] [MainThread]:   iam_profile: None
[0m10:23:44.037607 [info ] [MainThread]:   autocreate: False
[0m10:23:44.038608 [info ] [MainThread]:   db_groups: []
[0m10:23:44.039608 [info ] [MainThread]:   ra3_node: False
[0m10:23:44.040163 [info ] [MainThread]:   connect_timeout: None
[0m10:23:44.041581 [info ] [MainThread]:   role: None
[0m10:23:44.042594 [info ] [MainThread]:   retries: 1
[0m10:23:44.042594 [info ] [MainThread]:   autocommit: True
[0m10:23:44.044589 [info ] [MainThread]: Registered adapter: redshift=1.8.1
[0m10:23:44.047346 [debug] [MainThread]: Acquiring new redshift connection 'debug'
[0m10:23:44.052389 [debug] [MainThread]: Using redshift connection "debug"
[0m10:23:44.053401 [debug] [MainThread]: On debug: select 1 as id
[0m10:23:44.054406 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:23:44.058403 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m10:23:44.059391 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m10:23:45.652602 [debug] [MainThread]: Redshift adapter: Error running SQL: select 1 as id
[0m10:23:45.654598 [debug] [MainThread]: Redshift adapter: Rolling back transaction.
[0m10:23:45.655684 [debug] [MainThread]: On debug: No close available on handle
[0m10:23:45.657604 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m10:23:45.660102 [info ] [MainThread]: [31m1 check failed:[0m
[0m10:23:45.661202 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  {'S': 'FATAL', 'C': '28000', 'M': 'password authentication failed for user "admin"', 'F': '/home/ec2-user/padb/src/pg/src/backend/libpq/auth.c', 'L': '425', 'R': 'auth_failed'}

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m10:23:45.665553 [debug] [MainThread]: Command `dbt debug` failed at 10:23:45.665553 after 2.25 seconds
[0m10:23:45.666588 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m10:23:45.667654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B5E28CE2E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B5E0DA2E80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B5F31109D0>]}
[0m10:23:45.668625 [debug] [MainThread]: Flushing usage events
[0m10:23:46.178800 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:26:19.143774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002614E8DE440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002615086BAC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002615086BCA0>]}


============================== 10:26:19.147983 | 493c499d-59d0-4b6f-a26e-f31e178183c4 ==============================
[0m10:26:19.147983 [info ] [MainThread]: Running with dbt=1.9.0-b1
[0m10:26:19.148977 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\User\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\User\\Desktop\\dbt-Transformations\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt debug', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:26:19.178047 [info ] [MainThread]: dbt version: 1.9.0-b1
[0m10:26:19.179025 [info ] [MainThread]: python version: 3.10.7
[0m10:26:19.179025 [info ] [MainThread]: python path: C:\Users\User\Desktop\dbt-Transformations\dbt-env\Scripts\python.exe
[0m10:26:19.180026 [info ] [MainThread]: os info: Windows-10-10.0.22631-SP0
[0m10:26:19.337902 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m10:26:19.339018 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m10:26:19.390071 [info ] [MainThread]: Using profiles dir at C:\Users\User\.dbt
[0m10:26:19.390975 [info ] [MainThread]: Using profiles.yml file at C:\Users\User\.dbt\profiles.yml
[0m10:26:19.391985 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\User\Desktop\dbt-Transformations\dbt_project.yml
[0m10:26:19.394115 [info ] [MainThread]: adapter type: redshift
[0m10:26:19.395037 [info ] [MainThread]: adapter version: 1.8.1
[0m10:26:19.502941 [info ] [MainThread]: Configuration:
[0m10:26:19.503848 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m10:26:19.504847 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m10:26:19.505849 [info ] [MainThread]: Required dependencies:
[0m10:26:19.506648 [debug] [MainThread]: Executing "git --help"
[0m10:26:19.528567 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m10:26:19.529500 [debug] [MainThread]: STDERR: "b''"
[0m10:26:19.529500 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m10:26:19.530817 [info ] [MainThread]: Connection:
[0m10:26:19.531823 [info ] [MainThread]:   host: default-workgroup.863518444424.eu-north-1.redshift-serverless.amazonaws.com
[0m10:26:19.532822 [info ] [MainThread]:   user: admin
[0m10:26:19.534823 [info ] [MainThread]:   port: 5439
[0m10:26:19.535422 [info ] [MainThread]:   database: dev
[0m10:26:19.536445 [info ] [MainThread]:   method: database
[0m10:26:19.537434 [info ] [MainThread]:   cluster_id: None
[0m10:26:19.539432 [info ] [MainThread]:   iam_profile: None
[0m10:26:19.540430 [info ] [MainThread]:   schema: public
[0m10:26:19.541429 [info ] [MainThread]:   sslmode: prefer
[0m10:26:19.542437 [info ] [MainThread]:   region: None
[0m10:26:19.544436 [info ] [MainThread]:   sslmode: prefer
[0m10:26:19.560461 [info ] [MainThread]:   region: None
[0m10:26:19.562442 [info ] [MainThread]:   iam_profile: None
[0m10:26:19.566443 [info ] [MainThread]:   autocreate: False
[0m10:26:19.579267 [info ] [MainThread]:   db_groups: []
[0m10:26:19.581470 [info ] [MainThread]:   ra3_node: False
[0m10:26:19.582469 [info ] [MainThread]:   connect_timeout: None
[0m10:26:19.583467 [info ] [MainThread]:   role: None
[0m10:26:19.584469 [info ] [MainThread]:   retries: 1
[0m10:26:19.586469 [info ] [MainThread]:   autocommit: True
[0m10:26:19.587469 [info ] [MainThread]: Registered adapter: redshift=1.8.1
[0m10:26:19.588473 [debug] [MainThread]: Acquiring new redshift connection 'debug'
[0m10:26:19.595467 [debug] [MainThread]: Using redshift connection "debug"
[0m10:26:19.596495 [debug] [MainThread]: On debug: select 1 as id
[0m10:26:19.598494 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:26:19.604466 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m10:26:19.605476 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m10:26:20.451441 [debug] [MainThread]: Redshift adapter: Error running SQL: select 1 as id
[0m10:26:20.452469 [debug] [MainThread]: Redshift adapter: Rolling back transaction.
[0m10:26:20.453320 [debug] [MainThread]: On debug: No close available on handle
[0m10:26:20.453320 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m10:26:20.455725 [info ] [MainThread]: [31m1 check failed:[0m
[0m10:26:20.456721 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  {'S': 'FATAL', 'C': '28000', 'M': 'password authentication failed for user "admin"', 'F': '/home/ec2-user/padb/src/pg/src/backend/libpq/auth.c', 'L': '425', 'R': 'auth_failed'}

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m10:26:20.459329 [debug] [MainThread]: Command `dbt debug` failed at 10:26:20.459329 after 1.40 seconds
[0m10:26:20.460325 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m10:26:20.461333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002614E8DE440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000261511C7BE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000261511C7190>]}
[0m10:26:20.461333 [debug] [MainThread]: Flushing usage events
[0m10:26:20.979404 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:29:41.737622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018018A3E3E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001801A9CBAC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001801A9CBCA0>]}


============================== 10:29:41.742719 | 2517b635-d7fc-463b-af19-4d321b3fb7d0 ==============================
[0m10:29:41.742719 [info ] [MainThread]: Running with dbt=1.9.0-b1
[0m10:29:41.744631 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\User\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\User\\Desktop\\dbt-Transformations\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt debug', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:29:41.772226 [info ] [MainThread]: dbt version: 1.9.0-b1
[0m10:29:41.773210 [info ] [MainThread]: python version: 3.10.7
[0m10:29:41.774211 [info ] [MainThread]: python path: C:\Users\User\Desktop\dbt-Transformations\dbt-env\Scripts\python.exe
[0m10:29:41.775206 [info ] [MainThread]: os info: Windows-10-10.0.22631-SP0
[0m10:29:41.931592 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m10:29:41.931592 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m10:29:41.982730 [info ] [MainThread]: Using profiles dir at C:\Users\User\.dbt
[0m10:29:41.983580 [info ] [MainThread]: Using profiles.yml file at C:\Users\User\.dbt\profiles.yml
[0m10:29:41.984586 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\User\Desktop\dbt-Transformations\dbt_project.yml
[0m10:29:41.987173 [info ] [MainThread]: adapter type: redshift
[0m10:29:41.988182 [info ] [MainThread]: adapter version: 1.8.1
[0m10:29:42.084901 [info ] [MainThread]: Configuration:
[0m10:29:42.085859 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m10:29:42.086897 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m10:29:42.088303 [info ] [MainThread]: Required dependencies:
[0m10:29:42.089312 [debug] [MainThread]: Executing "git --help"
[0m10:29:42.112078 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m10:29:42.113171 [debug] [MainThread]: STDERR: "b''"
[0m10:29:42.114080 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m10:29:42.116107 [info ] [MainThread]: Connection:
[0m10:29:42.117077 [info ] [MainThread]:   host: default-workgroup.863518444424.eu-north-1.redshift-serverless.amazonaws.com
[0m10:29:42.119075 [info ] [MainThread]:   user: admin
[0m10:29:42.120080 [info ] [MainThread]:   port: 5439
[0m10:29:42.121081 [info ] [MainThread]:   database: dev
[0m10:29:42.123910 [info ] [MainThread]:   method: database
[0m10:29:42.124950 [info ] [MainThread]:   cluster_id: None
[0m10:29:42.125920 [info ] [MainThread]:   iam_profile: None
[0m10:29:42.126919 [info ] [MainThread]:   schema: public
[0m10:29:42.127928 [info ] [MainThread]:   sslmode: prefer
[0m10:29:42.128958 [info ] [MainThread]:   region: None
[0m10:29:42.129923 [info ] [MainThread]:   sslmode: prefer
[0m10:29:42.130963 [info ] [MainThread]:   region: None
[0m10:29:42.131919 [info ] [MainThread]:   iam_profile: None
[0m10:29:42.132935 [info ] [MainThread]:   autocreate: False
[0m10:29:42.132935 [info ] [MainThread]:   db_groups: []
[0m10:29:42.133917 [info ] [MainThread]:   ra3_node: False
[0m10:29:42.136055 [info ] [MainThread]:   connect_timeout: None
[0m10:29:42.137920 [info ] [MainThread]:   role: None
[0m10:29:42.138920 [info ] [MainThread]:   retries: 1
[0m10:29:42.139838 [info ] [MainThread]:   autocommit: True
[0m10:29:42.140849 [info ] [MainThread]: Registered adapter: redshift=1.8.1
[0m10:29:42.141851 [debug] [MainThread]: Acquiring new redshift connection 'debug'
[0m10:29:42.146913 [debug] [MainThread]: Using redshift connection "debug"
[0m10:29:42.147913 [debug] [MainThread]: On debug: select 1 as id
[0m10:29:42.148895 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:29:42.152900 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m10:29:42.154899 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m10:29:42.884818 [debug] [MainThread]: SQL status: SUCCESS in 0.736 seconds
[0m10:29:42.887846 [debug] [MainThread]: On debug: Close
[0m10:29:42.889852 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m10:29:42.892631 [info ] [MainThread]: [32mAll checks passed![0m
[0m10:29:42.895877 [debug] [MainThread]: Command `dbt debug` succeeded at 10:29:42.894877 after 1.24 seconds
[0m10:29:42.896872 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m10:29:42.896872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018018A3E3E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001801A4AFC10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001801B2AA320>]}
[0m10:29:42.898385 [debug] [MainThread]: Flushing usage events
[0m10:29:43.423464 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:30:06.028384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D78B5A2380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D78D518B20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D78D518940>]}


============================== 10:30:06.032422 | ffa57e3e-46a5-4896-9c5d-427068cc1066 ==============================
[0m10:30:06.032422 [info ] [MainThread]: Running with dbt=1.9.0-b1
[0m10:30:06.033431 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\User\\.dbt', 'log_path': 'C:\\Users\\User\\Desktop\\dbt-Transformations\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:30:06.214111 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m10:30:06.215105 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m10:30:06.377302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ffa57e3e-46a5-4896-9c5d-427068cc1066', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D78DD91210>]}
[0m10:30:06.432348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ffa57e3e-46a5-4896-9c5d-427068cc1066', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D78DBFF2E0>]}
[0m10:30:06.434353 [info ] [MainThread]: Registered adapter: redshift=1.8.1
[0m10:30:06.450258 [debug] [MainThread]: checksum: 342eadeaabeb3b1e51584f606df2b5b2518c39ec1d5d83f52b4bb1c68a4f38ed, vars: {}, profile: , target: , version: 1.9.0b1
[0m10:30:06.577654 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:30:06.577654 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:30:06.583655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ffa57e3e-46a5-4896-9c5d-427068cc1066', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D78E118130>]}
[0m10:30:06.644274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ffa57e3e-46a5-4896-9c5d-427068cc1066', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D78E0FBB20>]}
[0m10:30:06.645268 [info ] [MainThread]: Found 489 macros
[0m10:30:06.647323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ffa57e3e-46a5-4896-9c5d-427068cc1066', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D78E0FBEE0>]}
[0m10:30:06.648354 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m10:30:06.651356 [debug] [MainThread]: Command end result
[0m10:30:06.680274 [debug] [MainThread]: Command `dbt run` succeeded at 10:30:06.680274 after 0.72 seconds
[0m10:30:06.681271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D78B5A2380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D78B914220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D78DEB6020>]}
[0m10:30:06.681271 [debug] [MainThread]: Flushing usage events
[0m10:30:07.173269 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:31:01.931312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F098BE3E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F0B7ED0F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F0B7ECF10>]}


============================== 11:31:01.939386 | 5b9f56c2-63b5-491a-a9bf-363e865ebeb9 ==============================
[0m11:31:01.939386 [info ] [MainThread]: Running with dbt=1.9.0-b1
[0m11:31:01.940264 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\User\\Desktop\\dbt-Transformations\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\User\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:31:02.171558 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m11:31:02.172557 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m11:31:02.412159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5b9f56c2-63b5-491a-a9bf-363e865ebeb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F0896FB50>]}
[0m11:31:02.495249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5b9f56c2-63b5-491a-a9bf-363e865ebeb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F0C0AF160>]}
[0m11:31:02.497251 [info ] [MainThread]: Registered adapter: redshift=1.8.1
[0m11:31:02.513260 [debug] [MainThread]: checksum: 342eadeaabeb3b1e51584f606df2b5b2518c39ec1d5d83f52b4bb1c68a4f38ed, vars: {}, profile: , target: , version: 1.9.0b1
[0m11:31:02.683010 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:31:02.684005 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:31:02.689007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5b9f56c2-63b5-491a-a9bf-363e865ebeb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F0C434130>]}
[0m11:31:02.772723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5b9f56c2-63b5-491a-a9bf-363e865ebeb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F0C417B80>]}
[0m11:31:02.773722 [info ] [MainThread]: Found 489 macros
[0m11:31:02.775722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5b9f56c2-63b5-491a-a9bf-363e865ebeb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F0C417D30>]}
[0m11:31:02.776729 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m11:31:02.780808 [debug] [MainThread]: Command end result
[0m11:31:02.818908 [debug] [MainThread]: Command `dbt run` succeeded at 11:31:02.818908 after 0.99 seconds
[0m11:31:02.820909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F098BE3E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F0C1DA440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F0AC073A0>]}
[0m11:31:02.821909 [debug] [MainThread]: Flushing usage events
[0m11:31:03.626155 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:07:40.061389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CC7265E3B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CC74589090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CC74588EB0>]}


============================== 20:07:40.069971 | d2f4008b-212a-430b-bf1c-e45d9d225f76 ==============================
[0m20:07:40.069971 [info ] [MainThread]: Running with dbt=1.9.0-b1
[0m20:07:40.070922 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\User\\.dbt', 'log_path': 'C:\\Users\\User\\Desktop\\dbt-Transformations\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:07:42.918663 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m20:07:42.919673 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m20:07:43.178886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd2f4008b-212a-430b-bf1c-e45d9d225f76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CC74E4D060>]}
[0m20:07:43.235882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd2f4008b-212a-430b-bf1c-e45d9d225f76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CC74CBF310>]}
[0m20:07:43.237632 [info ] [MainThread]: Registered adapter: redshift=1.8.1
[0m20:07:43.279427 [debug] [MainThread]: checksum: 342eadeaabeb3b1e51584f606df2b5b2518c39ec1d5d83f52b4bb1c68a4f38ed, vars: {}, profile: , target: , version: 1.9.0b1
[0m20:07:44.616795 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:07:44.617795 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:07:44.622795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd2f4008b-212a-430b-bf1c-e45d9d225f76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CC751D8130>]}
[0m20:07:44.710621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd2f4008b-212a-430b-bf1c-e45d9d225f76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CC751BBB50>]}
[0m20:07:44.711721 [info ] [MainThread]: Found 489 macros
[0m20:07:44.712707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd2f4008b-212a-430b-bf1c-e45d9d225f76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CC751BBEB0>]}
[0m20:07:44.714802 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m20:07:44.716820 [debug] [MainThread]: Command end result
[0m20:07:44.745715 [debug] [MainThread]: Command `dbt run` succeeded at 20:07:44.745715 after 4.79 seconds
[0m20:07:44.746822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CC7265E3B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CC745A93C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CC739A43D0>]}
[0m20:07:44.747918 [debug] [MainThread]: Flushing usage events
[0m20:07:45.317449 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:16:03.702802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200800DE3B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020082009090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020082008EB0>]}


============================== 20:16:03.708797 | 159b9321-f550-404d-9e21-3d74ad1fdadc ==============================
[0m20:16:03.708797 [info ] [MainThread]: Running with dbt=1.9.0-b1
[0m20:16:03.710806 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\User\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\User\\Desktop\\dbt-Transformations\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:16:03.903100 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m20:16:03.904187 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m20:16:04.086943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '159b9321-f550-404d-9e21-3d74ad1fdadc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020081452350>]}
[0m20:16:04.139801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '159b9321-f550-404d-9e21-3d74ad1fdadc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020081BC1390>]}
[0m20:16:04.141281 [info ] [MainThread]: Registered adapter: redshift=1.8.1
[0m20:16:04.159268 [debug] [MainThread]: checksum: 342eadeaabeb3b1e51584f606df2b5b2518c39ec1d5d83f52b4bb1c68a4f38ed, vars: {}, profile: , target: , version: 1.9.0b1
[0m20:16:04.205937 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m20:16:04.206940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '159b9321-f550-404d-9e21-3d74ad1fdadc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020081B27340>]}
[0m20:16:05.170939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '159b9321-f550-404d-9e21-3d74ad1fdadc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020081B25F30>]}
[0m20:16:05.237959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '159b9321-f550-404d-9e21-3d74ad1fdadc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020082C50FD0>]}
[0m20:16:05.238953 [info ] [MainThread]: Found 489 macros
[0m20:16:05.239953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '159b9321-f550-404d-9e21-3d74ad1fdadc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020082C52770>]}
[0m20:16:05.241960 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m20:16:05.242960 [debug] [MainThread]: Command end result
[0m20:16:05.286384 [debug] [MainThread]: Command `dbt run` succeeded at 20:16:05.286384 after 1.69 seconds
[0m20:16:05.287384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200800DE3B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020081BC1390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020081425CC0>]}
[0m20:16:05.288388 [debug] [MainThread]: Flushing usage events
[0m20:16:05.793301 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:23:40.764403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E90FC0E3E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E911B3D0F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E911B3CF10>]}


============================== 20:23:40.769412 | 91dd4af8-9762-4837-94b0-3cdfe477c511 ==============================
[0m20:23:40.769412 [info ] [MainThread]: Running with dbt=1.9.0-b1
[0m20:23:40.771313 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\User\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\User\\Desktop\\dbt-Transformations\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:23:40.959485 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m20:23:40.960564 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m20:23:41.152781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '91dd4af8-9762-4837-94b0-3cdfe477c511', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9122C11E0>]}
[0m20:23:41.206538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '91dd4af8-9762-4837-94b0-3cdfe477c511', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E91226F340>]}
[0m20:23:41.209410 [info ] [MainThread]: Registered adapter: redshift=1.8.1
[0m20:23:41.221419 [debug] [MainThread]: checksum: 342eadeaabeb3b1e51584f606df2b5b2518c39ec1d5d83f52b4bb1c68a4f38ed, vars: {}, profile: , target: , version: 1.9.0b1
[0m20:23:41.397312 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:23:41.398312 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:23:41.403311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '91dd4af8-9762-4837-94b0-3cdfe477c511', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E912784130>]}
[0m20:23:41.461732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '91dd4af8-9762-4837-94b0-3cdfe477c511', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E91276BB80>]}
[0m20:23:41.462729 [info ] [MainThread]: Found 489 macros
[0m20:23:41.463729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '91dd4af8-9762-4837-94b0-3cdfe477c511', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E91276BD30>]}
[0m20:23:41.464725 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m20:23:41.467724 [debug] [MainThread]: Command end result
[0m20:23:41.495441 [debug] [MainThread]: Command `dbt run` succeeded at 20:23:41.495441 after 0.83 seconds
[0m20:23:41.496444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E90FC0E3E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E90E558550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E910F4E140>]}
[0m20:23:41.497442 [debug] [MainThread]: Flushing usage events
[0m20:23:42.007627 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:36:03.852540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E1D79823E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E1D98AD0F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E1D98ACF10>]}


============================== 20:36:03.856194 | caea2675-84e7-4b99-8394-43409ffc25f9 ==============================
[0m20:36:03.856194 [info ] [MainThread]: Running with dbt=1.9.0-b1
[0m20:36:03.858103 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\User\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\User\\Desktop\\dbt-Transformations\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m20:36:06.807253 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m20:36:06.809237 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m20:36:06.992312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'caea2675-84e7-4b99-8394-43409ffc25f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E1D622FB50>]}
[0m20:36:07.044918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'caea2675-84e7-4b99-8394-43409ffc25f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E1DA16F160>]}
[0m20:36:07.046939 [info ] [MainThread]: Registered adapter: redshift=1.8.1
[0m20:36:07.080719 [debug] [MainThread]: checksum: 342eadeaabeb3b1e51584f606df2b5b2518c39ec1d5d83f52b4bb1c68a4f38ed, vars: {}, profile: , target: , version: 1.9.0b1
[0m20:36:07.132431 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m20:36:07.134431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'caea2675-84e7-4b99-8394-43409ffc25f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E1D93C7370>]}
[0m20:36:09.039332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'caea2675-84e7-4b99-8394-43409ffc25f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E1DA0A9870>]}
[0m20:36:09.107334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'caea2675-84e7-4b99-8394-43409ffc25f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E1DA39CEE0>]}
[0m20:36:09.108336 [info ] [MainThread]: Found 489 macros
[0m20:36:09.110349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'caea2675-84e7-4b99-8394-43409ffc25f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E1DA39E680>]}
[0m20:36:09.111842 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m20:36:09.113851 [debug] [MainThread]: Command end result
[0m20:36:09.143932 [debug] [MainThread]: Command `dbt run` succeeded at 20:36:09.142850 after 5.39 seconds
[0m20:36:09.144858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E1D79823E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E1D8CC73A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E1DA3B20E0>]}
[0m20:36:09.144858 [debug] [MainThread]: Flushing usage events
[0m20:36:09.643507 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:36:21.947169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023CA6B6E3B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023CA8A99090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023CA8A98EB0>]}


============================== 20:36:21.952263 | 4f95502d-eac7-4abf-a29d-ccbdcbfcac37 ==============================
[0m20:36:21.952263 [info ] [MainThread]: Running with dbt=1.9.0-b1
[0m20:36:21.954348 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\User\\Desktop\\dbt-Transformations\\logs', 'profiles_dir': 'C:\\Users\\User\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:36:22.116038 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m20:36:22.117047 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m20:36:22.274431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4f95502d-eac7-4abf-a29d-ccbdcbfcac37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023CA935D060>]}
[0m20:36:22.327332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4f95502d-eac7-4abf-a29d-ccbdcbfcac37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023CA91CF310>]}
[0m20:36:22.329344 [info ] [MainThread]: Registered adapter: redshift=1.8.1
[0m20:36:22.341021 [debug] [MainThread]: checksum: 342eadeaabeb3b1e51584f606df2b5b2518c39ec1d5d83f52b4bb1c68a4f38ed, vars: {}, profile: , target: , version: 1.9.0b1
[0m20:36:22.466836 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:36:22.467828 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:36:22.472837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4f95502d-eac7-4abf-a29d-ccbdcbfcac37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023CA96E4130>]}
[0m20:36:22.531940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4f95502d-eac7-4abf-a29d-ccbdcbfcac37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023CA96C7B50>]}
[0m20:36:22.532934 [info ] [MainThread]: Found 489 macros
[0m20:36:22.534970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4f95502d-eac7-4abf-a29d-ccbdcbfcac37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023CA96C7EB0>]}
[0m20:36:22.536012 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m20:36:22.538933 [debug] [MainThread]: Command end result
[0m20:36:22.568332 [debug] [MainThread]: Command `dbt run` succeeded at 20:36:22.567276 after 0.69 seconds
[0m20:36:22.569262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023CA6B6E3B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023CA8AB93C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023CA7EB03D0>]}
[0m20:36:22.569262 [debug] [MainThread]: Flushing usage events
[0m20:36:23.070276 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:40:18.971652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED715023B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED7348BAC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED7348BCA0>]}


============================== 20:40:18.976678 | a39fdc67-621c-4bd1-8f7e-569d32aaaf7a ==============================
[0m20:40:18.976678 [info ] [MainThread]: Running with dbt=1.9.0-b1
[0m20:40:18.977654 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\User\\.dbt', 'log_path': 'C:\\Users\\User\\Desktop\\dbt-Transformations\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt debug', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:40:19.004286 [info ] [MainThread]: dbt version: 1.9.0-b1
[0m20:40:19.004286 [info ] [MainThread]: python version: 3.10.7
[0m20:40:19.005801 [info ] [MainThread]: python path: C:\Users\User\Desktop\dbt-Transformations\dbt-env\Scripts\python.exe
[0m20:40:19.006811 [info ] [MainThread]: os info: Windows-10-10.0.22631-SP0
[0m20:40:19.168304 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m20:40:19.169311 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m20:40:19.223083 [info ] [MainThread]: Using profiles dir at C:\Users\User\.dbt
[0m20:40:19.224103 [info ] [MainThread]: Using profiles.yml file at C:\Users\User\.dbt\profiles.yml
[0m20:40:19.225996 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\User\Desktop\dbt-Transformations\dbt_project.yml
[0m20:40:19.227960 [info ] [MainThread]: adapter type: redshift
[0m20:40:19.228975 [info ] [MainThread]: adapter version: 1.8.1
[0m20:40:19.330756 [info ] [MainThread]: Configuration:
[0m20:40:19.331492 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m20:40:19.332575 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m20:40:19.333507 [info ] [MainThread]: Required dependencies:
[0m20:40:19.334504 [debug] [MainThread]: Executing "git --help"
[0m20:40:19.357010 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m20:40:19.358006 [debug] [MainThread]: STDERR: "b''"
[0m20:40:19.358006 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m20:40:19.360009 [info ] [MainThread]: Connection:
[0m20:40:19.362037 [info ] [MainThread]:   host: default-workgroup.863518444424.eu-north-1.redshift-serverless.amazonaws.com
[0m20:40:19.363008 [info ] [MainThread]:   user: admin
[0m20:40:19.364009 [info ] [MainThread]:   port: 5439
[0m20:40:19.365007 [info ] [MainThread]:   database: dev
[0m20:40:19.366012 [info ] [MainThread]:   method: database
[0m20:40:19.367007 [info ] [MainThread]:   cluster_id: None
[0m20:40:19.368009 [info ] [MainThread]:   iam_profile: None
[0m20:40:19.369506 [info ] [MainThread]:   schema: public
[0m20:40:19.370535 [info ] [MainThread]:   sslmode: prefer
[0m20:40:19.371515 [info ] [MainThread]:   region: None
[0m20:40:19.372529 [info ] [MainThread]:   sslmode: prefer
[0m20:40:19.373516 [info ] [MainThread]:   region: None
[0m20:40:19.374514 [info ] [MainThread]:   iam_profile: None
[0m20:40:19.375513 [info ] [MainThread]:   autocreate: False
[0m20:40:19.376514 [info ] [MainThread]:   db_groups: []
[0m20:40:19.378527 [info ] [MainThread]:   ra3_node: False
[0m20:40:19.380519 [info ] [MainThread]:   connect_timeout: None
[0m20:40:19.382539 [info ] [MainThread]:   role: None
[0m20:40:19.383514 [info ] [MainThread]:   retries: 1
[0m20:40:19.384515 [info ] [MainThread]:   autocommit: True
[0m20:40:19.385514 [info ] [MainThread]: Registered adapter: redshift=1.8.1
[0m20:40:19.387173 [debug] [MainThread]: Acquiring new redshift connection 'debug'
[0m20:40:19.392289 [debug] [MainThread]: Using redshift connection "debug"
[0m20:40:19.393382 [debug] [MainThread]: On debug: select 1 as id
[0m20:40:19.393382 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:40:19.399386 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m20:40:19.400356 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m20:40:20.404205 [debug] [MainThread]: SQL status: SUCCESS in 1.011 seconds
[0m20:40:20.407227 [debug] [MainThread]: On debug: Close
[0m20:40:20.408742 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m20:40:20.410760 [info ] [MainThread]: [32mAll checks passed![0m
[0m20:40:20.412788 [debug] [MainThread]: Command `dbt debug` succeeded at 20:40:20.412788 after 1.52 seconds
[0m20:40:20.412788 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m20:40:20.413837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED715023B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED73C321A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED72872350>]}
[0m20:40:20.414752 [debug] [MainThread]: Flushing usage events
[0m20:40:20.962584 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:48:32.272292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA991CE3B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA9B0F9090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA9B0F8EB0>]}


============================== 20:48:32.276981 | 5fad3466-935b-4536-8b86-0d0b3c88d373 ==============================
[0m20:48:32.276981 [info ] [MainThread]: Running with dbt=1.9.0-b1
[0m20:48:32.279082 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\User\\Desktop\\dbt-Transformations\\logs', 'profiles_dir': 'C:\\Users\\User\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m20:48:32.437403 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m20:48:32.437403 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m20:48:32.593529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5fad3466-935b-4536-8b86-0d0b3c88d373', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA9B9BD060>]}
[0m20:48:32.645529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5fad3466-935b-4536-8b86-0d0b3c88d373', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA9B833310>]}
[0m20:48:32.647532 [info ] [MainThread]: Registered adapter: redshift=1.8.1
[0m20:48:32.659535 [debug] [MainThread]: checksum: 342eadeaabeb3b1e51584f606df2b5b2518c39ec1d5d83f52b4bb1c68a4f38ed, vars: {}, profile: , target: , version: 1.9.0b1
[0m20:48:32.713639 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m20:48:32.714640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '5fad3466-935b-4536-8b86-0d0b3c88d373', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA9AC1B340>]}
[0m20:48:33.604861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5fad3466-935b-4536-8b86-0d0b3c88d373', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA9BB6A410>]}
[0m20:48:33.661557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5fad3466-935b-4536-8b86-0d0b3c88d373', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA9BC290C0>]}
[0m20:48:33.662563 [info ] [MainThread]: Found 489 macros
[0m20:48:33.663561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5fad3466-935b-4536-8b86-0d0b3c88d373', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA9BC2A650>]}
[0m20:48:33.664555 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m20:48:33.666583 [debug] [MainThread]: Command end result
[0m20:48:33.696214 [debug] [MainThread]: Command `dbt run` succeeded at 20:48:33.696214 after 1.51 seconds
[0m20:48:33.697168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA991CE3B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA9ABD35B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA9BC420E0>]}
[0m20:48:33.698173 [debug] [MainThread]: Flushing usage events
[0m20:48:34.228266 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:48:42.122175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9711CE410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9730FD180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9730FCFA0>]}


============================== 20:48:42.127175 | 826feca7-89e8-4e93-b7cc-fb6d8f35608d ==============================
[0m20:48:42.127175 [info ] [MainThread]: Running with dbt=1.9.0-b1
[0m20:48:42.128178 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\User\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\User\\Desktop\\dbt-Transformations\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:48:42.293254 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m20:48:42.294237 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m20:48:42.458537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '826feca7-89e8-4e93-b7cc-fb6d8f35608d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D96FA7EBC0>]}
[0m20:48:42.512073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '826feca7-89e8-4e93-b7cc-fb6d8f35608d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D973833370>]}
[0m20:48:42.513621 [info ] [MainThread]: Registered adapter: redshift=1.8.1
[0m20:48:42.527049 [debug] [MainThread]: checksum: 342eadeaabeb3b1e51584f606df2b5b2518c39ec1d5d83f52b4bb1c68a4f38ed, vars: {}, profile: , target: , version: 1.9.0b1
[0m20:48:42.661372 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:48:42.662374 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:48:42.667372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '826feca7-89e8-4e93-b7cc-fb6d8f35608d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D973D44130>]}
[0m20:48:42.725809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '826feca7-89e8-4e93-b7cc-fb6d8f35608d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D973D2BBB0>]}
[0m20:48:42.726808 [info ] [MainThread]: Found 489 macros
[0m20:48:42.727808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '826feca7-89e8-4e93-b7cc-fb6d8f35608d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D973D2BD60>]}
[0m20:48:42.728907 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m20:48:42.732896 [debug] [MainThread]: Command end result
[0m20:48:42.762809 [debug] [MainThread]: Command `dbt run` succeeded at 20:48:42.762809 after 0.71 seconds
[0m20:48:42.763897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9711CE410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D97153B940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D971541CC0>]}
[0m20:48:42.764813 [debug] [MainThread]: Flushing usage events
[0m20:48:43.251040 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:52:54.581310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D63B4E350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D65ACCB50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D65ACC970>]}


============================== 20:52:54.586316 | 891479ee-f1e1-4270-ac20-faae25629113 ==============================
[0m20:52:54.586316 [info ] [MainThread]: Running with dbt=1.9.0-b1
[0m20:52:54.587317 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\User\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\User\\Desktop\\dbt-Transformations\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:52:54.750861 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m20:52:54.751816 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m20:52:54.919950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '891479ee-f1e1-4270-ac20-faae25629113', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D6620D150>]}
[0m20:52:54.977286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '891479ee-f1e1-4270-ac20-faae25629113', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D661B32B0>]}
[0m20:52:54.979635 [info ] [MainThread]: Registered adapter: redshift=1.8.1
[0m20:52:54.991382 [debug] [MainThread]: checksum: 342eadeaabeb3b1e51584f606df2b5b2518c39ec1d5d83f52b4bb1c68a4f38ed, vars: {}, profile: , target: , version: 1.9.0b1
[0m20:52:55.105283 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:52:55.106201 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:52:55.111497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '891479ee-f1e1-4270-ac20-faae25629113', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D666C4130>]}
[0m20:52:55.173795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '891479ee-f1e1-4270-ac20-faae25629113', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D666ABAF0>]}
[0m20:52:55.174799 [info ] [MainThread]: Found 489 macros
[0m20:52:55.175796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '891479ee-f1e1-4270-ac20-faae25629113', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D666ABEB0>]}
[0m20:52:55.177886 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m20:52:55.180885 [debug] [MainThread]: Command end result
[0m20:52:55.210349 [debug] [MainThread]: Command `dbt run` succeeded at 20:52:55.210349 after 0.71 seconds
[0m20:52:55.211349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D63B4E350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D65A9D330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D66456C50>]}
[0m20:52:55.212349 [debug] [MainThread]: Flushing usage events
[0m20:52:55.713946 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:54:10.671383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020287D3E3B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020289C69090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020289C68EB0>]}


============================== 20:54:10.675576 | c3a982ac-58e8-4cb6-b4c5-d7989ee7c1e8 ==============================
[0m20:54:10.675576 [info ] [MainThread]: Running with dbt=1.9.0-b1
[0m20:54:10.677595 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\User\\.dbt', 'log_path': 'C:\\Users\\User\\Desktop\\dbt-Transformations\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m20:54:10.838243 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m20:54:10.839249 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m20:54:11.003471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c3a982ac-58e8-4cb6-b4c5-d7989ee7c1e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002028A531060>]}
[0m20:54:11.059007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c3a982ac-58e8-4cb6-b4c5-d7989ee7c1e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002028A3A3310>]}
[0m20:54:11.061359 [info ] [MainThread]: Registered adapter: redshift=1.8.1
[0m20:54:11.073372 [debug] [MainThread]: checksum: 342eadeaabeb3b1e51584f606df2b5b2518c39ec1d5d83f52b4bb1c68a4f38ed, vars: {}, profile: , target: , version: 1.9.0b1
[0m20:54:11.191438 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:54:11.192372 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:54:11.197438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c3a982ac-58e8-4cb6-b4c5-d7989ee7c1e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002028A8B4130>]}
[0m20:54:11.255535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c3a982ac-58e8-4cb6-b4c5-d7989ee7c1e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002028A89BB50>]}
[0m20:54:11.256508 [info ] [MainThread]: Found 489 macros
[0m20:54:11.257533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c3a982ac-58e8-4cb6-b4c5-d7989ee7c1e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002028A89BEB0>]}
[0m20:54:11.259505 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m20:54:11.262503 [debug] [MainThread]: Command end result
[0m20:54:11.292509 [debug] [MainThread]: Command `dbt run` succeeded at 20:54:11.292509 after 0.70 seconds
[0m20:54:11.293512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020287D3E3B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002028A583790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002028A693C10>]}
[0m20:54:11.294516 [debug] [MainThread]: Flushing usage events
[0m20:54:11.822329 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:55:34.421889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000177DB1FE410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000177DD12D180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000177DD12CFA0>]}


============================== 20:55:34.425983 | 9c83ab3b-7154-411f-b267-50d0710a651f ==============================
[0m20:55:34.425983 [info ] [MainThread]: Running with dbt=1.9.0-b1
[0m20:55:34.427886 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\User\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\User\\Desktop\\dbt-Transformations\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:55:34.601069 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m20:55:34.601069 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m20:55:34.768423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9c83ab3b-7154-411f-b267-50d0710a651f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000177D9AAEBC0>]}
[0m20:55:34.821760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9c83ab3b-7154-411f-b267-50d0710a651f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000177DD863370>]}
[0m20:55:34.823708 [info ] [MainThread]: Registered adapter: redshift=1.8.1
[0m20:55:34.838707 [debug] [MainThread]: checksum: 342eadeaabeb3b1e51584f606df2b5b2518c39ec1d5d83f52b4bb1c68a4f38ed, vars: {}, profile: , target: , version: 1.9.0b1
[0m20:55:34.952503 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:55:34.953535 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:55:34.959280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9c83ab3b-7154-411f-b267-50d0710a651f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000177DDD74130>]}
[0m20:55:35.019877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9c83ab3b-7154-411f-b267-50d0710a651f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000177DDD5BBB0>]}
[0m20:55:35.020921 [info ] [MainThread]: Found 489 macros
[0m20:55:35.021912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9c83ab3b-7154-411f-b267-50d0710a651f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000177DDD5BD60>]}
[0m20:55:35.023877 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m20:55:35.026966 [debug] [MainThread]: Command end result
[0m20:55:35.057059 [debug] [MainThread]: Command `dbt run` succeeded at 20:55:35.055987 after 0.71 seconds
[0m20:55:35.057059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000177DB1FE410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000177DC53B940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000177DC541CC0>]}
[0m20:55:35.057970 [debug] [MainThread]: Flushing usage events
[0m20:55:35.578716 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:58:44.705740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AA69DE23E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AA6BD0D3C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AA6BD0D1E0>]}


============================== 20:58:44.710491 | 7d650cb2-3959-40ec-8835-4982156b6f23 ==============================
[0m20:58:44.710491 [info ] [MainThread]: Running with dbt=1.9.0-b1
[0m20:58:44.712491 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\User\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\User\\Desktop\\dbt-Transformations\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt ls', 'send_anonymous_usage_stats': 'True'}
[0m20:58:44.885152 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m20:58:44.886056 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m20:58:45.058982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7d650cb2-3959-40ec-8835-4982156b6f23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AA6C5012A0>]}
[0m20:58:45.117500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7d650cb2-3959-40ec-8835-4982156b6f23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AA6C443610>]}
[0m20:58:45.119081 [info ] [MainThread]: Registered adapter: redshift=1.8.1
[0m20:58:45.132090 [debug] [MainThread]: checksum: 342eadeaabeb3b1e51584f606df2b5b2518c39ec1d5d83f52b4bb1c68a4f38ed, vars: {}, profile: , target: , version: 1.9.0b1
[0m20:58:45.249313 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:58:45.250237 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:58:45.254311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7d650cb2-3959-40ec-8835-4982156b6f23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AA6C954130>]}
[0m20:58:45.314988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7d650cb2-3959-40ec-8835-4982156b6f23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AA6C947250>]}
[0m20:58:45.315987 [info ] [MainThread]: Found 489 macros
[0m20:58:45.317006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7d650cb2-3959-40ec-8835-4982156b6f23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AA6B7E2C50>]}
[0m20:58:45.318000 [warn ] [MainThread]: No nodes selected!
[0m20:58:45.319987 [debug] [MainThread]: Command `dbt ls` succeeded at 20:58:45.319987 after 0.69 seconds
[0m20:58:45.320590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AA69DE23E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AA6B7E2C50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AA6C93FDC0>]}
[0m20:58:45.321602 [debug] [MainThread]: Flushing usage events
[0m20:58:45.826531 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:02:15.366287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D318E72320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D31AD9D300>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D31AD9D120>]}


============================== 21:02:15.371285 | 87c84977-4361-4aee-9191-08f6666eb51e ==============================
[0m21:02:15.371285 [info ] [MainThread]: Running with dbt=1.9.0-b1
[0m21:02:15.372286 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\User\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\User\\Desktop\\dbt-Transformations\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt ls', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:02:15.537600 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m21:02:15.538597 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m21:02:15.707786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '87c84977-4361-4aee-9191-08f6666eb51e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D317721870>]}
[0m21:02:15.760418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '87c84977-4361-4aee-9191-08f6666eb51e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D31B4D3550>]}
[0m21:02:15.762328 [info ] [MainThread]: Registered adapter: redshift=1.8.1
[0m21:02:15.773413 [debug] [MainThread]: checksum: 342eadeaabeb3b1e51584f606df2b5b2518c39ec1d5d83f52b4bb1c68a4f38ed, vars: {}, profile: , target: , version: 1.9.0b1
[0m21:02:15.820111 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m21:02:15.822163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '87c84977-4361-4aee-9191-08f6666eb51e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D31A8BB2B0>]}
[0m21:02:17.176457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '87c84977-4361-4aee-9191-08f6666eb51e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D31CD0A8F0>]}
[0m21:02:17.303539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '87c84977-4361-4aee-9191-08f6666eb51e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D31CCC87C0>]}
[0m21:02:17.304542 [info ] [MainThread]: Found 3 models, 4 data tests, 489 macros
[0m21:02:17.306537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '87c84977-4361-4aee-9191-08f6666eb51e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D31CCC8970>]}
[0m21:02:17.310536 [info ] [MainThread]: dbt_transformations.example.my_first_dbt_model
[0m21:02:17.312041 [info ] [MainThread]: dbt_transformations.example.my_second_dbt_model
[0m21:02:17.314063 [info ] [MainThread]: dbt_transformations.staging_raw_sales_data
[0m21:02:17.315055 [info ] [MainThread]: dbt_transformations.models.example.not_null_my_first_dbt_model_id
[0m21:02:17.316411 [info ] [MainThread]: dbt_transformations.models.example.not_null_my_second_dbt_model_id
[0m21:02:17.317424 [info ] [MainThread]: dbt_transformations.models.example.unique_my_first_dbt_model_id
[0m21:02:17.318420 [info ] [MainThread]: dbt_transformations.models.example.unique_my_second_dbt_model_id
[0m21:02:17.320442 [debug] [MainThread]: Command `dbt ls` succeeded at 21:02:17.320442 after 2.05 seconds
[0m21:02:17.321424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D318E72320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D31B8C14B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D318CE9A80>]}
[0m21:02:17.322454 [debug] [MainThread]: Flushing usage events
[0m21:02:17.822546 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:02:35.164503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212433623B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021245289090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021245288EB0>]}


============================== 21:02:35.168594 | f7ee1707-641a-4981-9624-f897f6fdb9dc ==============================
[0m21:02:35.168594 [info ] [MainThread]: Running with dbt=1.9.0-b1
[0m21:02:35.170517 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\User\\Desktop\\dbt-Transformations\\logs', 'profiles_dir': 'C:\\Users\\User\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:02:35.330251 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m21:02:35.331161 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m21:02:35.491732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f7ee1707-641a-4981-9624-f897f6fdb9dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021245B51060>]}
[0m21:02:35.544444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f7ee1707-641a-4981-9624-f897f6fdb9dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212459C3310>]}
[0m21:02:35.546805 [info ] [MainThread]: Registered adapter: redshift=1.8.1
[0m21:02:35.561425 [debug] [MainThread]: checksum: 342eadeaabeb3b1e51584f606df2b5b2518c39ec1d5d83f52b4bb1c68a4f38ed, vars: {}, profile: , target: , version: 1.9.0b1
[0m21:02:35.746910 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:02:35.747906 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:02:35.788808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f7ee1707-641a-4981-9624-f897f6fdb9dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021245F2A6E0>]}
[0m21:02:35.885313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f7ee1707-641a-4981-9624-f897f6fdb9dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021245F24160>]}
[0m21:02:35.886301 [info ] [MainThread]: Found 3 models, 4 data tests, 489 macros
[0m21:02:35.887320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f7ee1707-641a-4981-9624-f897f6fdb9dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021245F245B0>]}
[0m21:02:35.889301 [info ] [MainThread]: 
[0m21:02:35.890300 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:02:35.891299 [info ] [MainThread]: 
[0m21:02:35.893304 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m21:02:35.903306 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev'
[0m21:02:35.924390 [debug] [ThreadPool]: Using redshift connection "list_dev"
[0m21:02:35.925386 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.9.0b1", "profile_name": "emekamarkt", "target_name": "dev", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
[0m21:02:35.925386 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:02:35.929393 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m21:02:35.931398 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m21:02:36.827130 [debug] [ThreadPool]: SQL status: SUCCESS in 0.901 seconds
[0m21:02:36.828141 [debug] [ThreadPool]: On list_dev: Close
[0m21:02:36.832068 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev_public'
[0m21:02:36.841075 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m21:02:36.842580 [debug] [ThreadPool]: On list_dev_public: BEGIN
[0m21:02:36.842580 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:02:36.843593 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m21:02:36.843593 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m21:02:55.264886 [debug] [ThreadPool]: SQL status: SUCCESS in 18.422 seconds
[0m21:02:55.267004 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m21:02:55.268908 [debug] [ThreadPool]: On list_dev_public: /* {"app": "dbt", "dbt_version": "1.9.0b1", "profile_name": "emekamarkt", "target_name": "dev", "connection_name": "list_dev_public"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'public'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'public'
[0m21:02:55.374288 [debug] [ThreadPool]: SQL status: SUCCESS in 0.105 seconds
[0m21:02:55.378269 [debug] [ThreadPool]: On list_dev_public: ROLLBACK
[0m21:02:55.454241 [debug] [ThreadPool]: On list_dev_public: Close
[0m21:02:55.468379 [debug] [MainThread]: Using redshift connection "master"
[0m21:02:55.468379 [debug] [MainThread]: On master: BEGIN
[0m21:02:55.469389 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:02:55.470288 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m21:02:55.470288 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m21:02:55.972694 [debug] [MainThread]: SQL status: SUCCESS in 0.504 seconds
[0m21:02:55.974829 [debug] [MainThread]: Using redshift connection "master"
[0m21:02:55.976827 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0b1", "profile_name": "emekamarkt", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m21:02:56.126209 [debug] [MainThread]: SQL status: SUCCESS in 0.148 seconds
[0m21:02:56.130217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f7ee1707-641a-4981-9624-f897f6fdb9dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021241A7E0B0>]}
[0m21:02:56.132155 [debug] [MainThread]: On master: ROLLBACK
[0m21:02:56.208232 [debug] [MainThread]: Using redshift connection "master"
[0m21:02:56.209322 [debug] [MainThread]: On master: BEGIN
[0m21:02:56.246767 [debug] [MainThread]: SQL status: SUCCESS in 0.035 seconds
[0m21:02:56.248721 [debug] [MainThread]: On master: COMMIT
[0m21:02:56.249677 [debug] [MainThread]: Using redshift connection "master"
[0m21:02:56.250765 [debug] [MainThread]: On master: COMMIT
[0m21:02:56.326653 [debug] [MainThread]: SQL status: SUCCESS in 0.075 seconds
[0m21:02:56.327667 [debug] [MainThread]: On master: Close
[0m21:02:56.334657 [debug] [Thread-1 (]: Began running node model.dbt_transformations.my_first_dbt_model
[0m21:02:56.335660 [info ] [Thread-1 (]: 1 of 3 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m21:02:56.336664 [debug] [Thread-1 (]: Acquiring new redshift connection 'model.dbt_transformations.my_first_dbt_model'
[0m21:02:56.337655 [debug] [Thread-1 (]: Began compiling node model.dbt_transformations.my_first_dbt_model
[0m21:02:56.341750 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_transformations.my_first_dbt_model"
[0m21:02:56.344653 [debug] [Thread-1 (]: Began executing node model.dbt_transformations.my_first_dbt_model
[0m21:02:56.443564 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_transformations.my_first_dbt_model"
[0m21:02:56.448339 [debug] [Thread-1 (]: Using redshift connection "model.dbt_transformations.my_first_dbt_model"
[0m21:02:56.449330 [debug] [Thread-1 (]: On model.dbt_transformations.my_first_dbt_model: BEGIN
[0m21:02:56.450335 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:02:56.451335 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m21:02:56.452343 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m21:02:56.945432 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.494 seconds
[0m21:02:56.947447 [debug] [Thread-1 (]: Using redshift connection "model.dbt_transformations.my_first_dbt_model"
[0m21:02:56.948440 [debug] [Thread-1 (]: On model.dbt_transformations.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.0b1", "profile_name": "emekamarkt", "target_name": "dev", "node_id": "model.dbt_transformations.my_first_dbt_model"} */

  
    

  create  table
    "dev"."public"."my_first_dbt_model__dbt_tmp"
    
    
    
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
[0m21:03:10.376055 [debug] [Thread-1 (]: SQL status: SUCCESS in 13.427 seconds
[0m21:03:10.384168 [debug] [Thread-1 (]: Using redshift connection "model.dbt_transformations.my_first_dbt_model"
[0m21:03:10.385164 [debug] [Thread-1 (]: On model.dbt_transformations.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.0b1", "profile_name": "emekamarkt", "target_name": "dev", "node_id": "model.dbt_transformations.my_first_dbt_model"} */
alter table "dev"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m21:03:10.621650 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.236 seconds
[0m21:03:10.645583 [debug] [Thread-1 (]: On model.dbt_transformations.my_first_dbt_model: COMMIT
[0m21:03:10.646624 [debug] [Thread-1 (]: Using redshift connection "model.dbt_transformations.my_first_dbt_model"
[0m21:03:10.646624 [debug] [Thread-1 (]: On model.dbt_transformations.my_first_dbt_model: COMMIT
[0m21:03:11.331767 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.684 seconds
[0m21:03:11.334769 [debug] [Thread-1 (]: Using redshift connection "model.dbt_transformations.my_first_dbt_model"
[0m21:03:11.336748 [debug] [Thread-1 (]: On model.dbt_transformations.my_first_dbt_model: BEGIN
[0m21:03:11.416093 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.079 seconds
[0m21:03:11.423093 [debug] [Thread-1 (]: Applying DROP to: "dev"."public"."my_first_dbt_model__dbt_backup"
[0m21:03:11.431077 [debug] [Thread-1 (]: Using redshift connection "model.dbt_transformations.my_first_dbt_model"
[0m21:03:11.432086 [debug] [Thread-1 (]: On model.dbt_transformations.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.0b1", "profile_name": "emekamarkt", "target_name": "dev", "node_id": "model.dbt_transformations.my_first_dbt_model"} */
drop table if exists "dev"."public"."my_first_dbt_model__dbt_backup" cascade
[0m21:03:11.508765 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.076 seconds
[0m21:03:11.510787 [debug] [Thread-1 (]: On model.dbt_transformations.my_first_dbt_model: COMMIT
[0m21:03:11.511772 [debug] [Thread-1 (]: Using redshift connection "model.dbt_transformations.my_first_dbt_model"
[0m21:03:11.511772 [debug] [Thread-1 (]: On model.dbt_transformations.my_first_dbt_model: COMMIT
[0m21:03:11.555437 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.042 seconds
[0m21:03:11.557433 [debug] [Thread-1 (]: Using redshift connection "model.dbt_transformations.my_first_dbt_model"
[0m21:03:11.558429 [debug] [Thread-1 (]: On model.dbt_transformations.my_first_dbt_model: BEGIN
[0m21:03:11.595430 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.036 seconds
[0m21:03:11.597988 [debug] [Thread-1 (]: On model.dbt_transformations.my_first_dbt_model: ROLLBACK
[0m21:03:11.673104 [debug] [Thread-1 (]: On model.dbt_transformations.my_first_dbt_model: Close
[0m21:03:11.675205 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f7ee1707-641a-4981-9624-f897f6fdb9dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002124618C2E0>]}
[0m21:03:11.677123 [info ] [Thread-1 (]: 1 of 3 OK created sql table model public.my_first_dbt_model .................... [[32mSUCCESS[0m in 15.34s]
[0m21:03:11.678113 [debug] [Thread-1 (]: Finished running node model.dbt_transformations.my_first_dbt_model
[0m21:03:11.679229 [debug] [Thread-1 (]: Began running node model.dbt_transformations.staging_raw_sales_data
[0m21:03:11.680168 [info ] [Thread-1 (]: 2 of 3 START sql view model public.staging_raw_sales_data ...................... [RUN]
[0m21:03:11.681154 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_transformations.my_first_dbt_model, now model.dbt_transformations.staging_raw_sales_data)
[0m21:03:11.682176 [debug] [Thread-1 (]: Began compiling node model.dbt_transformations.staging_raw_sales_data
[0m21:03:11.686165 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_transformations.staging_raw_sales_data"
[0m21:03:11.688159 [debug] [Thread-1 (]: Began executing node model.dbt_transformations.staging_raw_sales_data
[0m21:03:11.711316 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_transformations.staging_raw_sales_data"
[0m21:03:11.720696 [debug] [Thread-1 (]: Using redshift connection "model.dbt_transformations.staging_raw_sales_data"
[0m21:03:11.721694 [debug] [Thread-1 (]: On model.dbt_transformations.staging_raw_sales_data: BEGIN
[0m21:03:11.721694 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:03:11.722771 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m21:03:11.723754 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m21:03:12.234506 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.513 seconds
[0m21:03:12.236608 [debug] [Thread-1 (]: Using redshift connection "model.dbt_transformations.staging_raw_sales_data"
[0m21:03:12.239147 [debug] [Thread-1 (]: On model.dbt_transformations.staging_raw_sales_data: /* {"app": "dbt", "dbt_version": "1.9.0b1", "profile_name": "emekamarkt", "target_name": "dev", "node_id": "model.dbt_transformations.staging_raw_sales_data"} */


  create view "dev"."public"."staging_raw_sales_data__dbt_tmp" as (
    -- models/staging_raw_sales_data.sql



WITH raw_data AS (
    SELECT 
        *
    FROM 
        external_table('s3://emeka-market-raw-sales-data/raw_sales_data.csv',
        'arn:aws:iam::863518444424:role/service-role/AmazonRedshift-CommandsAccessRole-20241004T144721',  -- Replace with your IAM Role ARN
        'CSV',
        'IGNOREHEADER 1',
        'DELIMITER ','',
        'REGION eu-north-1'  
    )
)

SELECT
    SaleID,
    ProductID,
    CustomerID,
    Quantity,
    Date,
    LocationID,
    PaymentID,
    ShippingID,
    PromotionID,
    ReviewID,
    JSON_EXTRACT_PATH_TEXT(Product, 'ProductID')::INT AS Product_ProductID,
    JSON_EXTRACT_PATH_TEXT(Product, 'ProductName') AS Product_ProductName,
    JSON_EXTRACT_PATH_TEXT(Product, 'Category') AS Product_Category,
    JSON_EXTRACT_PATH_TEXT(Product, 'UnitCost')::FLOAT AS Product_UnitCost,
    JSON_EXTRACT_PATH_TEXT(Product, 'UnitPrice')::FLOAT AS Product_UnitPrice,
    JSON_EXTRACT_PATH_TEXT(Customer, 'CustomerID')::INT AS Customer_CustomerID,
    JSON_EXTRACT_PATH_TEXT(Customer, 'CustomerName') AS Customer_CustomerName,
    JSON_EXTRACT_PATH_TEXT(Customer, 'Email') AS Customer_Email,
    JSON_EXTRACT_PATH_TEXT(Customer, 'PhoneNumber') AS Customer_PhoneNumber,
    JSON_EXTRACT_PATH_TEXT(Customer, 'LoyaltyStatus') AS Customer_LoyaltyStatus,
    JSON_EXTRACT_PATH_TEXT(Location, 'LocationID')::INT AS Location_LocationID,
    JSON_EXTRACT_PATH_TEXT(Location, 'Country') AS Location_Country,
    JSON_EXTRACT_PATH_TEXT(Location, 'State') AS Location_State,
    JSON_EXTRACT_PATH_TEXT(Location, 'City') AS Location_City,
    JSON_EXTRACT_PATH_TEXT(Location, 'PostalCode')::INT AS Location_PostalCode,
    JSON_EXTRACT_PATH_TEXT(Location, 'Region') AS Location_Region,
    JSON_EXTRACT_PATH_TEXT(Promotion, 'PromotionID')::INT AS Promotion_PromotionID,
    JSON_EXTRACT_PATH_TEXT(Promotion, 'PromotionName') AS Promotion_PromotionName,
    JSON_EXTRACT_PATH_TEXT(Promotion, 'DiscountRate')::FLOAT AS Promotion_DiscountRate,
    JSON_EXTRACT_PATH_TEXT(Shipping, 'ShippingID')::INT AS Shipping_ShippingID,
    JSON_EXTRACT_PATH_TEXT(Shipping, 'Method') AS Shipping_Method,
    JSON_EXTRACT_PATH_TEXT(Shipping, 'Cost')::FLOAT AS Shipping_Cost,
    JSON_EXTRACT_PATH_TEXT(Review, 'ReviewID')::INT AS Review_ReviewID,
    JSON_EXTRACT_PATH_TEXT(Review, 'ProductID')::INT AS Review_ProductID,
    JSON_EXTRACT_PATH_TEXT(Review, 'CustomerID')::INT AS Review_CustomerID,
    JSON_EXTRACT_PATH_TEXT(Review, 'Rating')::INT AS Review_Rating,
    JSON_EXTRACT_PATH_TEXT(Review, 'Comment') AS Review_Comment,
    JSON_EXTRACT_PATH_TEXT(MarketingChannel, 'ChannelID')::INT AS MarketingChannel_ChannelID,
    JSON_EXTRACT_PATH_TEXT(MarketingChannel, 'ChannelName') AS MarketingChannel_ChannelName
FROM raw_data
  ) ;
[0m21:03:12.285378 [debug] [Thread-1 (]: Redshift adapter: Redshift error: function external_table("unknown", "unknown", "unknown", "unknown", "unknown", "unknown", "unknown") does not exist
[0m21:03:12.285378 [debug] [Thread-1 (]: On model.dbt_transformations.staging_raw_sales_data: ROLLBACK
[0m21:03:12.364560 [debug] [Thread-1 (]: On model.dbt_transformations.staging_raw_sales_data: Close
[0m21:03:12.393720 [debug] [Thread-1 (]: Database Error in model staging_raw_sales_data (emekamarkt/models\staging_raw_sales_data.sql)
  function external_table("unknown", "unknown", "unknown", "unknown", "unknown", "unknown", "unknown") does not exist
  compiled code at target\run\dbt_transformations\emekamarkt/models\staging_raw_sales_data.sql
[0m21:03:12.394663 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f7ee1707-641a-4981-9624-f897f6fdb9dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212452AA950>]}
[0m21:03:12.396679 [error] [Thread-1 (]: 2 of 3 ERROR creating sql view model public.staging_raw_sales_data ............. [[31mERROR[0m in 0.71s]
[0m21:03:12.398758 [debug] [Thread-1 (]: Finished running node model.dbt_transformations.staging_raw_sales_data
[0m21:03:12.399351 [debug] [Thread-1 (]: Began running node model.dbt_transformations.my_second_dbt_model
[0m21:03:12.400443 [debug] [Thread-4 (]: Marking all children of 'model.dbt_transformations.staging_raw_sales_data' to be skipped because of status 'error'.  Reason: Database Error in model staging_raw_sales_data (emekamarkt/models\staging_raw_sales_data.sql)
  function external_table("unknown", "unknown", "unknown", "unknown", "unknown", "unknown", "unknown") does not exist
  compiled code at target\run\dbt_transformations\emekamarkt/models\staging_raw_sales_data.sql.
[0m21:03:12.401363 [info ] [Thread-1 (]: 3 of 3 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m21:03:12.403366 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_transformations.staging_raw_sales_data, now model.dbt_transformations.my_second_dbt_model)
[0m21:03:12.404454 [debug] [Thread-1 (]: Began compiling node model.dbt_transformations.my_second_dbt_model
[0m21:03:12.407357 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_transformations.my_second_dbt_model"
[0m21:03:12.410358 [debug] [Thread-1 (]: Began executing node model.dbt_transformations.my_second_dbt_model
[0m21:03:12.415345 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_transformations.my_second_dbt_model"
[0m21:03:12.418797 [debug] [Thread-1 (]: Using redshift connection "model.dbt_transformations.my_second_dbt_model"
[0m21:03:12.419810 [debug] [Thread-1 (]: On model.dbt_transformations.my_second_dbt_model: BEGIN
[0m21:03:12.419810 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:03:12.420823 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m21:03:12.421824 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m21:03:13.820534 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.400 seconds
[0m21:03:13.821534 [debug] [Thread-1 (]: Using redshift connection "model.dbt_transformations.my_second_dbt_model"
[0m21:03:13.822540 [debug] [Thread-1 (]: On model.dbt_transformations.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.0b1", "profile_name": "emekamarkt", "target_name": "dev", "node_id": "model.dbt_transformations.my_second_dbt_model"} */


  create view "dev"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dev"."public"."my_first_dbt_model"
where id = 1
  ) ;
[0m21:03:14.012097 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.188 seconds
[0m21:03:14.019116 [debug] [Thread-1 (]: Using redshift connection "model.dbt_transformations.my_second_dbt_model"
[0m21:03:14.020092 [debug] [Thread-1 (]: On model.dbt_transformations.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.0b1", "profile_name": "emekamarkt", "target_name": "dev", "node_id": "model.dbt_transformations.my_second_dbt_model"} */
alter table "dev"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m21:03:14.138145 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.118 seconds
[0m21:03:14.140145 [debug] [Thread-1 (]: On model.dbt_transformations.my_second_dbt_model: COMMIT
[0m21:03:14.141208 [debug] [Thread-1 (]: Using redshift connection "model.dbt_transformations.my_second_dbt_model"
[0m21:03:14.142123 [debug] [Thread-1 (]: On model.dbt_transformations.my_second_dbt_model: COMMIT
[0m21:03:14.681806 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.539 seconds
[0m21:03:14.683818 [debug] [Thread-1 (]: Using redshift connection "model.dbt_transformations.my_second_dbt_model"
[0m21:03:14.683818 [debug] [Thread-1 (]: On model.dbt_transformations.my_second_dbt_model: BEGIN
[0m21:03:14.761617 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.077 seconds
[0m21:03:14.765598 [debug] [Thread-1 (]: Applying DROP to: "dev"."public"."my_second_dbt_model__dbt_backup"
[0m21:03:14.769597 [debug] [Thread-1 (]: Using redshift connection "model.dbt_transformations.my_second_dbt_model"
[0m21:03:14.770599 [debug] [Thread-1 (]: On model.dbt_transformations.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.0b1", "profile_name": "emekamarkt", "target_name": "dev", "node_id": "model.dbt_transformations.my_second_dbt_model"} */
drop view if exists "dev"."public"."my_second_dbt_model__dbt_backup" cascade
[0m21:03:14.849685 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.079 seconds
[0m21:03:14.851776 [debug] [Thread-1 (]: On model.dbt_transformations.my_second_dbt_model: COMMIT
[0m21:03:14.851776 [debug] [Thread-1 (]: Using redshift connection "model.dbt_transformations.my_second_dbt_model"
[0m21:03:14.852783 [debug] [Thread-1 (]: On model.dbt_transformations.my_second_dbt_model: COMMIT
[0m21:03:14.899119 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.046 seconds
[0m21:03:14.901226 [debug] [Thread-1 (]: Using redshift connection "model.dbt_transformations.my_second_dbt_model"
[0m21:03:14.902829 [debug] [Thread-1 (]: On model.dbt_transformations.my_second_dbt_model: BEGIN
[0m21:03:14.941834 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.037 seconds
[0m21:03:14.944938 [debug] [Thread-1 (]: On model.dbt_transformations.my_second_dbt_model: ROLLBACK
[0m21:03:15.023317 [debug] [Thread-1 (]: On model.dbt_transformations.my_second_dbt_model: Close
[0m21:03:15.026430 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f7ee1707-641a-4981-9624-f897f6fdb9dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212452AA950>]}
[0m21:03:15.029424 [info ] [Thread-1 (]: 3 of 3 OK created sql view model public.my_second_dbt_model .................... [[32mSUCCESS[0m in 2.62s]
[0m21:03:15.031424 [debug] [Thread-1 (]: Finished running node model.dbt_transformations.my_second_dbt_model
[0m21:03:15.035336 [debug] [MainThread]: Using redshift connection "master"
[0m21:03:15.036332 [debug] [MainThread]: On master: BEGIN
[0m21:03:15.037432 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:03:15.038351 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m21:03:15.039417 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m21:03:16.444236 [debug] [MainThread]: SQL status: SUCCESS in 1.407 seconds
[0m21:03:16.445320 [debug] [MainThread]: On master: COMMIT
[0m21:03:16.446234 [debug] [MainThread]: Using redshift connection "master"
[0m21:03:16.447333 [debug] [MainThread]: On master: COMMIT
[0m21:03:16.526398 [debug] [MainThread]: SQL status: SUCCESS in 0.078 seconds
[0m21:03:16.527402 [debug] [MainThread]: On master: Close
[0m21:03:16.528473 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:03:16.528473 [debug] [MainThread]: Connection 'list_dev' was properly closed.
[0m21:03:16.529401 [debug] [MainThread]: Connection 'list_dev_public' was properly closed.
[0m21:03:16.530426 [debug] [MainThread]: Connection 'model.dbt_transformations.my_second_dbt_model' was properly closed.
[0m21:03:16.530426 [info ] [MainThread]: 
[0m21:03:16.531497 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 40.64 seconds (40.64s).
[0m21:03:16.535406 [debug] [MainThread]: Command end result
[0m21:03:16.572570 [info ] [MainThread]: 
[0m21:03:16.573544 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successs, and 0 warnings:[0m
[0m21:03:16.574552 [info ] [MainThread]: 
[0m21:03:16.575543 [error] [MainThread]:   Database Error in model staging_raw_sales_data (emekamarkt/models\staging_raw_sales_data.sql)
  function external_table("unknown", "unknown", "unknown", "unknown", "unknown", "unknown", "unknown") does not exist
  compiled code at target\run\dbt_transformations\emekamarkt/models\staging_raw_sales_data.sql
[0m21:03:16.578542 [info ] [MainThread]: 
[0m21:03:16.580543 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m21:03:16.583540 [debug] [MainThread]: Command `dbt run` failed at 21:03:16.583540 after 41.50 seconds
[0m21:03:16.584638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212433623B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212436D43D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021245E48580>]}
[0m21:03:16.584638 [debug] [MainThread]: Flushing usage events
[0m21:03:17.110428 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:01:46.547072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D7B4BE380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D7D43CB20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D7D43C940>]}


============================== 22:01:46.554746 | 3786f192-b245-445b-8d83-1f40fe3b661c ==============================
[0m22:01:46.554746 [info ] [MainThread]: Running with dbt=1.9.0-b1
[0m22:01:46.555755 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\User\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\User\\Desktop\\dbt-Transformations\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:01:46.753978 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m22:01:46.754970 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m22:01:46.950158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3786f192-b245-445b-8d83-1f40fe3b661c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D7DCB24D0>]}
[0m22:01:47.001771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3786f192-b245-445b-8d83-1f40fe3b661c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D7DB232E0>]}
[0m22:01:47.004213 [info ] [MainThread]: Registered adapter: redshift=1.8.1
[0m22:01:47.020228 [debug] [MainThread]: checksum: 342eadeaabeb3b1e51584f606df2b5b2518c39ec1d5d83f52b4bb1c68a4f38ed, vars: {}, profile: , target: , version: 1.9.0b1
[0m22:01:47.220323 [debug] [MainThread]: Partial parsing enabled: 3 files deleted, 0 files added, 0 files changed.
[0m22:01:47.221328 [debug] [MainThread]: Partial parsing: deleted file: dbt_transformations://emekamarkt/models\example\my_first_dbt_model.sql
[0m22:01:47.221328 [debug] [MainThread]: Partial parsing: deleted file: dbt_transformations://emekamarkt/models\example\my_second_dbt_model.sql
[0m22:01:47.284918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3786f192-b245-445b-8d83-1f40fe3b661c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D7E0B0100>]}
[0m22:01:47.373001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3786f192-b245-445b-8d83-1f40fe3b661c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D7DF64040>]}
[0m22:01:47.374000 [info ] [MainThread]: Found 1 model, 489 macros
[0m22:01:47.375000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3786f192-b245-445b-8d83-1f40fe3b661c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D7DF67CA0>]}
[0m22:01:47.377004 [info ] [MainThread]: 
[0m22:01:47.379004 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:01:47.379567 [info ] [MainThread]: 
[0m22:01:47.380655 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m22:01:47.383667 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev'
[0m22:01:47.403663 [debug] [ThreadPool]: Using redshift connection "list_dev"
[0m22:01:47.404669 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.9.0b1", "profile_name": "emekamarkt", "target_name": "dev", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
[0m22:01:47.405662 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:01:47.411715 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:01:47.413755 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m22:01:48.202856 [debug] [ThreadPool]: SQL status: SUCCESS in 0.797 seconds
[0m22:01:48.205964 [debug] [ThreadPool]: On list_dev: Close
[0m22:01:48.208909 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev_public'
[0m22:01:48.217871 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m22:01:48.217871 [debug] [ThreadPool]: On list_dev_public: BEGIN
[0m22:01:48.218876 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:01:48.219890 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:01:48.219890 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m22:01:48.700861 [debug] [ThreadPool]: SQL status: SUCCESS in 0.482 seconds
[0m22:01:48.702860 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m22:01:48.703858 [debug] [ThreadPool]: On list_dev_public: /* {"app": "dbt", "dbt_version": "1.9.0b1", "profile_name": "emekamarkt", "target_name": "dev", "connection_name": "list_dev_public"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'public'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'public'
[0m22:01:48.805935 [debug] [ThreadPool]: SQL status: SUCCESS in 0.100 seconds
[0m22:01:48.810021 [debug] [ThreadPool]: On list_dev_public: ROLLBACK
[0m22:01:48.895701 [debug] [ThreadPool]: On list_dev_public: Close
[0m22:01:48.908715 [debug] [MainThread]: Using redshift connection "master"
[0m22:01:48.908715 [debug] [MainThread]: On master: BEGIN
[0m22:01:48.909715 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:01:48.910715 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:01:48.910715 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m22:01:49.405815 [debug] [MainThread]: SQL status: SUCCESS in 0.496 seconds
[0m22:01:49.406762 [debug] [MainThread]: Using redshift connection "master"
[0m22:01:49.407762 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0b1", "profile_name": "emekamarkt", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m22:01:49.539088 [debug] [MainThread]: SQL status: SUCCESS in 0.130 seconds
[0m22:01:49.542993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3786f192-b245-445b-8d83-1f40fe3b661c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D7E0D87C0>]}
[0m22:01:49.544077 [debug] [MainThread]: On master: ROLLBACK
[0m22:01:49.623399 [debug] [MainThread]: Using redshift connection "master"
[0m22:01:49.625386 [debug] [MainThread]: On master: BEGIN
[0m22:01:49.666346 [debug] [MainThread]: SQL status: SUCCESS in 0.040 seconds
[0m22:01:49.668362 [debug] [MainThread]: On master: COMMIT
[0m22:01:49.670365 [debug] [MainThread]: Using redshift connection "master"
[0m22:01:49.671361 [debug] [MainThread]: On master: COMMIT
[0m22:01:49.751337 [debug] [MainThread]: SQL status: SUCCESS in 0.079 seconds
[0m22:01:49.753470 [debug] [MainThread]: On master: Close
[0m22:01:49.765492 [debug] [Thread-1 (]: Began running node model.dbt_transformations.staging_raw_sales_data
[0m22:01:49.766997 [info ] [Thread-1 (]: 1 of 1 START sql view model public.staging_raw_sales_data ...................... [RUN]
[0m22:01:49.768013 [debug] [Thread-1 (]: Acquiring new redshift connection 'model.dbt_transformations.staging_raw_sales_data'
[0m22:01:49.769095 [debug] [Thread-1 (]: Began compiling node model.dbt_transformations.staging_raw_sales_data
[0m22:01:49.821071 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_transformations.staging_raw_sales_data"
[0m22:01:49.824011 [debug] [Thread-1 (]: Began executing node model.dbt_transformations.staging_raw_sales_data
[0m22:01:49.860220 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_transformations.staging_raw_sales_data"
[0m22:01:49.866782 [debug] [Thread-1 (]: Using redshift connection "model.dbt_transformations.staging_raw_sales_data"
[0m22:01:49.867874 [debug] [Thread-1 (]: On model.dbt_transformations.staging_raw_sales_data: BEGIN
[0m22:01:49.867874 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:01:49.869789 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:01:49.869789 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m22:01:50.358256 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.490 seconds
[0m22:01:50.360337 [debug] [Thread-1 (]: Using redshift connection "model.dbt_transformations.staging_raw_sales_data"
[0m22:01:50.362292 [debug] [Thread-1 (]: On model.dbt_transformations.staging_raw_sales_data: /* {"app": "dbt", "dbt_version": "1.9.0b1", "profile_name": "emekamarkt", "target_name": "dev", "node_id": "model.dbt_transformations.staging_raw_sales_data"} */


  create view "dev"."public"."staging_raw_sales_data__dbt_tmp" as (
    -- models/staging_raw_sales_data.sql



WITH raw_data AS (
    SELECT 
        *
    FROM 
        external_table('s3://emeka-market-raw-sales-data/raw_sales_data.csv',
        'arn:aws:iam::863518444424:role/service-role/AmazonRedshift-CommandsAccessRole-20241004T144721',  -- Replace with your IAM Role ARN
        'CSV',
        'IGNOREHEADER 1',
        'DELIMITER ','',
        'REGION eu-north-1'  
    )
)

SELECT
    SaleID,
    ProductID,
    CustomerID,
    Quantity,
    Date,
    LocationID,
    PaymentID,
    ShippingID,
    PromotionID,
    ReviewID,
    JSON_EXTRACT_PATH_TEXT(Product, 'ProductID')::INT AS Product_ProductID,
    JSON_EXTRACT_PATH_TEXT(Product, 'ProductName') AS Product_ProductName,
    JSON_EXTRACT_PATH_TEXT(Product, 'Category') AS Product_Category,
    JSON_EXTRACT_PATH_TEXT(Product, 'UnitCost')::FLOAT AS Product_UnitCost,
    JSON_EXTRACT_PATH_TEXT(Product, 'UnitPrice')::FLOAT AS Product_UnitPrice,
    JSON_EXTRACT_PATH_TEXT(Customer, 'CustomerID')::INT AS Customer_CustomerID,
    JSON_EXTRACT_PATH_TEXT(Customer, 'CustomerName') AS Customer_CustomerName,
    JSON_EXTRACT_PATH_TEXT(Customer, 'Email') AS Customer_Email,
    JSON_EXTRACT_PATH_TEXT(Customer, 'PhoneNumber') AS Customer_PhoneNumber,
    JSON_EXTRACT_PATH_TEXT(Customer, 'LoyaltyStatus') AS Customer_LoyaltyStatus,
    JSON_EXTRACT_PATH_TEXT(Location, 'LocationID')::INT AS Location_LocationID,
    JSON_EXTRACT_PATH_TEXT(Location, 'Country') AS Location_Country,
    JSON_EXTRACT_PATH_TEXT(Location, 'State') AS Location_State,
    JSON_EXTRACT_PATH_TEXT(Location, 'City') AS Location_City,
    JSON_EXTRACT_PATH_TEXT(Location, 'PostalCode')::INT AS Location_PostalCode,
    JSON_EXTRACT_PATH_TEXT(Location, 'Region') AS Location_Region,
    JSON_EXTRACT_PATH_TEXT(Promotion, 'PromotionID')::INT AS Promotion_PromotionID,
    JSON_EXTRACT_PATH_TEXT(Promotion, 'PromotionName') AS Promotion_PromotionName,
    JSON_EXTRACT_PATH_TEXT(Promotion, 'DiscountRate')::FLOAT AS Promotion_DiscountRate,
    JSON_EXTRACT_PATH_TEXT(Shipping, 'ShippingID')::INT AS Shipping_ShippingID,
    JSON_EXTRACT_PATH_TEXT(Shipping, 'Method') AS Shipping_Method,
    JSON_EXTRACT_PATH_TEXT(Shipping, 'Cost')::FLOAT AS Shipping_Cost,
    JSON_EXTRACT_PATH_TEXT(Review, 'ReviewID')::INT AS Review_ReviewID,
    JSON_EXTRACT_PATH_TEXT(Review, 'ProductID')::INT AS Review_ProductID,
    JSON_EXTRACT_PATH_TEXT(Review, 'CustomerID')::INT AS Review_CustomerID,
    JSON_EXTRACT_PATH_TEXT(Review, 'Rating')::INT AS Review_Rating,
    JSON_EXTRACT_PATH_TEXT(Review, 'Comment') AS Review_Comment,
    JSON_EXTRACT_PATH_TEXT(MarketingChannel, 'ChannelID')::INT AS MarketingChannel_ChannelID,
    JSON_EXTRACT_PATH_TEXT(MarketingChannel, 'ChannelName') AS MarketingChannel_ChannelName
FROM raw_data
  ) ;
[0m22:01:50.408326 [debug] [Thread-1 (]: Redshift adapter: Redshift error: function external_table("unknown", "unknown", "unknown", "unknown", "unknown", "unknown", "unknown") does not exist
[0m22:01:50.410417 [debug] [Thread-1 (]: On model.dbt_transformations.staging_raw_sales_data: ROLLBACK
[0m22:01:50.491335 [debug] [Thread-1 (]: On model.dbt_transformations.staging_raw_sales_data: Close
[0m22:01:50.498390 [debug] [Thread-1 (]: Database Error in model staging_raw_sales_data (emekamarkt/models\staging_raw_sales_data.sql)
  function external_table("unknown", "unknown", "unknown", "unknown", "unknown", "unknown", "unknown") does not exist
  compiled code at target\run\dbt_transformations\emekamarkt/models\staging_raw_sales_data.sql
[0m22:01:50.500496 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3786f192-b245-445b-8d83-1f40fe3b661c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D7DF64520>]}
[0m22:01:50.502399 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model public.staging_raw_sales_data ............. [[31mERROR[0m in 0.73s]
[0m22:01:50.503207 [debug] [Thread-1 (]: Finished running node model.dbt_transformations.staging_raw_sales_data
[0m22:01:50.504306 [debug] [Thread-4 (]: Marking all children of 'model.dbt_transformations.staging_raw_sales_data' to be skipped because of status 'error'.  Reason: Database Error in model staging_raw_sales_data (emekamarkt/models\staging_raw_sales_data.sql)
  function external_table("unknown", "unknown", "unknown", "unknown", "unknown", "unknown", "unknown") does not exist
  compiled code at target\run\dbt_transformations\emekamarkt/models\staging_raw_sales_data.sql.
[0m22:01:50.506218 [debug] [MainThread]: Using redshift connection "master"
[0m22:01:50.507320 [debug] [MainThread]: On master: BEGIN
[0m22:01:50.507320 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:01:50.508326 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:01:50.509347 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m22:01:50.967851 [debug] [MainThread]: SQL status: SUCCESS in 0.461 seconds
[0m22:01:50.968856 [debug] [MainThread]: On master: COMMIT
[0m22:01:50.969445 [debug] [MainThread]: Using redshift connection "master"
[0m22:01:50.970475 [debug] [MainThread]: On master: COMMIT
[0m22:01:51.051401 [debug] [MainThread]: SQL status: SUCCESS in 0.080 seconds
[0m22:01:51.051401 [debug] [MainThread]: On master: Close
[0m22:01:51.052412 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:01:51.053408 [debug] [MainThread]: Connection 'list_dev' was properly closed.
[0m22:01:51.053408 [debug] [MainThread]: Connection 'list_dev_public' was properly closed.
[0m22:01:51.054413 [debug] [MainThread]: Connection 'model.dbt_transformations.staging_raw_sales_data' was properly closed.
[0m22:01:51.054413 [info ] [MainThread]: 
[0m22:01:51.055641 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.67 seconds (3.67s).
[0m22:01:51.057647 [debug] [MainThread]: Command end result
[0m22:01:51.091155 [info ] [MainThread]: 
[0m22:01:51.092527 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successs, and 0 warnings:[0m
[0m22:01:51.093559 [info ] [MainThread]: 
[0m22:01:51.095534 [error] [MainThread]:   Database Error in model staging_raw_sales_data (emekamarkt/models\staging_raw_sales_data.sql)
  function external_table("unknown", "unknown", "unknown", "unknown", "unknown", "unknown", "unknown") does not exist
  compiled code at target\run\dbt_transformations\emekamarkt/models\staging_raw_sales_data.sql
[0m22:01:51.097577 [info ] [MainThread]: 
[0m22:01:51.098535 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m22:01:51.100542 [debug] [MainThread]: Command `dbt run` failed at 22:01:51.100542 after 4.64 seconds
[0m22:01:51.102534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D7B4BE380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D7C7FC220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D7A89A620>]}
[0m22:01:51.103536 [debug] [MainThread]: Flushing usage events
[0m22:01:51.618903 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:40:41.954941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002094D4DE3B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002094F409090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002094F408EB0>]}


============================== 22:40:41.961944 | 9e3c3407-0cc3-402b-bf6c-214795b3575e ==============================
[0m22:40:41.961944 [info ] [MainThread]: Running with dbt=1.9.0-b1
[0m22:40:41.962944 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\User\\Desktop\\dbt-Transformations\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\User\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:40:42.181377 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m22:40:42.181377 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m22:40:42.380429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9e3c3407-0cc3-402b-bf6c-214795b3575e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002094FCCD060>]}
[0m22:40:42.432721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9e3c3407-0cc3-402b-bf6c-214795b3575e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002094FB43310>]}
[0m22:40:42.435056 [info ] [MainThread]: Registered adapter: redshift=1.8.1
[0m22:40:42.453000 [debug] [MainThread]: checksum: 342eadeaabeb3b1e51584f606df2b5b2518c39ec1d5d83f52b4bb1c68a4f38ed, vars: {}, profile: , target: , version: 1.9.0b1
[0m22:40:42.693823 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:40:42.694824 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:40:42.721895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9e3c3407-0cc3-402b-bf6c-214795b3575e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020950080130>]}
[0m22:40:42.809225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9e3c3407-0cc3-402b-bf6c-214795b3575e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002095006F700>]}
[0m22:40:42.811223 [info ] [MainThread]: Found 1 model, 489 macros
[0m22:40:42.812223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9e3c3407-0cc3-402b-bf6c-214795b3575e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002095006FD60>]}
[0m22:40:42.814225 [info ] [MainThread]: 
[0m22:40:42.815224 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:40:42.816230 [info ] [MainThread]: 
[0m22:40:42.817227 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m22:40:42.819230 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev'
[0m22:40:42.839442 [debug] [ThreadPool]: Using redshift connection "list_dev"
[0m22:40:42.840359 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.9.0b1", "profile_name": "emekamarkt", "target_name": "dev", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
[0m22:40:42.840359 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:40:42.844434 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:40:42.845423 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m22:40:43.606412 [debug] [ThreadPool]: SQL status: SUCCESS in 0.766 seconds
[0m22:40:43.608526 [debug] [ThreadPool]: On list_dev: Close
[0m22:40:43.609441 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev_public'
[0m22:40:43.618438 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m22:40:43.618438 [debug] [ThreadPool]: On list_dev_public: BEGIN
[0m22:40:43.619446 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:40:43.620438 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:40:43.620438 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m22:40:44.100977 [debug] [ThreadPool]: SQL status: SUCCESS in 0.482 seconds
[0m22:40:44.103080 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m22:40:44.104081 [debug] [ThreadPool]: On list_dev_public: /* {"app": "dbt", "dbt_version": "1.9.0b1", "profile_name": "emekamarkt", "target_name": "dev", "connection_name": "list_dev_public"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'public'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'public'
[0m22:40:44.203623 [debug] [ThreadPool]: SQL status: SUCCESS in 0.098 seconds
[0m22:40:44.207729 [debug] [ThreadPool]: On list_dev_public: ROLLBACK
[0m22:40:44.287983 [debug] [ThreadPool]: On list_dev_public: Close
[0m22:40:44.302114 [debug] [MainThread]: Using redshift connection "master"
[0m22:40:44.303120 [debug] [MainThread]: On master: BEGIN
[0m22:40:44.303120 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:40:44.304033 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:40:44.304033 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m22:40:44.794620 [debug] [MainThread]: SQL status: SUCCESS in 0.492 seconds
[0m22:40:44.796729 [debug] [MainThread]: Using redshift connection "master"
[0m22:40:44.797664 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0b1", "profile_name": "emekamarkt", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m22:40:44.929096 [debug] [MainThread]: SQL status: SUCCESS in 0.129 seconds
[0m22:40:44.933200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9e3c3407-0cc3-402b-bf6c-214795b3575e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000209500949A0>]}
[0m22:40:44.934205 [debug] [MainThread]: On master: ROLLBACK
[0m22:40:45.023001 [debug] [MainThread]: Using redshift connection "master"
[0m22:40:45.023986 [debug] [MainThread]: On master: BEGIN
[0m22:40:45.063996 [debug] [MainThread]: SQL status: SUCCESS in 0.040 seconds
[0m22:40:45.065996 [debug] [MainThread]: On master: COMMIT
[0m22:40:45.066996 [debug] [MainThread]: Using redshift connection "master"
[0m22:40:45.068001 [debug] [MainThread]: On master: COMMIT
[0m22:40:45.148602 [debug] [MainThread]: SQL status: SUCCESS in 0.080 seconds
[0m22:40:45.149610 [debug] [MainThread]: On master: Close
[0m22:40:45.158562 [debug] [Thread-1 (]: Began running node model.dbt_transformations.staging_raw_sales_data
[0m22:40:45.159526 [info ] [Thread-1 (]: 1 of 1 START sql view model public.staging_raw_sales_data ...................... [RUN]
[0m22:40:45.160528 [debug] [Thread-1 (]: Acquiring new redshift connection 'model.dbt_transformations.staging_raw_sales_data'
[0m22:40:45.161531 [debug] [Thread-1 (]: Began compiling node model.dbt_transformations.staging_raw_sales_data
[0m22:40:45.165527 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_transformations.staging_raw_sales_data"
[0m22:40:45.167541 [debug] [Thread-1 (]: Began executing node model.dbt_transformations.staging_raw_sales_data
[0m22:40:45.211206 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_transformations.staging_raw_sales_data"
[0m22:40:45.262210 [debug] [Thread-1 (]: Using redshift connection "model.dbt_transformations.staging_raw_sales_data"
[0m22:40:45.262210 [debug] [Thread-1 (]: On model.dbt_transformations.staging_raw_sales_data: BEGIN
[0m22:40:45.263211 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:40:45.264210 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:40:45.265214 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m22:40:45.747883 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.485 seconds
[0m22:40:45.749989 [debug] [Thread-1 (]: Using redshift connection "model.dbt_transformations.staging_raw_sales_data"
[0m22:40:45.752908 [debug] [Thread-1 (]: On model.dbt_transformations.staging_raw_sales_data: /* {"app": "dbt", "dbt_version": "1.9.0b1", "profile_name": "emekamarkt", "target_name": "dev", "node_id": "model.dbt_transformations.staging_raw_sales_data"} */


  create view "dev"."public"."staging_raw_sales_data__dbt_tmp" as (
    -- models/staging_raw_sales_data.sql



WITH raw_data AS (
    SELECT 
        *
    FROM 
        external_table('s3://emeka-market-raw-sales-data/raw_sales_data.csv',
        'arn:aws:iam::863518444424:role/service-role/AmazonRedshift-CommandsAccessRole-20241004T144721',  -- Replace with your IAM Role ARN
        'CSV',
        'IGNOREHEADER 1',
        'DELIMITER ','',
        'REGION eu-north-1'  
    )
)

SELECT
    SaleID,
    ProductID,
    CustomerID,
    Quantity,
    Date,
    LocationID,
    PaymentID,
    ShippingID,
    PromotionID,
    ReviewID,
    JSON_EXTRACT_PATH_TEXT(Product, 'ProductID')::INT AS Product_ProductID,
    JSON_EXTRACT_PATH_TEXT(Product, 'ProductName') AS Product_ProductName,
    JSON_EXTRACT_PATH_TEXT(Product, 'Category') AS Product_Category,
    JSON_EXTRACT_PATH_TEXT(Product, 'UnitCost')::FLOAT AS Product_UnitCost,
    JSON_EXTRACT_PATH_TEXT(Product, 'UnitPrice')::FLOAT AS Product_UnitPrice,
    JSON_EXTRACT_PATH_TEXT(Customer, 'CustomerID')::INT AS Customer_CustomerID,
    JSON_EXTRACT_PATH_TEXT(Customer, 'CustomerName') AS Customer_CustomerName,
    JSON_EXTRACT_PATH_TEXT(Customer, 'Email') AS Customer_Email,
    JSON_EXTRACT_PATH_TEXT(Customer, 'PhoneNumber') AS Customer_PhoneNumber,
    JSON_EXTRACT_PATH_TEXT(Customer, 'LoyaltyStatus') AS Customer_LoyaltyStatus,
    JSON_EXTRACT_PATH_TEXT(Location, 'LocationID')::INT AS Location_LocationID,
    JSON_EXTRACT_PATH_TEXT(Location, 'Country') AS Location_Country,
    JSON_EXTRACT_PATH_TEXT(Location, 'State') AS Location_State,
    JSON_EXTRACT_PATH_TEXT(Location, 'City') AS Location_City,
    JSON_EXTRACT_PATH_TEXT(Location, 'PostalCode')::INT AS Location_PostalCode,
    JSON_EXTRACT_PATH_TEXT(Location, 'Region') AS Location_Region,
    JSON_EXTRACT_PATH_TEXT(Promotion, 'PromotionID')::INT AS Promotion_PromotionID,
    JSON_EXTRACT_PATH_TEXT(Promotion, 'PromotionName') AS Promotion_PromotionName,
    JSON_EXTRACT_PATH_TEXT(Promotion, 'DiscountRate')::FLOAT AS Promotion_DiscountRate,
    JSON_EXTRACT_PATH_TEXT(Shipping, 'ShippingID')::INT AS Shipping_ShippingID,
    JSON_EXTRACT_PATH_TEXT(Shipping, 'Method') AS Shipping_Method,
    JSON_EXTRACT_PATH_TEXT(Shipping, 'Cost')::FLOAT AS Shipping_Cost,
    JSON_EXTRACT_PATH_TEXT(Review, 'ReviewID')::INT AS Review_ReviewID,
    JSON_EXTRACT_PATH_TEXT(Review, 'ProductID')::INT AS Review_ProductID,
    JSON_EXTRACT_PATH_TEXT(Review, 'CustomerID')::INT AS Review_CustomerID,
    JSON_EXTRACT_PATH_TEXT(Review, 'Rating')::INT AS Review_Rating,
    JSON_EXTRACT_PATH_TEXT(Review, 'Comment') AS Review_Comment,
    JSON_EXTRACT_PATH_TEXT(MarketingChannel, 'ChannelID')::INT AS MarketingChannel_ChannelID,
    JSON_EXTRACT_PATH_TEXT(MarketingChannel, 'ChannelName') AS MarketingChannel_ChannelName
FROM raw_data
  ) ;
[0m22:40:45.796174 [debug] [Thread-1 (]: Redshift adapter: Redshift error: function external_table("unknown", "unknown", "unknown", "unknown", "unknown", "unknown", "unknown") does not exist
[0m22:40:45.798171 [debug] [Thread-1 (]: On model.dbt_transformations.staging_raw_sales_data: ROLLBACK
[0m22:40:45.876992 [debug] [Thread-1 (]: On model.dbt_transformations.staging_raw_sales_data: Close
[0m22:40:45.885876 [debug] [Thread-1 (]: Database Error in model staging_raw_sales_data (emekamarkt/models\staging_raw_sales_data.sql)
  function external_table("unknown", "unknown", "unknown", "unknown", "unknown", "unknown", "unknown") does not exist
  compiled code at target\run\dbt_transformations\emekamarkt/models\staging_raw_sales_data.sql
[0m22:40:45.888866 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9e3c3407-0cc3-402b-bf6c-214795b3575e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002094BBEFE50>]}
[0m22:40:45.889785 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model public.staging_raw_sales_data ............. [[31mERROR[0m in 0.73s]
[0m22:40:45.891783 [debug] [Thread-1 (]: Finished running node model.dbt_transformations.staging_raw_sales_data
[0m22:40:45.891783 [debug] [Thread-4 (]: Marking all children of 'model.dbt_transformations.staging_raw_sales_data' to be skipped because of status 'error'.  Reason: Database Error in model staging_raw_sales_data (emekamarkt/models\staging_raw_sales_data.sql)
  function external_table("unknown", "unknown", "unknown", "unknown", "unknown", "unknown", "unknown") does not exist
  compiled code at target\run\dbt_transformations\emekamarkt/models\staging_raw_sales_data.sql.
[0m22:40:45.894822 [debug] [MainThread]: Using redshift connection "master"
[0m22:40:45.894822 [debug] [MainThread]: On master: BEGIN
[0m22:40:45.895866 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:40:45.895866 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:40:45.896869 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m22:40:46.373961 [debug] [MainThread]: SQL status: SUCCESS in 0.479 seconds
[0m22:40:46.375967 [debug] [MainThread]: On master: COMMIT
[0m22:40:46.377178 [debug] [MainThread]: Using redshift connection "master"
[0m22:40:46.378095 [debug] [MainThread]: On master: COMMIT
[0m22:40:46.450900 [debug] [MainThread]: SQL status: SUCCESS in 0.073 seconds
[0m22:40:46.452933 [debug] [MainThread]: On master: Close
[0m22:40:46.455004 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:40:46.456009 [debug] [MainThread]: Connection 'list_dev' was properly closed.
[0m22:40:46.456962 [debug] [MainThread]: Connection 'list_dev_public' was properly closed.
[0m22:40:46.458021 [debug] [MainThread]: Connection 'model.dbt_transformations.staging_raw_sales_data' was properly closed.
[0m22:40:46.458021 [info ] [MainThread]: 
[0m22:40:46.459914 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.64 seconds (3.64s).
[0m22:40:46.462019 [debug] [MainThread]: Command end result
[0m22:40:46.495533 [info ] [MainThread]: 
[0m22:40:46.496530 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successs, and 0 warnings:[0m
[0m22:40:46.498535 [info ] [MainThread]: 
[0m22:40:46.499807 [error] [MainThread]:   Database Error in model staging_raw_sales_data (emekamarkt/models\staging_raw_sales_data.sql)
  function external_table("unknown", "unknown", "unknown", "unknown", "unknown", "unknown", "unknown") does not exist
  compiled code at target\run\dbt_transformations\emekamarkt/models\staging_raw_sales_data.sql
[0m22:40:46.500815 [info ] [MainThread]: 
[0m22:40:46.501910 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m22:40:46.503815 [debug] [MainThread]: Command `dbt run` failed at 22:40:46.503815 after 4.65 seconds
[0m22:40:46.504819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002094D4DE3B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002094FF76AA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020950082770>]}
[0m22:40:46.506836 [debug] [MainThread]: Flushing usage events
[0m22:40:47.031701 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:41:44.925253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002988DF923E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002988FEBD0F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002988FEBCF10>]}


============================== 22:41:44.930258 | be741824-41c6-4c8a-a091-ffad8c2f1c8a ==============================
[0m22:41:44.930258 [info ] [MainThread]: Running with dbt=1.9.0-b1
[0m22:41:44.931263 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\User\\Desktop\\dbt-Transformations\\logs', 'profiles_dir': 'C:\\Users\\User\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m22:41:45.099869 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m22:41:45.100865 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m22:41:45.272230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'be741824-41c6-4c8a-a091-ffad8c2f1c8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002988F3011E0>]}
[0m22:41:45.327327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'be741824-41c6-4c8a-a091-ffad8c2f1c8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000298905F3340>]}
[0m22:41:45.329233 [info ] [MainThread]: Registered adapter: redshift=1.8.1
[0m22:41:45.340835 [debug] [MainThread]: checksum: 342eadeaabeb3b1e51584f606df2b5b2518c39ec1d5d83f52b4bb1c68a4f38ed, vars: {}, profile: , target: , version: 1.9.0b1
[0m22:41:45.538094 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:41:45.539101 [debug] [MainThread]: Partial parsing: updated file: dbt_transformations://emekamarkt/models\staging_raw_sales_data.sql
[0m22:41:45.727620 [error] [MainThread]: Encountered an error:
Compilation Error in model staging_raw_sales_data (emekamarkt/models\staging_raw_sales_data.sql)
  expected token ',', got 'string'
    line 4
      materialized='table'  -- Use 'view' if preferred
[0m22:41:45.730631 [debug] [MainThread]: Command `dbt run` failed at 22:41:45.730631 after 0.88 seconds
[0m22:41:45.730631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002988DF923E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029891C0BBB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029891C0BD00>]}
[0m22:41:45.731630 [debug] [MainThread]: Flushing usage events
[0m22:41:46.233111 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:43:17.751081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7C36EE380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7C566CB20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7C566C940>]}


============================== 22:43:17.754597 | f0a5511d-86f3-45fe-ad6d-3f9575c69b8d ==============================
[0m22:43:17.754597 [info ] [MainThread]: Running with dbt=1.9.0-b1
[0m22:43:17.756601 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\User\\Desktop\\dbt-Transformations\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\User\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:43:17.924441 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m22:43:17.925444 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m22:43:18.089976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f0a5511d-86f3-45fe-ad6d-3f9575c69b8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7C5EE24D0>]}
[0m22:43:18.142503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f0a5511d-86f3-45fe-ad6d-3f9575c69b8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7C5D532E0>]}
[0m22:43:18.144435 [info ] [MainThread]: Registered adapter: redshift=1.8.1
[0m22:43:18.160490 [debug] [MainThread]: checksum: 342eadeaabeb3b1e51584f606df2b5b2518c39ec1d5d83f52b4bb1c68a4f38ed, vars: {}, profile: , target: , version: 1.9.0b1
[0m22:43:18.326083 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:43:18.327082 [debug] [MainThread]: Partial parsing: updated file: dbt_transformations://emekamarkt/models\staging_raw_sales_data.sql
[0m22:43:18.494898 [error] [MainThread]: Encountered an error:
Compilation Error in model staging_raw_sales_data (emekamarkt/models\staging_raw_sales_data.sql)
  expected token ',', got 'string'
    line 4
      materialized='table'  -- Use 'view' if preferred
[0m22:43:18.497751 [debug] [MainThread]: Command `dbt run` failed at 22:43:18.497751 after 0.83 seconds
[0m22:43:18.498852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7C36EE380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7C639BB20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7C639BC70>]}
[0m22:43:18.498852 [debug] [MainThread]: Flushing usage events
[0m22:43:19.096954 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:44:02.622085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5AC8E23B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5AE809090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5AE808EB0>]}


============================== 22:44:02.627649 | 544c1c6d-6d5f-4c72-ad64-87e5eb2e7cfb ==============================
[0m22:44:02.627649 [info ] [MainThread]: Running with dbt=1.9.0-b1
[0m22:44:02.628650 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\User\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\User\\Desktop\\dbt-Transformations\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m22:44:02.807431 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m22:44:02.808472 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m22:44:02.986947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '544c1c6d-6d5f-4c72-ad64-87e5eb2e7cfb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5AF0D1060>]}
[0m22:44:03.046950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '544c1c6d-6d5f-4c72-ad64-87e5eb2e7cfb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5AEF43310>]}
[0m22:44:03.049208 [info ] [MainThread]: Registered adapter: redshift=1.8.1
[0m22:44:03.063504 [debug] [MainThread]: checksum: 342eadeaabeb3b1e51584f606df2b5b2518c39ec1d5d83f52b4bb1c68a4f38ed, vars: {}, profile: , target: , version: 1.9.0b1
[0m22:44:03.255204 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:44:03.256203 [debug] [MainThread]: Partial parsing: updated file: dbt_transformations://emekamarkt/models\staging_raw_sales_data.sql
[0m22:44:03.467125 [error] [MainThread]: Encountered an error:
Compilation Error in model staging_raw_sales_data (emekamarkt/models\staging_raw_sales_data.sql)
  expected token ',', got 'string'
    line 4
      materialized='view'  -- Use 'view' if preferred
[0m22:44:03.469618 [debug] [MainThread]: Command `dbt run` failed at 22:44:03.469618 after 0.93 seconds
[0m22:44:03.470691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5AC8E23B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5AF58BB80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5AF58BCD0>]}
[0m22:44:03.471605 [debug] [MainThread]: Flushing usage events
[0m22:44:03.968190 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:44:50.692948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000277D4882350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000277D67FCB50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000277D67FC970>]}


============================== 22:44:50.696977 | c544e765-60b0-4eca-bab0-67fbd27e78f8 ==============================
[0m22:44:50.696977 [info ] [MainThread]: Running with dbt=1.9.0-b1
[0m22:44:50.698901 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\User\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\User\\Desktop\\dbt-Transformations\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m22:44:50.860224 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m22:44:50.861233 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m22:44:51.028730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c544e765-60b0-4eca-bab0-67fbd27e78f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000277D6F3D150>]}
[0m22:44:51.083244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c544e765-60b0-4eca-bab0-67fbd27e78f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000277D6EE32B0>]}
[0m22:44:51.084984 [info ] [MainThread]: Registered adapter: redshift=1.8.1
[0m22:44:51.096994 [debug] [MainThread]: checksum: 342eadeaabeb3b1e51584f606df2b5b2518c39ec1d5d83f52b4bb1c68a4f38ed, vars: {}, profile: , target: , version: 1.9.0b1
[0m22:44:51.253353 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:44:51.254355 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:44:51.282870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c544e765-60b0-4eca-bab0-67fbd27e78f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000277D7420130>]}
[0m22:44:51.359478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c544e765-60b0-4eca-bab0-67fbd27e78f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000277D741BE50>]}
[0m22:44:51.359478 [info ] [MainThread]: Found 1 model, 489 macros
[0m22:44:51.361516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c544e765-60b0-4eca-bab0-67fbd27e78f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000277D741BCA0>]}
[0m22:44:51.363568 [info ] [MainThread]: 
[0m22:44:51.364477 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:44:51.366477 [info ] [MainThread]: 
[0m22:44:51.367480 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m22:44:51.369035 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev'
[0m22:44:51.388039 [debug] [ThreadPool]: Using redshift connection "list_dev"
[0m22:44:51.389041 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.9.0b1", "profile_name": "emekamarkt", "target_name": "dev", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
[0m22:44:51.390042 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:44:51.394050 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:44:51.395041 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m22:44:52.144951 [debug] [ThreadPool]: SQL status: SUCCESS in 0.755 seconds
[0m22:44:52.149012 [debug] [ThreadPool]: On list_dev: Close
[0m22:44:52.152109 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev_public'
[0m22:44:52.160621 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m22:44:52.160621 [debug] [ThreadPool]: On list_dev_public: BEGIN
[0m22:44:52.161623 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:44:52.162624 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:44:52.162624 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m22:44:52.649508 [debug] [ThreadPool]: SQL status: SUCCESS in 0.488 seconds
[0m22:44:52.651625 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m22:44:52.652569 [debug] [ThreadPool]: On list_dev_public: /* {"app": "dbt", "dbt_version": "1.9.0b1", "profile_name": "emekamarkt", "target_name": "dev", "connection_name": "list_dev_public"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'public'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'public'
[0m22:44:52.749573 [debug] [ThreadPool]: SQL status: SUCCESS in 0.095 seconds
[0m22:44:52.753560 [debug] [ThreadPool]: On list_dev_public: ROLLBACK
[0m22:44:52.836281 [debug] [ThreadPool]: On list_dev_public: Close
[0m22:44:52.852748 [debug] [MainThread]: Using redshift connection "master"
[0m22:44:52.853732 [debug] [MainThread]: On master: BEGIN
[0m22:44:52.853732 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:44:52.854753 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:44:52.855698 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m22:44:53.338923 [debug] [MainThread]: SQL status: SUCCESS in 0.485 seconds
[0m22:44:53.341036 [debug] [MainThread]: Using redshift connection "master"
[0m22:44:53.342946 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0b1", "profile_name": "emekamarkt", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m22:44:53.472696 [debug] [MainThread]: SQL status: SUCCESS in 0.129 seconds
[0m22:44:53.477802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c544e765-60b0-4eca-bab0-67fbd27e78f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000277D7435360>]}
[0m22:44:53.478805 [debug] [MainThread]: On master: ROLLBACK
[0m22:44:53.556259 [debug] [MainThread]: Using redshift connection "master"
[0m22:44:53.558163 [debug] [MainThread]: On master: BEGIN
[0m22:44:53.597550 [debug] [MainThread]: SQL status: SUCCESS in 0.038 seconds
[0m22:44:53.598548 [debug] [MainThread]: On master: COMMIT
[0m22:44:53.599549 [debug] [MainThread]: Using redshift connection "master"
[0m22:44:53.599549 [debug] [MainThread]: On master: COMMIT
[0m22:44:53.681515 [debug] [MainThread]: SQL status: SUCCESS in 0.081 seconds
[0m22:44:53.683476 [debug] [MainThread]: On master: Close
[0m22:44:53.691215 [debug] [Thread-1 (]: Began running node model.dbt_transformations.staging_raw_sales_data
[0m22:44:53.692303 [info ] [Thread-1 (]: 1 of 1 START sql view model public.staging_raw_sales_data ...................... [RUN]
[0m22:44:53.694318 [debug] [Thread-1 (]: Acquiring new redshift connection 'model.dbt_transformations.staging_raw_sales_data'
[0m22:44:53.695218 [debug] [Thread-1 (]: Began compiling node model.dbt_transformations.staging_raw_sales_data
[0m22:44:53.700218 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_transformations.staging_raw_sales_data"
[0m22:44:53.702221 [debug] [Thread-1 (]: Began executing node model.dbt_transformations.staging_raw_sales_data
[0m22:44:53.743320 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_transformations.staging_raw_sales_data"
[0m22:44:53.789900 [debug] [Thread-1 (]: Using redshift connection "model.dbt_transformations.staging_raw_sales_data"
[0m22:44:53.790911 [debug] [Thread-1 (]: On model.dbt_transformations.staging_raw_sales_data: BEGIN
[0m22:44:53.791891 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:44:53.791891 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:44:53.792821 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m22:44:54.272642 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.481 seconds
[0m22:44:54.274622 [debug] [Thread-1 (]: Using redshift connection "model.dbt_transformations.staging_raw_sales_data"
[0m22:44:54.276621 [debug] [Thread-1 (]: On model.dbt_transformations.staging_raw_sales_data: /* {"app": "dbt", "dbt_version": "1.9.0b1", "profile_name": "emekamarkt", "target_name": "dev", "node_id": "model.dbt_transformations.staging_raw_sales_data"} */


  create view "dev"."public"."staging_raw_sales_data__dbt_tmp" as (
    -- models/staging_raw_sales_data.sql



WITH raw_data AS (
    SELECT 
        *
    FROM 
        external_table('s3://emeka-market-raw-sales-data/raw_sales_data.csv',
        'arn:aws:iam::863518444424:role/service-role/AmazonRedshift-CommandsAccessRole-20241004T144721',  -- Replace with your IAM Role ARN
        'CSV',
        'IGNOREHEADER 1',
        'DELIMITER ','',
        'REGION eu-north-1'  
    )
)

SELECT
    SaleID,
    ProductID,
    CustomerID,
    Quantity,
    Date,
    LocationID,
    PaymentID,
    ShippingID,
    PromotionID,
    ReviewID,
    JSON_EXTRACT_PATH_TEXT(Product, 'ProductID')::INT AS Product_ProductID,
    JSON_EXTRACT_PATH_TEXT(Product, 'ProductName') AS Product_ProductName,
    JSON_EXTRACT_PATH_TEXT(Product, 'Category') AS Product_Category,
    JSON_EXTRACT_PATH_TEXT(Product, 'UnitCost')::FLOAT AS Product_UnitCost,
    JSON_EXTRACT_PATH_TEXT(Product, 'UnitPrice')::FLOAT AS Product_UnitPrice,
    JSON_EXTRACT_PATH_TEXT(Customer, 'CustomerID')::INT AS Customer_CustomerID,
    JSON_EXTRACT_PATH_TEXT(Customer, 'CustomerName') AS Customer_CustomerName,
    JSON_EXTRACT_PATH_TEXT(Customer, 'Email') AS Customer_Email,
    JSON_EXTRACT_PATH_TEXT(Customer, 'PhoneNumber') AS Customer_PhoneNumber,
    JSON_EXTRACT_PATH_TEXT(Customer, 'LoyaltyStatus') AS Customer_LoyaltyStatus,
    JSON_EXTRACT_PATH_TEXT(Location, 'LocationID')::INT AS Location_LocationID,
    JSON_EXTRACT_PATH_TEXT(Location, 'Country') AS Location_Country,
    JSON_EXTRACT_PATH_TEXT(Location, 'State') AS Location_State,
    JSON_EXTRACT_PATH_TEXT(Location, 'City') AS Location_City,
    JSON_EXTRACT_PATH_TEXT(Location, 'PostalCode')::INT AS Location_PostalCode,
    JSON_EXTRACT_PATH_TEXT(Location, 'Region') AS Location_Region,
    JSON_EXTRACT_PATH_TEXT(Promotion, 'PromotionID')::INT AS Promotion_PromotionID,
    JSON_EXTRACT_PATH_TEXT(Promotion, 'PromotionName') AS Promotion_PromotionName,
    JSON_EXTRACT_PATH_TEXT(Promotion, 'DiscountRate')::FLOAT AS Promotion_DiscountRate,
    JSON_EXTRACT_PATH_TEXT(Shipping, 'ShippingID')::INT AS Shipping_ShippingID,
    JSON_EXTRACT_PATH_TEXT(Shipping, 'Method') AS Shipping_Method,
    JSON_EXTRACT_PATH_TEXT(Shipping, 'Cost')::FLOAT AS Shipping_Cost,
    JSON_EXTRACT_PATH_TEXT(Review, 'ReviewID')::INT AS Review_ReviewID,
    JSON_EXTRACT_PATH_TEXT(Review, 'ProductID')::INT AS Review_ProductID,
    JSON_EXTRACT_PATH_TEXT(Review, 'CustomerID')::INT AS Review_CustomerID,
    JSON_EXTRACT_PATH_TEXT(Review, 'Rating')::INT AS Review_Rating,
    JSON_EXTRACT_PATH_TEXT(Review, 'Comment') AS Review_Comment,
    JSON_EXTRACT_PATH_TEXT(MarketingChannel, 'ChannelID')::INT AS MarketingChannel_ChannelID,
    JSON_EXTRACT_PATH_TEXT(MarketingChannel, 'ChannelName') AS MarketingChannel_ChannelName
FROM raw_data
  ) ;
[0m22:44:54.318528 [debug] [Thread-1 (]: Redshift adapter: Redshift error: function external_table("unknown", "unknown", "unknown", "unknown", "unknown", "unknown", "unknown") does not exist
[0m22:44:54.320526 [debug] [Thread-1 (]: On model.dbt_transformations.staging_raw_sales_data: ROLLBACK
[0m22:44:54.397096 [debug] [Thread-1 (]: On model.dbt_transformations.staging_raw_sales_data: Close
[0m22:44:54.401092 [debug] [Thread-1 (]: Database Error in model staging_raw_sales_data (emekamarkt/models\staging_raw_sales_data.sql)
  function external_table("unknown", "unknown", "unknown", "unknown", "unknown", "unknown", "unknown") does not exist
  compiled code at target\run\dbt_transformations\emekamarkt/models\staging_raw_sales_data.sql
[0m22:44:54.402092 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c544e765-60b0-4eca-bab0-67fbd27e78f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000277D672BE80>]}
[0m22:44:54.403093 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model public.staging_raw_sales_data ............. [[31mERROR[0m in 0.71s]
[0m22:44:54.405139 [debug] [Thread-1 (]: Finished running node model.dbt_transformations.staging_raw_sales_data
[0m22:44:54.406196 [debug] [Thread-4 (]: Marking all children of 'model.dbt_transformations.staging_raw_sales_data' to be skipped because of status 'error'.  Reason: Database Error in model staging_raw_sales_data (emekamarkt/models\staging_raw_sales_data.sql)
  function external_table("unknown", "unknown", "unknown", "unknown", "unknown", "unknown", "unknown") does not exist
  compiled code at target\run\dbt_transformations\emekamarkt/models\staging_raw_sales_data.sql.
[0m22:44:54.408093 [debug] [MainThread]: Using redshift connection "master"
[0m22:44:54.409199 [debug] [MainThread]: On master: BEGIN
[0m22:44:54.409199 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:44:54.410154 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:44:54.411139 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m22:44:54.879447 [debug] [MainThread]: SQL status: SUCCESS in 0.470 seconds
[0m22:44:54.881555 [debug] [MainThread]: On master: COMMIT
[0m22:44:54.883484 [debug] [MainThread]: Using redshift connection "master"
[0m22:44:54.884472 [debug] [MainThread]: On master: COMMIT
[0m22:44:54.964287 [debug] [MainThread]: SQL status: SUCCESS in 0.079 seconds
[0m22:44:54.965138 [debug] [MainThread]: On master: Close
[0m22:44:54.966134 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:44:54.967133 [debug] [MainThread]: Connection 'list_dev' was properly closed.
[0m22:44:54.967133 [debug] [MainThread]: Connection 'list_dev_public' was properly closed.
[0m22:44:54.968162 [debug] [MainThread]: Connection 'model.dbt_transformations.staging_raw_sales_data' was properly closed.
[0m22:44:54.969134 [info ] [MainThread]: 
[0m22:44:54.970137 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.60 seconds (3.60s).
[0m22:44:54.972138 [debug] [MainThread]: Command end result
[0m22:44:55.004139 [info ] [MainThread]: 
[0m22:44:55.006146 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successs, and 0 warnings:[0m
[0m22:44:55.007133 [info ] [MainThread]: 
[0m22:44:55.008231 [error] [MainThread]:   Database Error in model staging_raw_sales_data (emekamarkt/models\staging_raw_sales_data.sql)
  function external_table("unknown", "unknown", "unknown", "unknown", "unknown", "unknown", "unknown") does not exist
  compiled code at target\run\dbt_transformations\emekamarkt/models\staging_raw_sales_data.sql
[0m22:44:55.010132 [info ] [MainThread]: 
[0m22:44:55.011134 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m22:44:55.013328 [debug] [MainThread]: Command `dbt run` failed at 22:44:55.013328 after 4.40 seconds
[0m22:44:55.014387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000277D4882350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000277D5BC0B80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000277D67AB2E0>]}
[0m22:44:55.014387 [debug] [MainThread]: Flushing usage events
[0m22:44:55.519395 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:48:29.021475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE2A3623B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE2C289090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE2C288EB0>]}


============================== 22:48:29.026468 | 98f93485-de7e-4f21-a694-32e5c0bb046c ==============================
[0m22:48:29.026468 [info ] [MainThread]: Running with dbt=1.9.0-b1
[0m22:48:29.028477 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\User\\Desktop\\dbt-Transformations\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\User\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:48:29.234420 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m22:48:29.235428 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m22:48:29.393469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '98f93485-de7e-4f21-a694-32e5c0bb046c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE2CB51060>]}
[0m22:48:29.445276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '98f93485-de7e-4f21-a694-32e5c0bb046c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE2C9C3310>]}
[0m22:48:29.447255 [info ] [MainThread]: Registered adapter: redshift=1.8.1
[0m22:48:29.459264 [debug] [MainThread]: checksum: 342eadeaabeb3b1e51584f606df2b5b2518c39ec1d5d83f52b4bb1c68a4f38ed, vars: {}, profile: , target: , version: 1.9.0b1
[0m22:48:29.635382 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:48:29.636302 [debug] [MainThread]: Partial parsing: updated file: dbt_transformations://emekamarkt/models\staging_raw_sales_data.sql
[0m22:48:29.974302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '98f93485-de7e-4f21-a694-32e5c0bb046c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE289FECB0>]}
[0m22:48:30.049530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '98f93485-de7e-4f21-a694-32e5c0bb046c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE2CEF4FD0>]}
[0m22:48:30.050530 [info ] [MainThread]: Found 1 model, 489 macros
[0m22:48:30.051535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '98f93485-de7e-4f21-a694-32e5c0bb046c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE2CEF6770>]}
[0m22:48:30.057991 [info ] [MainThread]: 
[0m22:48:30.058992 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:48:30.060004 [info ] [MainThread]: 
[0m22:48:30.061992 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m22:48:30.063995 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev'
[0m22:48:30.082994 [debug] [ThreadPool]: Using redshift connection "list_dev"
[0m22:48:30.083995 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.9.0b1", "profile_name": "emekamarkt", "target_name": "dev", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
[0m22:48:30.086023 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:48:30.090119 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:48:30.092081 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m22:48:30.813481 [debug] [ThreadPool]: SQL status: SUCCESS in 0.727 seconds
[0m22:48:30.817468 [debug] [ThreadPool]: On list_dev: Close
[0m22:48:30.821458 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev_public'
[0m22:48:30.831554 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m22:48:30.832551 [debug] [ThreadPool]: On list_dev_public: BEGIN
[0m22:48:30.832551 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:48:30.833458 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:48:30.833458 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m22:48:31.313304 [debug] [ThreadPool]: SQL status: SUCCESS in 0.481 seconds
[0m22:48:31.315258 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m22:48:31.317262 [debug] [ThreadPool]: On list_dev_public: /* {"app": "dbt", "dbt_version": "1.9.0b1", "profile_name": "emekamarkt", "target_name": "dev", "connection_name": "list_dev_public"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'public'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'public'
[0m22:48:31.413376 [debug] [ThreadPool]: SQL status: SUCCESS in 0.095 seconds
[0m22:48:31.419480 [debug] [ThreadPool]: On list_dev_public: ROLLBACK
[0m22:48:31.506463 [debug] [ThreadPool]: On list_dev_public: Close
[0m22:48:31.517462 [debug] [MainThread]: Using redshift connection "master"
[0m22:48:31.518458 [debug] [MainThread]: On master: BEGIN
[0m22:48:31.519362 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:48:31.519362 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:48:31.520364 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m22:48:32.003108 [debug] [MainThread]: SQL status: SUCCESS in 0.484 seconds
[0m22:48:32.004135 [debug] [MainThread]: Using redshift connection "master"
[0m22:48:32.005215 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0b1", "profile_name": "emekamarkt", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m22:48:32.134912 [debug] [MainThread]: SQL status: SUCCESS in 0.128 seconds
[0m22:48:32.140029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '98f93485-de7e-4f21-a694-32e5c0bb046c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE2CEF8460>]}
[0m22:48:32.141025 [debug] [MainThread]: On master: ROLLBACK
[0m22:48:32.223610 [debug] [MainThread]: Using redshift connection "master"
[0m22:48:32.225676 [debug] [MainThread]: On master: BEGIN
[0m22:48:32.267790 [debug] [MainThread]: SQL status: SUCCESS in 0.041 seconds
[0m22:48:32.268876 [debug] [MainThread]: On master: COMMIT
[0m22:48:32.270802 [debug] [MainThread]: Using redshift connection "master"
[0m22:48:32.272017 [debug] [MainThread]: On master: COMMIT
[0m22:48:32.353645 [debug] [MainThread]: SQL status: SUCCESS in 0.080 seconds
[0m22:48:32.354645 [debug] [MainThread]: On master: Close
[0m22:48:32.363536 [debug] [Thread-1 (]: Began running node model.dbt_transformations.staging_raw_sales_data
[0m22:48:32.365640 [info ] [Thread-1 (]: 1 of 1 START sql view model public.staging_raw_sales_data ...................... [RUN]
[0m22:48:32.367540 [debug] [Thread-1 (]: Acquiring new redshift connection 'model.dbt_transformations.staging_raw_sales_data'
[0m22:48:32.368614 [debug] [Thread-1 (]: Began compiling node model.dbt_transformations.staging_raw_sales_data
[0m22:48:32.371630 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_transformations.staging_raw_sales_data"
[0m22:48:32.373586 [debug] [Thread-1 (]: Began executing node model.dbt_transformations.staging_raw_sales_data
[0m22:48:32.418162 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_transformations.staging_raw_sales_data"
[0m22:48:32.426064 [debug] [Thread-1 (]: Using redshift connection "model.dbt_transformations.staging_raw_sales_data"
[0m22:48:32.428085 [debug] [Thread-1 (]: On model.dbt_transformations.staging_raw_sales_data: BEGIN
[0m22:48:32.428085 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:48:32.429159 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:48:32.430128 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m22:48:32.899898 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.472 seconds
[0m22:48:32.902006 [debug] [Thread-1 (]: Using redshift connection "model.dbt_transformations.staging_raw_sales_data"
[0m22:48:32.903921 [debug] [Thread-1 (]: On model.dbt_transformations.staging_raw_sales_data: /* {"app": "dbt", "dbt_version": "1.9.0b1", "profile_name": "emekamarkt", "target_name": "dev", "node_id": "model.dbt_transformations.staging_raw_sales_data"} */


  create view "dev"."public"."staging_raw_sales_data__dbt_tmp" as (
    -- models/staging_raw_sales_data.sql



WITH raw_data AS (
    SELECT 
        *
    FROM 
        my_external_schema.external_table(  -- Make sure to reference the external schema here
            's3://emeka-market-raw-sales-data/raw_sales_data.csv',
            'arn:aws:iam::863518444424:role/service-role/AmazonRedshift-CommandsAccessRole-20241004T144721',
            'CSV',
            'IGNOREHEADER 1',
            'DELIMITER '',''',
            'REGION ''eu-north-1'''
        )
)

SELECT
    SaleID,
    ProductID,
    CustomerID,
    Quantity,
    Date,
    LocationID,
    PaymentID,
    ShippingID,
    PromotionID,
    ReviewID,
    JSON_EXTRACT_PATH_TEXT(Product, 'ProductID')::INT AS Product_ProductID,
    JSON_EXTRACT_PATH_TEXT(Product, 'ProductName') AS Product_ProductName,
    JSON_EXTRACT_PATH_TEXT(Product, 'Category') AS Product_Category,
    JSON_EXTRACT_PATH_TEXT(Product, 'UnitCost')::FLOAT AS Product_UnitCost,
    JSON_EXTRACT_PATH_TEXT(Product, 'UnitPrice')::FLOAT AS Product_UnitPrice,
    JSON_EXTRACT_PATH_TEXT(Customer, 'CustomerID')::INT AS Customer_CustomerID,
    JSON_EXTRACT_PATH_TEXT(Customer, 'CustomerName') AS Customer_CustomerName,
    JSON_EXTRACT_PATH_TEXT(Customer, 'Email') AS Customer_Email,
    JSON_EXTRACT_PATH_TEXT(Customer, 'PhoneNumber') AS Customer_PhoneNumber,
    JSON_EXTRACT_PATH_TEXT(Customer, 'LoyaltyStatus') AS Customer_LoyaltyStatus,
    JSON_EXTRACT_PATH_TEXT(Location, 'LocationID')::INT AS Location_LocationID,
    JSON_EXTRACT_PATH_TEXT(Location, 'Country') AS Location_Country,
    JSON_EXTRACT_PATH_TEXT(Location, 'State') AS Location_State,
    JSON_EXTRACT_PATH_TEXT(Location, 'City') AS Location_City,
    JSON_EXTRACT_PATH_TEXT(Location, 'PostalCode')::INT AS Location_PostalCode,
    JSON_EXTRACT_PATH_TEXT(Location, 'Region') AS Location_Region,
    JSON_EXTRACT_PATH_TEXT(Promotion, 'PromotionID')::INT AS Promotion_PromotionID,
    JSON_EXTRACT_PATH_TEXT(Promotion, 'PromotionName') AS Promotion_PromotionName,
    JSON_EXTRACT_PATH_TEXT(Promotion, 'DiscountRate')::FLOAT AS Promotion_DiscountRate,
    JSON_EXTRACT_PATH_TEXT(Shipping, 'ShippingID')::INT AS Shipping_ShippingID,
    JSON_EXTRACT_PATH_TEXT(Shipping, 'Method') AS Shipping_Method,
    JSON_EXTRACT_PATH_TEXT(Shipping, 'Cost')::FLOAT AS Shipping_Cost,
    JSON_EXTRACT_PATH_TEXT(Review, 'ReviewID')::INT AS Review_ReviewID,
    JSON_EXTRACT_PATH_TEXT(Review, 'ProductID')::INT AS Review_ProductID,
    JSON_EXTRACT_PATH_TEXT(Review, 'CustomerID')::INT AS Review_CustomerID,
    JSON_EXTRACT_PATH_TEXT(Review, 'Rating')::INT AS Review_Rating,
    JSON_EXTRACT_PATH_TEXT(Review, 'Comment') AS Review_Comment,
    JSON_EXTRACT_PATH_TEXT(MarketingChannel, 'ChannelID')::INT AS MarketingChannel_ChannelID,
    JSON_EXTRACT_PATH_TEXT(MarketingChannel, 'ChannelName') AS MarketingChannel_ChannelName
FROM raw_data;
  ) ;
[0m22:48:32.951335 [debug] [Thread-1 (]: Redshift adapter: Redshift error: syntax error at or near ";" in context "MarketingChannel_ChannelName
FROM raw_data;", at line 63, column 14
[0m22:48:32.954322 [debug] [Thread-1 (]: On model.dbt_transformations.staging_raw_sales_data: ROLLBACK
[0m22:48:33.031199 [debug] [Thread-1 (]: On model.dbt_transformations.staging_raw_sales_data: Close
[0m22:48:33.034231 [debug] [Thread-1 (]: Database Error in model staging_raw_sales_data (emekamarkt/models\staging_raw_sales_data.sql)
  syntax error at or near ";" in context "MarketingChannel_ChannelName
  FROM raw_data;", at line 63, column 14
  compiled code at target\run\dbt_transformations\emekamarkt/models\staging_raw_sales_data.sql
[0m22:48:33.036278 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '98f93485-de7e-4f21-a694-32e5c0bb046c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE2CA5B6A0>]}
[0m22:48:33.037202 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model public.staging_raw_sales_data ............. [[31mERROR[0m in 0.67s]
[0m22:48:33.038188 [debug] [Thread-1 (]: Finished running node model.dbt_transformations.staging_raw_sales_data
[0m22:48:33.040196 [debug] [Thread-4 (]: Marking all children of 'model.dbt_transformations.staging_raw_sales_data' to be skipped because of status 'error'.  Reason: Database Error in model staging_raw_sales_data (emekamarkt/models\staging_raw_sales_data.sql)
  syntax error at or near ";" in context "MarketingChannel_ChannelName
  FROM raw_data;", at line 63, column 14
  compiled code at target\run\dbt_transformations\emekamarkt/models\staging_raw_sales_data.sql.
[0m22:48:33.042200 [debug] [MainThread]: Using redshift connection "master"
[0m22:48:33.043209 [debug] [MainThread]: On master: BEGIN
[0m22:48:33.044195 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:48:33.045196 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:48:33.045196 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m22:48:33.501359 [debug] [MainThread]: SQL status: SUCCESS in 0.457 seconds
[0m22:48:33.501359 [debug] [MainThread]: On master: COMMIT
[0m22:48:33.502369 [debug] [MainThread]: Using redshift connection "master"
[0m22:48:33.503282 [debug] [MainThread]: On master: COMMIT
[0m22:48:33.585062 [debug] [MainThread]: SQL status: SUCCESS in 0.081 seconds
[0m22:48:33.587188 [debug] [MainThread]: On master: Close
[0m22:48:33.589083 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:48:33.590172 [debug] [MainThread]: Connection 'list_dev' was properly closed.
[0m22:48:33.592142 [debug] [MainThread]: Connection 'list_dev_public' was properly closed.
[0m22:48:33.593163 [debug] [MainThread]: Connection 'model.dbt_transformations.staging_raw_sales_data' was properly closed.
[0m22:48:33.593163 [info ] [MainThread]: 
[0m22:48:33.595180 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.53 seconds (3.53s).
[0m22:48:33.596939 [debug] [MainThread]: Command end result
[0m22:48:33.633118 [info ] [MainThread]: 
[0m22:48:33.635087 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successs, and 0 warnings:[0m
[0m22:48:33.636086 [info ] [MainThread]: 
[0m22:48:33.637121 [error] [MainThread]:   Database Error in model staging_raw_sales_data (emekamarkt/models\staging_raw_sales_data.sql)
  syntax error at or near ";" in context "MarketingChannel_ChannelName
  FROM raw_data;", at line 63, column 14
  compiled code at target\run\dbt_transformations\emekamarkt/models\staging_raw_sales_data.sql
[0m22:48:33.638108 [info ] [MainThread]: 
[0m22:48:33.639134 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m22:48:33.641222 [debug] [MainThread]: Command `dbt run` failed at 22:48:33.641222 after 4.69 seconds
[0m22:48:33.642215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE2A3623B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE2E0E85E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE2E0E9B70>]}
[0m22:48:33.643214 [debug] [MainThread]: Flushing usage events
[0m22:48:34.159931 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:50:08.289066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E35C34E380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E35E2CCB20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E35E2CC940>]}


============================== 22:50:08.295077 | c9c3d0d7-d3b7-4126-821e-62914b7b12e2 ==============================
[0m22:50:08.295077 [info ] [MainThread]: Running with dbt=1.9.0-b1
[0m22:50:08.296074 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\User\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\User\\Desktop\\dbt-Transformations\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m22:50:08.500502 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m22:50:08.500502 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m22:50:08.661541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c9c3d0d7-d3b7-4126-821e-62914b7b12e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E35EB4E4D0>]}
[0m22:50:08.713541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c9c3d0d7-d3b7-4126-821e-62914b7b12e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E35E9C32E0>]}
[0m22:50:08.715401 [info ] [MainThread]: Registered adapter: redshift=1.8.1
[0m22:50:08.726487 [debug] [MainThread]: checksum: 342eadeaabeb3b1e51584f606df2b5b2518c39ec1d5d83f52b4bb1c68a4f38ed, vars: {}, profile: , target: , version: 1.9.0b1
[0m22:50:08.920646 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:50:08.921657 [debug] [MainThread]: Partial parsing: updated file: dbt_transformations://emekamarkt/models\staging_raw_sales_data.sql
[0m22:50:09.261039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c9c3d0d7-d3b7-4126-821e-62914b7b12e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E35D688910>]}
[0m22:50:09.337048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c9c3d0d7-d3b7-4126-821e-62914b7b12e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E35EEF4520>]}
[0m22:50:09.338047 [info ] [MainThread]: Found 1 model, 489 macros
[0m22:50:09.339048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c9c3d0d7-d3b7-4126-821e-62914b7b12e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E35EEF4D30>]}
[0m22:50:09.341132 [info ] [MainThread]: 
[0m22:50:09.342136 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:50:09.344046 [info ] [MainThread]: 
[0m22:50:09.345063 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m22:50:09.347047 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev'
[0m22:50:09.364655 [debug] [ThreadPool]: Using redshift connection "list_dev"
[0m22:50:09.365650 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.9.0b1", "profile_name": "emekamarkt", "target_name": "dev", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
[0m22:50:09.366657 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:50:09.369651 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:50:09.371562 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m22:50:10.100763 [debug] [ThreadPool]: SQL status: SUCCESS in 0.735 seconds
[0m22:50:10.105874 [debug] [ThreadPool]: On list_dev: Close
[0m22:50:10.108894 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev_public'
[0m22:50:10.118877 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m22:50:10.119865 [debug] [ThreadPool]: On list_dev_public: BEGIN
[0m22:50:10.119865 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:50:10.120776 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:50:10.121776 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m22:50:10.595234 [debug] [ThreadPool]: SQL status: SUCCESS in 0.475 seconds
[0m22:50:10.596326 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m22:50:10.597270 [debug] [ThreadPool]: On list_dev_public: /* {"app": "dbt", "dbt_version": "1.9.0b1", "profile_name": "emekamarkt", "target_name": "dev", "connection_name": "list_dev_public"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'public'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'public'
[0m22:50:10.696391 [debug] [ThreadPool]: SQL status: SUCCESS in 0.098 seconds
[0m22:50:10.699387 [debug] [ThreadPool]: On list_dev_public: ROLLBACK
[0m22:50:10.778611 [debug] [ThreadPool]: On list_dev_public: Close
[0m22:50:10.793684 [debug] [MainThread]: Using redshift connection "master"
[0m22:50:10.794605 [debug] [MainThread]: On master: BEGIN
[0m22:50:10.794605 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:50:10.795667 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:50:10.795667 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m22:50:11.274958 [debug] [MainThread]: SQL status: SUCCESS in 0.480 seconds
[0m22:50:11.275959 [debug] [MainThread]: Using redshift connection "master"
[0m22:50:11.276958 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0b1", "profile_name": "emekamarkt", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m22:50:11.401774 [debug] [MainThread]: SQL status: SUCCESS in 0.124 seconds
[0m22:50:11.404776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c9c3d0d7-d3b7-4126-821e-62914b7b12e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E35EEF9FC0>]}
[0m22:50:11.405866 [debug] [MainThread]: On master: ROLLBACK
[0m22:50:11.484532 [debug] [MainThread]: Using redshift connection "master"
[0m22:50:11.484532 [debug] [MainThread]: On master: BEGIN
[0m22:50:11.531524 [debug] [MainThread]: SQL status: SUCCESS in 0.046 seconds
[0m22:50:11.532530 [debug] [MainThread]: On master: COMMIT
[0m22:50:11.533527 [debug] [MainThread]: Using redshift connection "master"
[0m22:50:11.534528 [debug] [MainThread]: On master: COMMIT
[0m22:50:11.616160 [debug] [MainThread]: SQL status: SUCCESS in 0.081 seconds
[0m22:50:11.618177 [debug] [MainThread]: On master: Close
[0m22:50:11.622162 [debug] [Thread-1 (]: Began running node model.dbt_transformations.staging_raw_sales_data
[0m22:50:11.623173 [info ] [Thread-1 (]: 1 of 1 START sql view model public.staging_raw_sales_data ...................... [RUN]
[0m22:50:11.625157 [debug] [Thread-1 (]: Acquiring new redshift connection 'model.dbt_transformations.staging_raw_sales_data'
[0m22:50:11.625157 [debug] [Thread-1 (]: Began compiling node model.dbt_transformations.staging_raw_sales_data
[0m22:50:11.629159 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_transformations.staging_raw_sales_data"
[0m22:50:11.631169 [debug] [Thread-1 (]: Began executing node model.dbt_transformations.staging_raw_sales_data
[0m22:50:11.674555 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_transformations.staging_raw_sales_data"
[0m22:50:11.683558 [debug] [Thread-1 (]: Using redshift connection "model.dbt_transformations.staging_raw_sales_data"
[0m22:50:11.684653 [debug] [Thread-1 (]: On model.dbt_transformations.staging_raw_sales_data: BEGIN
[0m22:50:11.685555 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:50:11.686555 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:50:11.686555 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m22:50:12.157111 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.472 seconds
[0m22:50:12.158099 [debug] [Thread-1 (]: Using redshift connection "model.dbt_transformations.staging_raw_sales_data"
[0m22:50:12.159098 [debug] [Thread-1 (]: On model.dbt_transformations.staging_raw_sales_data: /* {"app": "dbt", "dbt_version": "1.9.0b1", "profile_name": "emekamarkt", "target_name": "dev", "node_id": "model.dbt_transformations.staging_raw_sales_data"} */


  create view "dev"."public"."staging_raw_sales_data__dbt_tmp" as (
    -- models/staging_raw_sales_data.sql



WITH raw_data AS (
    SELECT 
        *
    FROM 
        my_external_schema.external_table(  -- Make sure to reference the external schema here
            's3://emeka-market-raw-sales-data/raw_sales_data.csv',
            'arn:aws:iam::863518444424:role/service-role/AmazonRedshift-CommandsAccessRole-20241004T144721',
            'CSV',
            'IGNOREHEADER 1',
            'DELIMITER '',''',
            'REGION ''eu-north-1'''
        )
)

SELECT
    SaleID,
    ProductID,
    CustomerID,
    Quantity,
    Date,
    LocationID,
    PaymentID,
    ShippingID,
    PromotionID,
    ReviewID,
    JSON_EXTRACT_PATH_TEXT(Product, 'ProductID')::INT AS Product_ProductID,
    JSON_EXTRACT_PATH_TEXT(Product, 'ProductName') AS Product_ProductName,
    JSON_EXTRACT_PATH_TEXT(Product, 'Category') AS Product_Category,
    JSON_EXTRACT_PATH_TEXT(Product, 'UnitCost')::FLOAT AS Product_UnitCost,
    JSON_EXTRACT_PATH_TEXT(Product, 'UnitPrice')::FLOAT AS Product_UnitPrice,
    JSON_EXTRACT_PATH_TEXT(Customer, 'CustomerID')::INT AS Customer_CustomerID,
    JSON_EXTRACT_PATH_TEXT(Customer, 'CustomerName') AS Customer_CustomerName,
    JSON_EXTRACT_PATH_TEXT(Customer, 'Email') AS Customer_Email,
    JSON_EXTRACT_PATH_TEXT(Customer, 'PhoneNumber') AS Customer_PhoneNumber,
    JSON_EXTRACT_PATH_TEXT(Customer, 'LoyaltyStatus') AS Customer_LoyaltyStatus,
    JSON_EXTRACT_PATH_TEXT(Location, 'LocationID')::INT AS Location_LocationID,
    JSON_EXTRACT_PATH_TEXT(Location, 'Country') AS Location_Country,
    JSON_EXTRACT_PATH_TEXT(Location, 'State') AS Location_State,
    JSON_EXTRACT_PATH_TEXT(Location, 'City') AS Location_City,
    JSON_EXTRACT_PATH_TEXT(Location, 'PostalCode')::INT AS Location_PostalCode,
    JSON_EXTRACT_PATH_TEXT(Location, 'Region') AS Location_Region,
    JSON_EXTRACT_PATH_TEXT(Promotion, 'PromotionID')::INT AS Promotion_PromotionID,
    JSON_EXTRACT_PATH_TEXT(Promotion, 'PromotionName') AS Promotion_PromotionName,
    JSON_EXTRACT_PATH_TEXT(Promotion, 'DiscountRate')::FLOAT AS Promotion_DiscountRate,
    JSON_EXTRACT_PATH_TEXT(Shipping, 'ShippingID')::INT AS Shipping_ShippingID,
    JSON_EXTRACT_PATH_TEXT(Shipping, 'Method') AS Shipping_Method,
    JSON_EXTRACT_PATH_TEXT(Shipping, 'Cost')::FLOAT AS Shipping_Cost,
    JSON_EXTRACT_PATH_TEXT(Review, 'ReviewID')::INT AS Review_ReviewID,
    JSON_EXTRACT_PATH_TEXT(Review, 'ProductID')::INT AS Review_ProductID,
    JSON_EXTRACT_PATH_TEXT(Review, 'CustomerID')::INT AS Review_CustomerID,
    JSON_EXTRACT_PATH_TEXT(Review, 'Rating')::INT AS Review_Rating,
    JSON_EXTRACT_PATH_TEXT(Review, 'Comment') AS Review_Comment,
    JSON_EXTRACT_PATH_TEXT(MarketingChannel, 'ChannelID')::INT AS MarketingChannel_ChannelID,
    JSON_EXTRACT_PATH_TEXT(MarketingChannel, 'ChannelName') AS MarketingChannel_ChannelName
FROM raw_data;  -- Ensure there's a semicolon here to close the statement
  ) ;
[0m22:50:12.198203 [debug] [Thread-1 (]: Redshift adapter: Redshift error: syntax error at or near ";" in context "MarketingChannel_ChannelName
FROM raw_data;", at line 63, column 14
[0m22:50:12.199252 [debug] [Thread-1 (]: On model.dbt_transformations.staging_raw_sales_data: ROLLBACK
[0m22:50:12.284810 [debug] [Thread-1 (]: On model.dbt_transformations.staging_raw_sales_data: Close
[0m22:50:12.289807 [debug] [Thread-1 (]: Database Error in model staging_raw_sales_data (emekamarkt/models\staging_raw_sales_data.sql)
  syntax error at or near ";" in context "MarketingChannel_ChannelName
  FROM raw_data;", at line 63, column 14
  compiled code at target\run\dbt_transformations\emekamarkt/models\staging_raw_sales_data.sql
[0m22:50:12.291808 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c9c3d0d7-d3b7-4126-821e-62914b7b12e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E35EA576A0>]}
[0m22:50:12.293808 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model public.staging_raw_sales_data ............. [[31mERROR[0m in 0.67s]
[0m22:50:12.294810 [debug] [Thread-1 (]: Finished running node model.dbt_transformations.staging_raw_sales_data
[0m22:50:12.296314 [debug] [Thread-4 (]: Marking all children of 'model.dbt_transformations.staging_raw_sales_data' to be skipped because of status 'error'.  Reason: Database Error in model staging_raw_sales_data (emekamarkt/models\staging_raw_sales_data.sql)
  syntax error at or near ";" in context "MarketingChannel_ChannelName
  FROM raw_data;", at line 63, column 14
  compiled code at target\run\dbt_transformations\emekamarkt/models\staging_raw_sales_data.sql.
[0m22:50:12.299323 [debug] [MainThread]: Using redshift connection "master"
[0m22:50:12.300329 [debug] [MainThread]: On master: BEGIN
[0m22:50:12.301399 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:50:12.302418 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:50:12.302418 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m22:50:12.772065 [debug] [MainThread]: SQL status: SUCCESS in 0.471 seconds
[0m22:50:12.774173 [debug] [MainThread]: On master: COMMIT
[0m22:50:12.776141 [debug] [MainThread]: Using redshift connection "master"
[0m22:50:12.777151 [debug] [MainThread]: On master: COMMIT
[0m22:50:12.858256 [debug] [MainThread]: SQL status: SUCCESS in 0.080 seconds
[0m22:50:12.860276 [debug] [MainThread]: On master: Close
[0m22:50:12.863293 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:50:12.864385 [debug] [MainThread]: Connection 'list_dev' was properly closed.
[0m22:50:12.865370 [debug] [MainThread]: Connection 'list_dev_public' was properly closed.
[0m22:50:12.866279 [debug] [MainThread]: Connection 'model.dbt_transformations.staging_raw_sales_data' was properly closed.
[0m22:50:12.867366 [info ] [MainThread]: 
[0m22:50:12.869304 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.52 seconds (3.52s).
[0m22:50:12.871270 [debug] [MainThread]: Command end result
[0m22:50:12.908866 [info ] [MainThread]: 
[0m22:50:12.910867 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successs, and 0 warnings:[0m
[0m22:50:12.911870 [info ] [MainThread]: 
[0m22:50:12.913005 [error] [MainThread]:   Database Error in model staging_raw_sales_data (emekamarkt/models\staging_raw_sales_data.sql)
  syntax error at or near ";" in context "MarketingChannel_ChannelName
  FROM raw_data;", at line 63, column 14
  compiled code at target\run\dbt_transformations\emekamarkt/models\staging_raw_sales_data.sql
[0m22:50:12.915016 [info ] [MainThread]: 
[0m22:50:12.916053 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m22:50:12.918014 [debug] [MainThread]: Command `dbt run` failed at 22:50:12.918014 after 4.72 seconds
[0m22:50:12.918014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E35C34E380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E35D697190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3600C3820>]}
[0m22:50:12.919028 [debug] [MainThread]: Flushing usage events
[0m22:50:13.413607 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:52:02.781171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEAE70E350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEB068CB50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEB068C970>]}


============================== 22:52:02.785178 | 1f734de5-b8e8-4421-a9b7-61e1eb30fbf2 ==============================
[0m22:52:02.785178 [info ] [MainThread]: Running with dbt=1.9.0-b1
[0m22:52:02.787079 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\User\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\User\\Desktop\\dbt-Transformations\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:52:02.974463 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m22:52:02.975462 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m22:52:03.182448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1f734de5-b8e8-4421-a9b7-61e1eb30fbf2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEB0DCD150>]}
[0m22:52:03.236827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1f734de5-b8e8-4421-a9b7-61e1eb30fbf2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEB0D732B0>]}
[0m22:52:03.238734 [info ] [MainThread]: Registered adapter: redshift=1.8.1
[0m22:52:03.250398 [debug] [MainThread]: checksum: 342eadeaabeb3b1e51584f606df2b5b2518c39ec1d5d83f52b4bb1c68a4f38ed, vars: {}, profile: , target: , version: 1.9.0b1
[0m22:52:03.429052 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:52:03.430060 [debug] [MainThread]: Partial parsing: updated file: dbt_transformations://emekamarkt/models\staging_raw_sales_data.sql
[0m22:52:03.769372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1f734de5-b8e8-4421-a9b7-61e1eb30fbf2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEB12F97E0>]}
[0m22:52:03.844151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1f734de5-b8e8-4421-a9b7-61e1eb30fbf2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEB1271780>]}
[0m22:52:03.845195 [info ] [MainThread]: Found 1 model, 489 macros
[0m22:52:03.846196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1f734de5-b8e8-4421-a9b7-61e1eb30fbf2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEB1271630>]}
[0m22:52:03.848242 [info ] [MainThread]: 
[0m22:52:03.850248 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:52:03.851246 [info ] [MainThread]: 
[0m22:52:03.852825 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m22:52:03.854824 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev'
[0m22:52:03.873917 [debug] [ThreadPool]: Using redshift connection "list_dev"
[0m22:52:03.874921 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.9.0b1", "profile_name": "emekamarkt", "target_name": "dev", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
[0m22:52:03.875857 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:52:03.878915 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:52:03.880832 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m22:52:04.625238 [debug] [ThreadPool]: SQL status: SUCCESS in 0.750 seconds
[0m22:52:04.630163 [debug] [ThreadPool]: On list_dev: Close
[0m22:52:04.632151 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev_public'
[0m22:52:04.641239 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m22:52:04.641239 [debug] [ThreadPool]: On list_dev_public: BEGIN
[0m22:52:04.642232 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:52:04.642232 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:52:04.643242 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m22:52:05.117425 [debug] [ThreadPool]: SQL status: SUCCESS in 0.476 seconds
[0m22:52:05.119537 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m22:52:05.121534 [debug] [ThreadPool]: On list_dev_public: /* {"app": "dbt", "dbt_version": "1.9.0b1", "profile_name": "emekamarkt", "target_name": "dev", "connection_name": "list_dev_public"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'public'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'public'
[0m22:52:05.217071 [debug] [ThreadPool]: SQL status: SUCCESS in 0.095 seconds
[0m22:52:05.221181 [debug] [ThreadPool]: On list_dev_public: ROLLBACK
[0m22:52:05.302509 [debug] [ThreadPool]: On list_dev_public: Close
[0m22:52:05.316425 [debug] [MainThread]: Using redshift connection "master"
[0m22:52:05.316425 [debug] [MainThread]: On master: BEGIN
[0m22:52:05.317429 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:52:05.318444 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:52:05.318444 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m22:52:05.796533 [debug] [MainThread]: SQL status: SUCCESS in 0.479 seconds
[0m22:52:05.798649 [debug] [MainThread]: Using redshift connection "master"
[0m22:52:05.799639 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0b1", "profile_name": "emekamarkt", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m22:52:05.931642 [debug] [MainThread]: SQL status: SUCCESS in 0.131 seconds
[0m22:52:05.937607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1f734de5-b8e8-4421-a9b7-61e1eb30fbf2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEB12A3DC0>]}
[0m22:52:05.938605 [debug] [MainThread]: On master: ROLLBACK
[0m22:52:06.019672 [debug] [MainThread]: Using redshift connection "master"
[0m22:52:06.020672 [debug] [MainThread]: On master: BEGIN
[0m22:52:06.060293 [debug] [MainThread]: SQL status: SUCCESS in 0.040 seconds
[0m22:52:06.061281 [debug] [MainThread]: On master: COMMIT
[0m22:52:06.062197 [debug] [MainThread]: Using redshift connection "master"
[0m22:52:06.062197 [debug] [MainThread]: On master: COMMIT
[0m22:52:06.138410 [debug] [MainThread]: SQL status: SUCCESS in 0.076 seconds
[0m22:52:06.139346 [debug] [MainThread]: On master: Close
[0m22:52:06.144784 [debug] [Thread-1 (]: Began running node model.dbt_transformations.staging_raw_sales_data
[0m22:52:06.145819 [info ] [Thread-1 (]: 1 of 1 START sql view model public.staging_raw_sales_data ...................... [RUN]
[0m22:52:06.147810 [debug] [Thread-1 (]: Acquiring new redshift connection 'model.dbt_transformations.staging_raw_sales_data'
[0m22:52:06.148859 [debug] [Thread-1 (]: Began compiling node model.dbt_transformations.staging_raw_sales_data
[0m22:52:06.152901 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_transformations.staging_raw_sales_data"
[0m22:52:06.153901 [debug] [Thread-1 (]: Began executing node model.dbt_transformations.staging_raw_sales_data
[0m22:52:06.194851 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_transformations.staging_raw_sales_data"
[0m22:52:06.202900 [debug] [Thread-1 (]: Using redshift connection "model.dbt_transformations.staging_raw_sales_data"
[0m22:52:06.203928 [debug] [Thread-1 (]: On model.dbt_transformations.staging_raw_sales_data: BEGIN
[0m22:52:06.203928 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:52:06.204905 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:52:06.205846 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m22:52:06.683770 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.480 seconds
[0m22:52:06.685876 [debug] [Thread-1 (]: Using redshift connection "model.dbt_transformations.staging_raw_sales_data"
[0m22:52:06.687885 [debug] [Thread-1 (]: On model.dbt_transformations.staging_raw_sales_data: /* {"app": "dbt", "dbt_version": "1.9.0b1", "profile_name": "emekamarkt", "target_name": "dev", "node_id": "model.dbt_transformations.staging_raw_sales_data"} */


  create view "dev"."public"."staging_raw_sales_data__dbt_tmp" as (
    -- models/staging_raw_sales_data.sql



WITH raw_data AS (
    SELECT 
        *
    FROM 
        my_external_schema.external_table(  -- Make sure to reference the external schema here
            's3://emeka-market-raw-sales-data/raw_sales_data.csv',
            'arn:aws:iam::863518444424:role/service-role/AmazonRedshift-CommandsAccessRole-20241004T144721',
            'CSV',
            'IGNOREHEADER 1',
            'DELIMITER '',''',
            'REGION ''eu-north-1'''
        )
)

SELECT
    SaleID,
    ProductID,
    CustomerID,
    Quantity,
    Date,
    LocationID,
    PaymentID,
    ShippingID,
    PromotionID,
    ReviewID,
    JSON_EXTRACT_PATH_TEXT(Product, 'ProductID')::INT AS Product_ProductID,
    JSON_EXTRACT_PATH_TEXT(Product, 'ProductName') AS Product_ProductName,
    JSON_EXTRACT_PATH_TEXT(Product, 'Category') AS Product_Category,
    JSON_EXTRACT_PATH_TEXT(Product, 'UnitCost')::FLOAT AS Product_UnitCost,
    JSON_EXTRACT_PATH_TEXT(Product, 'UnitPrice')::FLOAT AS Product_UnitPrice,
    JSON_EXTRACT_PATH_TEXT(Customer, 'CustomerID')::INT AS Customer_CustomerID,
    JSON_EXTRACT_PATH_TEXT(Customer, 'CustomerName') AS Customer_CustomerName,
    JSON_EXTRACT_PATH_TEXT(Customer, 'Email') AS Customer_Email,
    JSON_EXTRACT_PATH_TEXT(Customer, 'PhoneNumber') AS Customer_PhoneNumber,
    JSON_EXTRACT_PATH_TEXT(Customer, 'LoyaltyStatus') AS Customer_LoyaltyStatus,
    JSON_EXTRACT_PATH_TEXT(Location, 'LocationID')::INT AS Location_LocationID,
    JSON_EXTRACT_PATH_TEXT(Location, 'Country') AS Location_Country,
    JSON_EXTRACT_PATH_TEXT(Location, 'State') AS Location_State,
    JSON_EXTRACT_PATH_TEXT(Location, 'City') AS Location_City,
    JSON_EXTRACT_PATH_TEXT(Location, 'PostalCode')::INT AS Location_PostalCode,
    JSON_EXTRACT_PATH_TEXT(Location, 'Region') AS Location_Region,
    JSON_EXTRACT_PATH_TEXT(Promotion, 'PromotionID')::INT AS Promotion_PromotionID,
    JSON_EXTRACT_PATH_TEXT(Promotion, 'PromotionName') AS Promotion_PromotionName,
    JSON_EXTRACT_PATH_TEXT(Promotion, 'DiscountRate')::FLOAT AS Promotion_DiscountRate,
    JSON_EXTRACT_PATH_TEXT(Shipping, 'ShippingID')::INT AS Shipping_ShippingID,
    JSON_EXTRACT_PATH_TEXT(Shipping, 'Method') AS Shipping_Method,
    JSON_EXTRACT_PATH_TEXT(Shipping, 'Cost')::FLOAT AS Shipping_Cost,
    JSON_EXTRACT_PATH_TEXT(Review, 'ReviewID')::INT AS Review_ReviewID,
    JSON_EXTRACT_PATH_TEXT(Review, 'ProductID')::INT AS Review_ProductID,
    JSON_EXTRACT_PATH_TEXT(Review, 'CustomerID')::INT AS Review_CustomerID,
    JSON_EXTRACT_PATH_TEXT(Review, 'Rating')::INT AS Review_Rating,
    JSON_EXTRACT_PATH_TEXT(Review, 'Comment') AS Review_Comment

FROM raw_data;  -- Ensure there's a semicolon here to close the statement
  ) ;
[0m22:52:06.729741 [debug] [Thread-1 (]: Redshift adapter: Redshift error: syntax error at or near ";" in context "Review_Comment

FROM raw_data;", at line 62, column 14
[0m22:52:06.731733 [debug] [Thread-1 (]: On model.dbt_transformations.staging_raw_sales_data: ROLLBACK
[0m22:52:06.810374 [debug] [Thread-1 (]: On model.dbt_transformations.staging_raw_sales_data: Close
[0m22:52:06.815390 [debug] [Thread-1 (]: Database Error in model staging_raw_sales_data (emekamarkt/models\staging_raw_sales_data.sql)
  syntax error at or near ";" in context "Review_Comment
  
  FROM raw_data;", at line 62, column 14
  compiled code at target\run\dbt_transformations\emekamarkt/models\staging_raw_sales_data.sql
[0m22:52:06.818386 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f734de5-b8e8-4421-a9b7-61e1eb30fbf2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEACE2F040>]}
[0m22:52:06.819386 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model public.staging_raw_sales_data ............. [[31mERROR[0m in 0.67s]
[0m22:52:06.820106 [debug] [Thread-1 (]: Finished running node model.dbt_transformations.staging_raw_sales_data
[0m22:52:06.821204 [debug] [Thread-4 (]: Marking all children of 'model.dbt_transformations.staging_raw_sales_data' to be skipped because of status 'error'.  Reason: Database Error in model staging_raw_sales_data (emekamarkt/models\staging_raw_sales_data.sql)
  syntax error at or near ";" in context "Review_Comment
  
  FROM raw_data;", at line 62, column 14
  compiled code at target\run\dbt_transformations\emekamarkt/models\staging_raw_sales_data.sql.
[0m22:52:06.823080 [debug] [MainThread]: Using redshift connection "master"
[0m22:52:06.824183 [debug] [MainThread]: On master: BEGIN
[0m22:52:06.824183 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:52:06.825692 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:52:06.825692 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m22:52:07.313051 [debug] [MainThread]: SQL status: SUCCESS in 0.488 seconds
[0m22:52:07.314135 [debug] [MainThread]: On master: COMMIT
[0m22:52:07.316133 [debug] [MainThread]: Using redshift connection "master"
[0m22:52:07.318129 [debug] [MainThread]: On master: COMMIT
[0m22:52:07.397034 [debug] [MainThread]: SQL status: SUCCESS in 0.078 seconds
[0m22:52:07.399146 [debug] [MainThread]: On master: Close
[0m22:52:07.401058 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:52:07.403153 [debug] [MainThread]: Connection 'list_dev' was properly closed.
[0m22:52:07.404140 [debug] [MainThread]: Connection 'list_dev_public' was properly closed.
[0m22:52:07.405076 [debug] [MainThread]: Connection 'model.dbt_transformations.staging_raw_sales_data' was properly closed.
[0m22:52:07.407094 [info ] [MainThread]: 
[0m22:52:07.408071 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.55 seconds (3.55s).
[0m22:52:07.410474 [debug] [MainThread]: Command end result
[0m22:52:07.443984 [info ] [MainThread]: 
[0m22:52:07.444984 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successs, and 0 warnings:[0m
[0m22:52:07.446369 [info ] [MainThread]: 
[0m22:52:07.447266 [error] [MainThread]:   Database Error in model staging_raw_sales_data (emekamarkt/models\staging_raw_sales_data.sql)
  syntax error at or near ";" in context "Review_Comment
  
  FROM raw_data;", at line 62, column 14
  compiled code at target\run\dbt_transformations\emekamarkt/models\staging_raw_sales_data.sql
[0m22:52:07.449274 [info ] [MainThread]: 
[0m22:52:07.453285 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m22:52:07.455275 [debug] [MainThread]: Command `dbt run` failed at 22:52:07.455275 after 4.75 seconds
[0m22:52:07.456285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEAE70E350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEB1011480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEB1012800>]}
[0m22:52:07.456285 [debug] [MainThread]: Flushing usage events
[0m22:52:07.945520 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:52:49.560403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002083C5BE410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002083E4ED180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002083E4ECFA0>]}


============================== 22:52:49.565403 | 546515fd-023a-4119-aab9-07559120b7f7 ==============================
[0m22:52:49.565403 [info ] [MainThread]: Running with dbt=1.9.0-b1
[0m22:52:49.566403 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\User\\.dbt', 'log_path': 'C:\\Users\\User\\Desktop\\dbt-Transformations\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:52:49.734007 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m22:52:49.734976 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m22:52:49.895224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '546515fd-023a-4119-aab9-07559120b7f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002083B66EBC0>]}
[0m22:52:49.949833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '546515fd-023a-4119-aab9-07559120b7f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002083EC23370>]}
[0m22:52:49.951772 [info ] [MainThread]: Registered adapter: redshift=1.8.1
[0m22:52:49.964838 [debug] [MainThread]: checksum: 342eadeaabeb3b1e51584f606df2b5b2518c39ec1d5d83f52b4bb1c68a4f38ed, vars: {}, profile: , target: , version: 1.9.0b1
[0m22:52:50.162378 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:52:50.163379 [debug] [MainThread]: Partial parsing: updated file: dbt_transformations://emekamarkt/models\staging_raw_sales_data.sql
[0m22:52:50.488301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '546515fd-023a-4119-aab9-07559120b7f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002083E46BF40>]}
[0m22:52:50.562416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '546515fd-023a-4119-aab9-07559120b7f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002083F1551B0>]}
[0m22:52:50.562416 [info ] [MainThread]: Found 1 model, 489 macros
[0m22:52:50.564417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '546515fd-023a-4119-aab9-07559120b7f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002083F155120>]}
[0m22:52:50.566422 [info ] [MainThread]: 
[0m22:52:50.567422 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:52:50.568465 [info ] [MainThread]: 
[0m22:52:50.569539 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m22:52:50.571029 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev'
[0m22:52:50.588134 [debug] [ThreadPool]: Using redshift connection "list_dev"
[0m22:52:50.588134 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.9.0b1", "profile_name": "emekamarkt", "target_name": "dev", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
[0m22:52:50.589136 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:52:50.593130 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:52:50.594143 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m22:52:51.293638 [debug] [ThreadPool]: SQL status: SUCCESS in 0.705 seconds
[0m22:52:51.298149 [debug] [ThreadPool]: On list_dev: Close
[0m22:52:51.301161 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev_public'
[0m22:52:51.309173 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m22:52:51.310172 [debug] [ThreadPool]: On list_dev_public: BEGIN
[0m22:52:51.311159 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:52:51.311159 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:52:51.312261 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m22:52:51.777907 [debug] [ThreadPool]: SQL status: SUCCESS in 0.467 seconds
[0m22:52:51.780024 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m22:52:51.782017 [debug] [ThreadPool]: On list_dev_public: /* {"app": "dbt", "dbt_version": "1.9.0b1", "profile_name": "emekamarkt", "target_name": "dev", "connection_name": "list_dev_public"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'public'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'public'
[0m22:52:51.878975 [debug] [ThreadPool]: SQL status: SUCCESS in 0.095 seconds
[0m22:52:51.882889 [debug] [ThreadPool]: On list_dev_public: ROLLBACK
[0m22:52:51.955731 [debug] [ThreadPool]: On list_dev_public: Close
[0m22:52:51.971836 [debug] [MainThread]: Using redshift connection "master"
[0m22:52:51.972848 [debug] [MainThread]: On master: BEGIN
[0m22:52:51.973746 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:52:51.973746 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:52:51.974745 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m22:52:52.455599 [debug] [MainThread]: SQL status: SUCCESS in 0.482 seconds
[0m22:52:52.457724 [debug] [MainThread]: Using redshift connection "master"
[0m22:52:52.458708 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0b1", "profile_name": "emekamarkt", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m22:52:52.589197 [debug] [MainThread]: SQL status: SUCCESS in 0.129 seconds
[0m22:52:52.594191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '546515fd-023a-4119-aab9-07559120b7f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002083F050B20>]}
[0m22:52:52.595187 [debug] [MainThread]: On master: ROLLBACK
[0m22:52:52.674162 [debug] [MainThread]: Using redshift connection "master"
[0m22:52:52.676190 [debug] [MainThread]: On master: BEGIN
[0m22:52:52.714617 [debug] [MainThread]: SQL status: SUCCESS in 0.037 seconds
[0m22:52:52.716738 [debug] [MainThread]: On master: COMMIT
[0m22:52:52.718654 [debug] [MainThread]: Using redshift connection "master"
[0m22:52:52.719704 [debug] [MainThread]: On master: COMMIT
[0m22:52:52.798986 [debug] [MainThread]: SQL status: SUCCESS in 0.077 seconds
[0m22:52:52.800015 [debug] [MainThread]: On master: Close
[0m22:52:52.809019 [debug] [Thread-1 (]: Began running node model.dbt_transformations.staging_raw_sales_data
[0m22:52:52.810054 [info ] [Thread-1 (]: 1 of 1 START sql view model public.staging_raw_sales_data ...................... [RUN]
[0m22:52:52.811981 [debug] [Thread-1 (]: Acquiring new redshift connection 'model.dbt_transformations.staging_raw_sales_data'
[0m22:52:52.812970 [debug] [Thread-1 (]: Began compiling node model.dbt_transformations.staging_raw_sales_data
[0m22:52:52.818965 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_transformations.staging_raw_sales_data"
[0m22:52:52.820970 [debug] [Thread-1 (]: Began executing node model.dbt_transformations.staging_raw_sales_data
[0m22:52:52.861971 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_transformations.staging_raw_sales_data"
[0m22:52:52.868971 [debug] [Thread-1 (]: Using redshift connection "model.dbt_transformations.staging_raw_sales_data"
[0m22:52:52.869982 [debug] [Thread-1 (]: On model.dbt_transformations.staging_raw_sales_data: BEGIN
[0m22:52:52.870977 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:52:52.871973 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:52:52.871973 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m22:52:53.338179 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.467 seconds
[0m22:52:53.340192 [debug] [Thread-1 (]: Using redshift connection "model.dbt_transformations.staging_raw_sales_data"
[0m22:52:53.342197 [debug] [Thread-1 (]: On model.dbt_transformations.staging_raw_sales_data: /* {"app": "dbt", "dbt_version": "1.9.0b1", "profile_name": "emekamarkt", "target_name": "dev", "node_id": "model.dbt_transformations.staging_raw_sales_data"} */


  create view "dev"."public"."staging_raw_sales_data__dbt_tmp" as (
    -- models/staging_raw_sales_data.sql



WITH raw_data AS (
    SELECT 
        *
    FROM 
        my_external_schema.external_table(  -- Make sure to reference the external schema here
            's3://emeka-market-raw-sales-data/raw_sales_data.csv',
            'arn:aws:iam::863518444424:role/service-role/AmazonRedshift-CommandsAccessRole-20241004T144721',
            'CSV',
            'IGNOREHEADER 1',
            'DELIMITER '',''',
            'REGION ''eu-north-1'''
        )
)

SELECT
    SaleID,
    ProductID,
    CustomerID,
    Quantity,
    Date,
    LocationID,
    PaymentID,
    ShippingID,
    PromotionID,
    ReviewID,
    JSON_EXTRACT_PATH_TEXT(Product, 'ProductID')::INT AS Product_ProductID,
    JSON_EXTRACT_PATH_TEXT(Product, 'ProductName') AS Product_ProductName,
    JSON_EXTRACT_PATH_TEXT(Product, 'Category') AS Product_Category,
    JSON_EXTRACT_PATH_TEXT(Product, 'UnitCost')::FLOAT AS Product_UnitCost,
    JSON_EXTRACT_PATH_TEXT(Product, 'UnitPrice')::FLOAT AS Product_UnitPrice,
    JSON_EXTRACT_PATH_TEXT(Customer, 'CustomerID')::INT AS Customer_CustomerID,
    JSON_EXTRACT_PATH_TEXT(Customer, 'CustomerName') AS Customer_CustomerName,
    JSON_EXTRACT_PATH_TEXT(Customer, 'Email') AS Customer_Email,
    JSON_EXTRACT_PATH_TEXT(Customer, 'PhoneNumber') AS Customer_PhoneNumber,
    JSON_EXTRACT_PATH_TEXT(Customer, 'LoyaltyStatus') AS Customer_LoyaltyStatus,
    JSON_EXTRACT_PATH_TEXT(Location, 'LocationID')::INT AS Location_LocationID,
    JSON_EXTRACT_PATH_TEXT(Location, 'Country') AS Location_Country,
    JSON_EXTRACT_PATH_TEXT(Location, 'State') AS Location_State,
    JSON_EXTRACT_PATH_TEXT(Location, 'City') AS Location_City,
    JSON_EXTRACT_PATH_TEXT(Location, 'PostalCode')::INT AS Location_PostalCode,
    JSON_EXTRACT_PATH_TEXT(Location, 'Region') AS Location_Region,
    JSON_EXTRACT_PATH_TEXT(Promotion, 'PromotionID')::INT AS Promotion_PromotionID,
    JSON_EXTRACT_PATH_TEXT(Promotion, 'PromotionName') AS Promotion_PromotionName,
    JSON_EXTRACT_PATH_TEXT(Promotion, 'DiscountRate')::FLOAT AS Promotion_DiscountRate,
    JSON_EXTRACT_PATH_TEXT(Shipping, 'ShippingID')::INT AS Shipping_ShippingID,
    JSON_EXTRACT_PATH_TEXT(Shipping, 'Method') AS Shipping_Method,
    JSON_EXTRACT_PATH_TEXT(Shipping, 'Cost')::FLOAT AS Shipping_Cost,
FROM raw_data;  -- Ensure there's a semicolon here to close the statement
  ) ;
[0m22:52:53.380867 [debug] [Thread-1 (]: Redshift adapter: Redshift error: syntax error at or near "FROM" in context "AS Shipping_Cost,
FROM", at line 56, column 1
[0m22:52:53.382981 [debug] [Thread-1 (]: On model.dbt_transformations.staging_raw_sales_data: ROLLBACK
[0m22:52:53.461248 [debug] [Thread-1 (]: On model.dbt_transformations.staging_raw_sales_data: Close
[0m22:52:53.465203 [debug] [Thread-1 (]: Database Error in model staging_raw_sales_data (emekamarkt/models\staging_raw_sales_data.sql)
  syntax error at or near "FROM" in context "AS Shipping_Cost,
  FROM", at line 56, column 1
  compiled code at target\run\dbt_transformations\emekamarkt/models\staging_raw_sales_data.sql
[0m22:52:53.467197 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '546515fd-023a-4119-aab9-07559120b7f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002083ECAB6A0>]}
[0m22:52:53.468228 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model public.staging_raw_sales_data ............. [[31mERROR[0m in 0.66s]
[0m22:52:53.470121 [debug] [Thread-1 (]: Finished running node model.dbt_transformations.staging_raw_sales_data
[0m22:52:53.471115 [debug] [Thread-4 (]: Marking all children of 'model.dbt_transformations.staging_raw_sales_data' to be skipped because of status 'error'.  Reason: Database Error in model staging_raw_sales_data (emekamarkt/models\staging_raw_sales_data.sql)
  syntax error at or near "FROM" in context "AS Shipping_Cost,
  FROM", at line 56, column 1
  compiled code at target\run\dbt_transformations\emekamarkt/models\staging_raw_sales_data.sql.
[0m22:52:53.473206 [debug] [MainThread]: Using redshift connection "master"
[0m22:52:53.474198 [debug] [MainThread]: On master: BEGIN
[0m22:52:53.475116 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:52:53.475116 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:52:53.477118 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m22:52:53.939500 [debug] [MainThread]: SQL status: SUCCESS in 0.465 seconds
[0m22:52:53.941615 [debug] [MainThread]: On master: COMMIT
[0m22:52:53.943523 [debug] [MainThread]: Using redshift connection "master"
[0m22:52:53.944581 [debug] [MainThread]: On master: COMMIT
[0m22:52:54.020881 [debug] [MainThread]: SQL status: SUCCESS in 0.076 seconds
[0m22:52:54.021806 [debug] [MainThread]: On master: Close
[0m22:52:54.022829 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:52:54.023809 [debug] [MainThread]: Connection 'list_dev' was properly closed.
[0m22:52:54.023809 [debug] [MainThread]: Connection 'list_dev_public' was properly closed.
[0m22:52:54.024721 [debug] [MainThread]: Connection 'model.dbt_transformations.staging_raw_sales_data' was properly closed.
[0m22:52:54.024721 [info ] [MainThread]: 
[0m22:52:54.025988 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.46 seconds (3.46s).
[0m22:52:54.026996 [debug] [MainThread]: Command end result
[0m22:52:54.061997 [info ] [MainThread]: 
[0m22:52:54.062991 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successs, and 0 warnings:[0m
[0m22:52:54.063999 [info ] [MainThread]: 
[0m22:52:54.065384 [error] [MainThread]:   Database Error in model staging_raw_sales_data (emekamarkt/models\staging_raw_sales_data.sql)
  syntax error at or near "FROM" in context "AS Shipping_Cost,
  FROM", at line 56, column 1
  compiled code at target\run\dbt_transformations\emekamarkt/models\staging_raw_sales_data.sql
[0m22:52:54.067394 [info ] [MainThread]: 
[0m22:52:54.068396 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m22:52:54.070391 [debug] [MainThread]: Command `dbt run` failed at 22:52:54.070391 after 4.59 seconds
[0m22:52:54.071395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002083C5BE410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208403665C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020840366650>]}
[0m22:52:54.072392 [debug] [MainThread]: Flushing usage events
[0m22:52:54.585122 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:53:24.873021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE4401E3E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE45F4D0F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE45F4CF10>]}


============================== 22:53:24.877397 | ba6f955d-977c-4877-b4b1-ef66313077e0 ==============================
[0m22:53:24.877397 [info ] [MainThread]: Running with dbt=1.9.0-b1
[0m22:53:24.879311 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\User\\Desktop\\dbt-Transformations\\logs', 'profiles_dir': 'C:\\Users\\User\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:53:25.046187 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m22:53:25.047193 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m22:53:25.210754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ba6f955d-977c-4877-b4b1-ef66313077e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE443BD1E0>]}
[0m22:53:25.265367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ba6f955d-977c-4877-b4b1-ef66313077e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE46683340>]}
[0m22:53:25.267373 [info ] [MainThread]: Registered adapter: redshift=1.8.1
[0m22:53:25.279364 [debug] [MainThread]: checksum: 342eadeaabeb3b1e51584f606df2b5b2518c39ec1d5d83f52b4bb1c68a4f38ed, vars: {}, profile: , target: , version: 1.9.0b1
[0m22:53:25.454359 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:53:25.456374 [debug] [MainThread]: Partial parsing: updated file: dbt_transformations://emekamarkt/models\staging_raw_sales_data.sql
[0m22:53:25.794520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ba6f955d-977c-4877-b4b1-ef66313077e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE46C8F340>]}
[0m22:53:25.870181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ba6f955d-977c-4877-b4b1-ef66313077e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE468387F0>]}
[0m22:53:25.871377 [info ] [MainThread]: Found 1 model, 489 macros
[0m22:53:25.872399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ba6f955d-977c-4877-b4b1-ef66313077e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE4683B6A0>]}
[0m22:53:25.874475 [info ] [MainThread]: 
[0m22:53:25.875586 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:53:25.876755 [info ] [MainThread]: 
[0m22:53:25.877758 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m22:53:25.880766 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev'
[0m22:53:25.902880 [debug] [ThreadPool]: Using redshift connection "list_dev"
[0m22:53:25.903868 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.9.0b1", "profile_name": "emekamarkt", "target_name": "dev", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
[0m22:53:25.904814 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:53:25.908869 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:53:25.909859 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m22:53:26.610926 [debug] [ThreadPool]: SQL status: SUCCESS in 0.707 seconds
[0m22:53:26.612980 [debug] [ThreadPool]: On list_dev: Close
[0m22:53:26.614934 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev_public'
[0m22:53:26.622935 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m22:53:26.622935 [debug] [ThreadPool]: On list_dev_public: BEGIN
[0m22:53:26.623949 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:53:26.624952 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:53:26.624952 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m22:53:27.108157 [debug] [ThreadPool]: SQL status: SUCCESS in 0.484 seconds
[0m22:53:27.110262 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m22:53:27.111273 [debug] [ThreadPool]: On list_dev_public: /* {"app": "dbt", "dbt_version": "1.9.0b1", "profile_name": "emekamarkt", "target_name": "dev", "connection_name": "list_dev_public"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'public'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'public'
[0m22:53:27.209513 [debug] [ThreadPool]: SQL status: SUCCESS in 0.096 seconds
[0m22:53:27.213627 [debug] [ThreadPool]: On list_dev_public: ROLLBACK
[0m22:53:27.290753 [debug] [ThreadPool]: On list_dev_public: Close
[0m22:53:27.304867 [debug] [MainThread]: Using redshift connection "master"
[0m22:53:27.305852 [debug] [MainThread]: On master: BEGIN
[0m22:53:27.305852 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:53:27.306762 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:53:27.307356 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m22:53:27.793926 [debug] [MainThread]: SQL status: SUCCESS in 0.488 seconds
[0m22:53:27.795957 [debug] [MainThread]: Using redshift connection "master"
[0m22:53:27.798037 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0b1", "profile_name": "emekamarkt", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m22:53:27.929439 [debug] [MainThread]: SQL status: SUCCESS in 0.130 seconds
[0m22:53:27.932342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ba6f955d-977c-4877-b4b1-ef66313077e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE47DD14E0>]}
[0m22:53:27.933351 [debug] [MainThread]: On master: ROLLBACK
[0m22:53:28.012372 [debug] [MainThread]: Using redshift connection "master"
[0m22:53:28.014483 [debug] [MainThread]: On master: BEGIN
[0m22:53:28.056000 [debug] [MainThread]: SQL status: SUCCESS in 0.040 seconds
[0m22:53:28.057975 [debug] [MainThread]: On master: COMMIT
[0m22:53:28.059972 [debug] [MainThread]: Using redshift connection "master"
[0m22:53:28.060973 [debug] [MainThread]: On master: COMMIT
[0m22:53:28.143749 [debug] [MainThread]: SQL status: SUCCESS in 0.082 seconds
[0m22:53:28.145833 [debug] [MainThread]: On master: Close
[0m22:53:28.153499 [debug] [Thread-1 (]: Began running node model.dbt_transformations.staging_raw_sales_data
[0m22:53:28.155007 [info ] [Thread-1 (]: 1 of 1 START sql view model public.staging_raw_sales_data ...................... [RUN]
[0m22:53:28.157019 [debug] [Thread-1 (]: Acquiring new redshift connection 'model.dbt_transformations.staging_raw_sales_data'
[0m22:53:28.158017 [debug] [Thread-1 (]: Began compiling node model.dbt_transformations.staging_raw_sales_data
[0m22:53:28.162015 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_transformations.staging_raw_sales_data"
[0m22:53:28.163016 [debug] [Thread-1 (]: Began executing node model.dbt_transformations.staging_raw_sales_data
[0m22:53:28.206114 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_transformations.staging_raw_sales_data"
[0m22:53:28.213101 [debug] [Thread-1 (]: Using redshift connection "model.dbt_transformations.staging_raw_sales_data"
[0m22:53:28.213101 [debug] [Thread-1 (]: On model.dbt_transformations.staging_raw_sales_data: BEGIN
[0m22:53:28.214108 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:53:28.215056 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:53:28.215056 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m22:53:28.681282 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.467 seconds
[0m22:53:28.684304 [debug] [Thread-1 (]: Using redshift connection "model.dbt_transformations.staging_raw_sales_data"
[0m22:53:28.686387 [debug] [Thread-1 (]: On model.dbt_transformations.staging_raw_sales_data: /* {"app": "dbt", "dbt_version": "1.9.0b1", "profile_name": "emekamarkt", "target_name": "dev", "node_id": "model.dbt_transformations.staging_raw_sales_data"} */


  create view "dev"."public"."staging_raw_sales_data__dbt_tmp" as (
    -- models/staging_raw_sales_data.sql



WITH raw_data AS (
    SELECT 
        *
    FROM 
        my_external_schema.external_table(  -- Make sure to reference the external schema here
            's3://emeka-market-raw-sales-data/raw_sales_data.csv',
            'arn:aws:iam::863518444424:role/service-role/AmazonRedshift-CommandsAccessRole-20241004T144721',
            'CSV',
            'IGNOREHEADER 1',
            'DELIMITER '',''',
            'REGION ''eu-north-1'''
        )
)

SELECT
    SaleID,
    ProductID,
    CustomerID,
    Quantity,
    Date,
    LocationID,
    PaymentID,
    ShippingID,
    PromotionID,
    ReviewID,
    JSON_EXTRACT_PATH_TEXT(Product, 'ProductID')::INT AS Product_ProductID,
    JSON_EXTRACT_PATH_TEXT(Product, 'ProductName') AS Product_ProductName,
    JSON_EXTRACT_PATH_TEXT(Product, 'Category') AS Product_Category,
    JSON_EXTRACT_PATH_TEXT(Product, 'UnitCost')::FLOAT AS Product_UnitCost,
    JSON_EXTRACT_PATH_TEXT(Product, 'UnitPrice')::FLOAT AS Product_UnitPrice,
    JSON_EXTRACT_PATH_TEXT(Customer, 'CustomerID')::INT AS Customer_CustomerID,
    JSON_EXTRACT_PATH_TEXT(Customer, 'CustomerName') AS Customer_CustomerName,
    JSON_EXTRACT_PATH_TEXT(Customer, 'Email') AS Customer_Email,
    JSON_EXTRACT_PATH_TEXT(Customer, 'PhoneNumber') AS Customer_PhoneNumber,
    JSON_EXTRACT_PATH_TEXT(Customer, 'LoyaltyStatus') AS Customer_LoyaltyStatus,
    JSON_EXTRACT_PATH_TEXT(Location, 'LocationID')::INT AS Location_LocationID,
    JSON_EXTRACT_PATH_TEXT(Location, 'Country') AS Location_Country,
    JSON_EXTRACT_PATH_TEXT(Location, 'State') AS Location_State,
    JSON_EXTRACT_PATH_TEXT(Location, 'City') AS Location_City,
    JSON_EXTRACT_PATH_TEXT(Location, 'PostalCode')::INT AS Location_PostalCode,
    JSON_EXTRACT_PATH_TEXT(Location, 'Region') AS Location_Region,
    JSON_EXTRACT_PATH_TEXT(Promotion, 'PromotionID')::INT AS Promotion_PromotionID,
    JSON_EXTRACT_PATH_TEXT(Promotion, 'PromotionName') AS Promotion_PromotionName,
    JSON_EXTRACT_PATH_TEXT(Promotion, 'DiscountRate')::FLOAT AS Promotion_DiscountRate,
    JSON_EXTRACT_PATH_TEXT(Shipping, 'ShippingID')::INT AS Shipping_ShippingID,
    JSON_EXTRACT_PATH_TEXT(Shipping, 'Method') AS Shipping_Method,
    JSON_EXTRACT_PATH_TEXT(Shipping, 'Cost')::FLOAT AS Shipping_Cost
FROM raw_data;  -- Ensure there's a semicolon here to close the statement
  ) ;
[0m22:53:28.726646 [debug] [Thread-1 (]: Redshift adapter: Redshift error: syntax error at or near ";" in context "Shipping_Cost
FROM raw_data;", at line 56, column 14
[0m22:53:28.727730 [debug] [Thread-1 (]: On model.dbt_transformations.staging_raw_sales_data: ROLLBACK
[0m22:53:28.809533 [debug] [Thread-1 (]: On model.dbt_transformations.staging_raw_sales_data: Close
[0m22:53:28.814596 [debug] [Thread-1 (]: Database Error in model staging_raw_sales_data (emekamarkt/models\staging_raw_sales_data.sql)
  syntax error at or near ";" in context "Shipping_Cost
  FROM raw_data;", at line 56, column 14
  compiled code at target\run\dbt_transformations\emekamarkt/models\staging_raw_sales_data.sql
[0m22:53:28.816600 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ba6f955d-977c-4877-b4b1-ef66313077e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE4693A6E0>]}
[0m22:53:28.817604 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model public.staging_raw_sales_data ............. [[31mERROR[0m in 0.66s]
[0m22:53:28.819517 [debug] [Thread-1 (]: Finished running node model.dbt_transformations.staging_raw_sales_data
[0m22:53:28.820521 [debug] [Thread-4 (]: Marking all children of 'model.dbt_transformations.staging_raw_sales_data' to be skipped because of status 'error'.  Reason: Database Error in model staging_raw_sales_data (emekamarkt/models\staging_raw_sales_data.sql)
  syntax error at or near ";" in context "Shipping_Cost
  FROM raw_data;", at line 56, column 14
  compiled code at target\run\dbt_transformations\emekamarkt/models\staging_raw_sales_data.sql.
[0m22:53:28.822513 [debug] [MainThread]: Using redshift connection "master"
[0m22:53:28.822513 [debug] [MainThread]: On master: BEGIN
[0m22:53:28.823518 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:53:28.824516 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:53:28.824516 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m22:53:29.301209 [debug] [MainThread]: SQL status: SUCCESS in 0.478 seconds
[0m22:53:29.303290 [debug] [MainThread]: On master: COMMIT
[0m22:53:29.305314 [debug] [MainThread]: Using redshift connection "master"
[0m22:53:29.305314 [debug] [MainThread]: On master: COMMIT
[0m22:53:29.383050 [debug] [MainThread]: SQL status: SUCCESS in 0.077 seconds
[0m22:53:29.385170 [debug] [MainThread]: On master: Close
[0m22:53:29.387162 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:53:29.389072 [debug] [MainThread]: Connection 'list_dev' was properly closed.
[0m22:53:29.390068 [debug] [MainThread]: Connection 'list_dev_public' was properly closed.
[0m22:53:29.391161 [debug] [MainThread]: Connection 'model.dbt_transformations.staging_raw_sales_data' was properly closed.
[0m22:53:29.392066 [info ] [MainThread]: 
[0m22:53:29.394109 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.51 seconds (3.51s).
[0m22:53:29.395065 [debug] [MainThread]: Command end result
[0m22:53:29.432576 [info ] [MainThread]: 
[0m22:53:29.433311 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successs, and 0 warnings:[0m
[0m22:53:29.434373 [info ] [MainThread]: 
[0m22:53:29.435319 [error] [MainThread]:   Database Error in model staging_raw_sales_data (emekamarkt/models\staging_raw_sales_data.sql)
  syntax error at or near ";" in context "Shipping_Cost
  FROM raw_data;", at line 56, column 14
  compiled code at target\run\dbt_transformations\emekamarkt/models\staging_raw_sales_data.sql
[0m22:53:29.438357 [info ] [MainThread]: 
[0m22:53:29.439327 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m22:53:29.441341 [debug] [MainThread]: Command `dbt run` failed at 22:53:29.441341 after 4.64 seconds
[0m22:53:29.442422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE4401E3E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE46BBB9A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE44392140>]}
[0m22:53:29.442422 [debug] [MainThread]: Flushing usage events
[0m22:53:29.973881 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:54:29.910189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC8266E350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC845ECB50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC845EC970>]}


============================== 22:54:29.915187 | 6509303a-71ed-4e8c-88d8-a4ae4da69aea ==============================
[0m22:54:29.915187 [info ] [MainThread]: Running with dbt=1.9.0-b1
[0m22:54:29.916185 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\User\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\User\\Desktop\\dbt-Transformations\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:54:30.081158 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m22:54:30.081158 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m22:54:30.237476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6509303a-71ed-4e8c-88d8-a4ae4da69aea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC84D2D150>]}
[0m22:54:30.296232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6509303a-71ed-4e8c-88d8-a4ae4da69aea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC84CD32B0>]}
[0m22:54:30.297333 [info ] [MainThread]: Registered adapter: redshift=1.8.1
[0m22:54:30.311234 [debug] [MainThread]: checksum: 342eadeaabeb3b1e51584f606df2b5b2518c39ec1d5d83f52b4bb1c68a4f38ed, vars: {}, profile: , target: , version: 1.9.0b1
[0m22:54:30.497168 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:54:30.498166 [debug] [MainThread]: Partial parsing: updated file: dbt_transformations://emekamarkt/models\staging_raw_sales_data.sql
[0m22:54:30.878305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6509303a-71ed-4e8c-88d8-a4ae4da69aea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC852597E0>]}
[0m22:54:30.958316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6509303a-71ed-4e8c-88d8-a4ae4da69aea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC851D1780>]}
[0m22:54:30.959303 [info ] [MainThread]: Found 1 model, 489 macros
[0m22:54:30.960400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6509303a-71ed-4e8c-88d8-a4ae4da69aea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC851D1630>]}
[0m22:54:30.962734 [info ] [MainThread]: 
[0m22:54:30.963735 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:54:30.964735 [info ] [MainThread]: 
[0m22:54:30.966734 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m22:54:30.968734 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev'
[0m22:54:30.989737 [debug] [ThreadPool]: Using redshift connection "list_dev"
[0m22:54:30.990738 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.9.0b1", "profile_name": "emekamarkt", "target_name": "dev", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
[0m22:54:30.990738 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:54:30.996737 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:54:30.998741 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m22:54:31.709997 [debug] [ThreadPool]: SQL status: SUCCESS in 0.719 seconds
[0m22:54:31.714116 [debug] [ThreadPool]: On list_dev: Close
[0m22:54:31.717015 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev_public'
[0m22:54:31.726102 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m22:54:31.727107 [debug] [ThreadPool]: On list_dev_public: BEGIN
[0m22:54:31.727107 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:54:31.728086 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:54:31.729049 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m22:54:32.213982 [debug] [ThreadPool]: SQL status: SUCCESS in 0.486 seconds
[0m22:54:32.215072 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m22:54:32.217081 [debug] [ThreadPool]: On list_dev_public: /* {"app": "dbt", "dbt_version": "1.9.0b1", "profile_name": "emekamarkt", "target_name": "dev", "connection_name": "list_dev_public"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'public'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'public'
[0m22:54:32.314513 [debug] [ThreadPool]: SQL status: SUCCESS in 0.096 seconds
[0m22:54:32.317417 [debug] [ThreadPool]: On list_dev_public: ROLLBACK
[0m22:54:32.396507 [debug] [ThreadPool]: On list_dev_public: Close
[0m22:54:32.412234 [debug] [MainThread]: Using redshift connection "master"
[0m22:54:32.413233 [debug] [MainThread]: On master: BEGIN
[0m22:54:32.414248 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:54:32.414248 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:54:32.415228 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m22:54:32.895315 [debug] [MainThread]: SQL status: SUCCESS in 0.481 seconds
[0m22:54:32.897454 [debug] [MainThread]: Using redshift connection "master"
[0m22:54:32.899422 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0b1", "profile_name": "emekamarkt", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m22:54:33.030596 [debug] [MainThread]: SQL status: SUCCESS in 0.130 seconds
[0m22:54:33.035710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6509303a-71ed-4e8c-88d8-a4ae4da69aea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC85201990>]}
[0m22:54:33.036717 [debug] [MainThread]: On master: ROLLBACK
[0m22:54:33.116364 [debug] [MainThread]: Using redshift connection "master"
[0m22:54:33.118279 [debug] [MainThread]: On master: BEGIN
[0m22:54:33.156886 [debug] [MainThread]: SQL status: SUCCESS in 0.038 seconds
[0m22:54:33.158597 [debug] [MainThread]: On master: COMMIT
[0m22:54:33.160703 [debug] [MainThread]: Using redshift connection "master"
[0m22:54:33.162615 [debug] [MainThread]: On master: COMMIT
[0m22:54:33.241558 [debug] [MainThread]: SQL status: SUCCESS in 0.077 seconds
[0m22:54:33.243589 [debug] [MainThread]: On master: Close
[0m22:54:33.253090 [debug] [Thread-1 (]: Began running node model.dbt_transformations.staging_raw_sales_data
[0m22:54:33.254195 [info ] [Thread-1 (]: 1 of 1 START sql view model public.staging_raw_sales_data ...................... [RUN]
[0m22:54:33.257180 [debug] [Thread-1 (]: Acquiring new redshift connection 'model.dbt_transformations.staging_raw_sales_data'
[0m22:54:33.257180 [debug] [Thread-1 (]: Began compiling node model.dbt_transformations.staging_raw_sales_data
[0m22:54:33.262767 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_transformations.staging_raw_sales_data"
[0m22:54:33.263726 [debug] [Thread-1 (]: Began executing node model.dbt_transformations.staging_raw_sales_data
[0m22:54:33.305787 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_transformations.staging_raw_sales_data"
[0m22:54:33.309712 [debug] [Thread-1 (]: Using redshift connection "model.dbt_transformations.staging_raw_sales_data"
[0m22:54:33.310698 [debug] [Thread-1 (]: On model.dbt_transformations.staging_raw_sales_data: BEGIN
[0m22:54:33.311741 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:54:33.311741 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:54:33.312789 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m22:54:33.791678 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.480 seconds
[0m22:54:33.793784 [debug] [Thread-1 (]: Using redshift connection "model.dbt_transformations.staging_raw_sales_data"
[0m22:54:33.797786 [debug] [Thread-1 (]: On model.dbt_transformations.staging_raw_sales_data: /* {"app": "dbt", "dbt_version": "1.9.0b1", "profile_name": "emekamarkt", "target_name": "dev", "node_id": "model.dbt_transformations.staging_raw_sales_data"} */


  create view "dev"."public"."staging_raw_sales_data__dbt_tmp" as (
    -- models/staging_raw_sales_data.sql



WITH raw_data AS (
    SELECT 
        *
    FROM 
        my_external_schema.external_table(  -- Make sure to reference the external schema here
            's3://emeka-market-raw-sales-data/raw_sales_data.csv',
            'arn:aws:iam::863518444424:role/service-role/AmazonRedshift-CommandsAccessRole-20241004T144721',
            'CSV',
            'IGNOREHEADER 1',
            'DELIMITER '',''',
            'REGION ''eu-north-1'''
        )
)

SELECT * FROM raw_data
  ) ;
[0m22:54:33.837134 [debug] [Thread-1 (]: Redshift adapter: Redshift error: function my_external_schema.external_table("unknown", "unknown", "unknown", "unknown", "unknown", "unknown") does not exist
[0m22:54:33.839212 [debug] [Thread-1 (]: On model.dbt_transformations.staging_raw_sales_data: ROLLBACK
[0m22:54:33.911864 [debug] [Thread-1 (]: On model.dbt_transformations.staging_raw_sales_data: Close
[0m22:54:33.914809 [debug] [Thread-1 (]: Database Error in model staging_raw_sales_data (emekamarkt/models\staging_raw_sales_data.sql)
  function my_external_schema.external_table("unknown", "unknown", "unknown", "unknown", "unknown", "unknown") does not exist
  compiled code at target\run\dbt_transformations\emekamarkt/models\staging_raw_sales_data.sql
[0m22:54:33.916749 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6509303a-71ed-4e8c-88d8-a4ae4da69aea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC84D6B6A0>]}
[0m22:54:33.917820 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model public.staging_raw_sales_data ............. [[31mERROR[0m in 0.66s]
[0m22:54:33.922835 [debug] [Thread-1 (]: Finished running node model.dbt_transformations.staging_raw_sales_data
[0m22:54:33.923731 [debug] [Thread-4 (]: Marking all children of 'model.dbt_transformations.staging_raw_sales_data' to be skipped because of status 'error'.  Reason: Database Error in model staging_raw_sales_data (emekamarkt/models\staging_raw_sales_data.sql)
  function my_external_schema.external_table("unknown", "unknown", "unknown", "unknown", "unknown", "unknown") does not exist
  compiled code at target\run\dbt_transformations\emekamarkt/models\staging_raw_sales_data.sql.
[0m22:54:33.926723 [debug] [MainThread]: Using redshift connection "master"
[0m22:54:33.927722 [debug] [MainThread]: On master: BEGIN
[0m22:54:33.927722 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:54:33.928828 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:54:33.929823 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m22:54:34.405247 [debug] [MainThread]: SQL status: SUCCESS in 0.477 seconds
[0m22:54:34.406119 [debug] [MainThread]: On master: COMMIT
[0m22:54:34.407206 [debug] [MainThread]: Using redshift connection "master"
[0m22:54:34.408183 [debug] [MainThread]: On master: COMMIT
[0m22:54:34.489765 [debug] [MainThread]: SQL status: SUCCESS in 0.082 seconds
[0m22:54:34.491900 [debug] [MainThread]: On master: Close
[0m22:54:34.493870 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:54:34.495877 [debug] [MainThread]: Connection 'list_dev' was properly closed.
[0m22:54:34.496875 [debug] [MainThread]: Connection 'list_dev_public' was properly closed.
[0m22:54:34.497794 [debug] [MainThread]: Connection 'model.dbt_transformations.staging_raw_sales_data' was properly closed.
[0m22:54:34.499829 [info ] [MainThread]: 
[0m22:54:34.500517 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.53 seconds (3.53s).
[0m22:54:34.502527 [debug] [MainThread]: Command end result
[0m22:54:34.536550 [info ] [MainThread]: 
[0m22:54:34.537588 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successs, and 0 warnings:[0m
[0m22:54:34.538529 [info ] [MainThread]: 
[0m22:54:34.540135 [error] [MainThread]:   Database Error in model staging_raw_sales_data (emekamarkt/models\staging_raw_sales_data.sql)
  function my_external_schema.external_table("unknown", "unknown", "unknown", "unknown", "unknown", "unknown") does not exist
  compiled code at target\run\dbt_transformations\emekamarkt/models\staging_raw_sales_data.sql
[0m22:54:34.544167 [info ] [MainThread]: 
[0m22:54:34.545171 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m22:54:34.548176 [debug] [MainThread]: Command `dbt run` failed at 22:54:34.547168 after 4.71 seconds
[0m22:54:34.549178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC8266E350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC84F76F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC84F76530>]}
[0m22:54:34.549178 [debug] [MainThread]: Flushing usage events
[0m22:54:35.051307 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:58:06.407923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9E8DCE410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9EACFD180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9EACFCFA0>]}


============================== 22:58:06.412012 | fa086fc3-e01e-433a-98de-e848c7f62ad0 ==============================
[0m22:58:06.412012 [info ] [MainThread]: Running with dbt=1.9.0-b1
[0m22:58:06.412984 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\User\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\User\\Desktop\\dbt-Transformations\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:58:06.570184 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m22:58:06.571291 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m22:58:06.732149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fa086fc3-e01e-433a-98de-e848c7f62ad0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9E767EBC0>]}
[0m22:58:06.785951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fa086fc3-e01e-433a-98de-e848c7f62ad0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9EB433370>]}
[0m22:58:06.787665 [info ] [MainThread]: Registered adapter: redshift=1.8.1
[0m22:58:06.800337 [debug] [MainThread]: checksum: 342eadeaabeb3b1e51584f606df2b5b2518c39ec1d5d83f52b4bb1c68a4f38ed, vars: {}, profile: , target: , version: 1.9.0b1
[0m22:58:06.988311 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:58:06.989223 [debug] [MainThread]: Partial parsing: updated file: dbt_transformations://emekamarkt/models\staging_raw_sales_data.sql
[0m22:58:07.323860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fa086fc3-e01e-433a-98de-e848c7f62ad0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9EAC7BF40>]}
[0m22:58:07.399905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fa086fc3-e01e-433a-98de-e848c7f62ad0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9EB966560>]}
[0m22:58:07.399905 [info ] [MainThread]: Found 1 model, 489 macros
[0m22:58:07.401911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fa086fc3-e01e-433a-98de-e848c7f62ad0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9EB965EA0>]}
[0m22:58:07.402916 [info ] [MainThread]: 
[0m22:58:07.404911 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:58:07.408482 [info ] [MainThread]: 
[0m22:58:07.409476 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m22:58:07.412476 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev'
[0m22:58:07.433795 [debug] [ThreadPool]: Using redshift connection "list_dev"
[0m22:58:07.434725 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.9.0b1", "profile_name": "emekamarkt", "target_name": "dev", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
[0m22:58:07.434725 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:58:07.439731 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:58:07.440844 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m22:58:08.217219 [debug] [ThreadPool]: SQL status: SUCCESS in 0.783 seconds
[0m22:58:08.219124 [debug] [ThreadPool]: On list_dev: Close
[0m22:58:08.222106 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev_public'
[0m22:58:08.229102 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m22:58:08.230113 [debug] [ThreadPool]: On list_dev_public: BEGIN
[0m22:58:08.231105 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:58:08.231105 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:58:08.232104 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m22:58:08.724077 [debug] [ThreadPool]: SQL status: SUCCESS in 0.493 seconds
[0m22:58:08.726218 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m22:58:08.728186 [debug] [ThreadPool]: On list_dev_public: /* {"app": "dbt", "dbt_version": "1.9.0b1", "profile_name": "emekamarkt", "target_name": "dev", "connection_name": "list_dev_public"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'public'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'public'
[0m22:58:08.825664 [debug] [ThreadPool]: SQL status: SUCCESS in 0.096 seconds
[0m22:58:08.829655 [debug] [ThreadPool]: On list_dev_public: ROLLBACK
[0m22:58:08.904505 [debug] [ThreadPool]: On list_dev_public: Close
[0m22:58:08.917495 [debug] [MainThread]: Using redshift connection "master"
[0m22:58:08.918497 [debug] [MainThread]: On master: BEGIN
[0m22:58:08.918497 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:58:08.919496 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:58:08.920497 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m22:58:09.386363 [debug] [MainThread]: SQL status: SUCCESS in 0.467 seconds
[0m22:58:09.388484 [debug] [MainThread]: Using redshift connection "master"
[0m22:58:09.390398 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0b1", "profile_name": "emekamarkt", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m22:58:09.527014 [debug] [MainThread]: SQL status: SUCCESS in 0.136 seconds
[0m22:58:09.530033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fa086fc3-e01e-433a-98de-e848c7f62ad0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9EB860D90>]}
[0m22:58:09.531108 [debug] [MainThread]: On master: ROLLBACK
[0m22:58:09.608673 [debug] [MainThread]: Using redshift connection "master"
[0m22:58:09.609751 [debug] [MainThread]: On master: BEGIN
[0m22:58:09.649402 [debug] [MainThread]: SQL status: SUCCESS in 0.037 seconds
[0m22:58:09.650396 [debug] [MainThread]: On master: COMMIT
[0m22:58:09.652308 [debug] [MainThread]: Using redshift connection "master"
[0m22:58:09.653314 [debug] [MainThread]: On master: COMMIT
[0m22:58:09.733087 [debug] [MainThread]: SQL status: SUCCESS in 0.078 seconds
[0m22:58:09.734083 [debug] [MainThread]: On master: Close
[0m22:58:09.742479 [debug] [Thread-1 (]: Began running node model.dbt_transformations.staging_raw_sales_data
[0m22:58:09.743554 [info ] [Thread-1 (]: 1 of 1 START sql view model public.staging_raw_sales_data ...................... [RUN]
[0m22:58:09.744472 [debug] [Thread-1 (]: Acquiring new redshift connection 'model.dbt_transformations.staging_raw_sales_data'
[0m22:58:09.745514 [debug] [Thread-1 (]: Began compiling node model.dbt_transformations.staging_raw_sales_data
[0m22:58:09.749570 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_transformations.staging_raw_sales_data"
[0m22:58:09.751485 [debug] [Thread-1 (]: Began executing node model.dbt_transformations.staging_raw_sales_data
[0m22:58:09.790199 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_transformations.staging_raw_sales_data"
[0m22:58:09.793182 [debug] [Thread-1 (]: Using redshift connection "model.dbt_transformations.staging_raw_sales_data"
[0m22:58:09.794178 [debug] [Thread-1 (]: On model.dbt_transformations.staging_raw_sales_data: BEGIN
[0m22:58:09.795181 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:58:09.796198 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:58:09.797181 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m22:58:10.281683 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.486 seconds
[0m22:58:10.282784 [debug] [Thread-1 (]: Using redshift connection "model.dbt_transformations.staging_raw_sales_data"
[0m22:58:10.284696 [debug] [Thread-1 (]: On model.dbt_transformations.staging_raw_sales_data: /* {"app": "dbt", "dbt_version": "1.9.0b1", "profile_name": "emekamarkt", "target_name": "dev", "node_id": "model.dbt_transformations.staging_raw_sales_data"} */


  create view "dev"."public"."staging_raw_sales_data__dbt_tmp" as (
    -- models/staging_raw_sales_data.sql



SELECT *
FROM information_schema.schemata
WHERE schema_name = 'my_external_schema';
  ) ;
[0m22:58:10.329707 [debug] [Thread-1 (]: Redshift adapter: Redshift error: syntax error at or near ";" in context "WHERE schema_name = 'my_external_schema';", at line 11, column 41
[0m22:58:10.330787 [debug] [Thread-1 (]: On model.dbt_transformations.staging_raw_sales_data: ROLLBACK
[0m22:58:10.410919 [debug] [Thread-1 (]: On model.dbt_transformations.staging_raw_sales_data: Close
[0m22:58:10.413950 [debug] [Thread-1 (]: Database Error in model staging_raw_sales_data (emekamarkt/models\staging_raw_sales_data.sql)
  syntax error at or near ";" in context "WHERE schema_name = 'my_external_schema';", at line 11, column 41
  compiled code at target\run\dbt_transformations\emekamarkt/models\staging_raw_sales_data.sql
[0m22:58:10.416015 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fa086fc3-e01e-433a-98de-e848c7f62ad0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9EB4CB6A0>]}
[0m22:58:10.416974 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model public.staging_raw_sales_data ............. [[31mERROR[0m in 0.67s]
[0m22:58:10.417928 [debug] [Thread-1 (]: Finished running node model.dbt_transformations.staging_raw_sales_data
[0m22:58:10.419010 [debug] [Thread-4 (]: Marking all children of 'model.dbt_transformations.staging_raw_sales_data' to be skipped because of status 'error'.  Reason: Database Error in model staging_raw_sales_data (emekamarkt/models\staging_raw_sales_data.sql)
  syntax error at or near ";" in context "WHERE schema_name = 'my_external_schema';", at line 11, column 41
  compiled code at target\run\dbt_transformations\emekamarkt/models\staging_raw_sales_data.sql.
[0m22:58:10.421926 [debug] [MainThread]: Using redshift connection "master"
[0m22:58:10.421926 [debug] [MainThread]: On master: BEGIN
[0m22:58:10.422926 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:58:10.422926 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:58:10.423927 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m22:58:10.879540 [debug] [MainThread]: SQL status: SUCCESS in 0.457 seconds
[0m22:58:10.880659 [debug] [MainThread]: On master: COMMIT
[0m22:58:10.883319 [debug] [MainThread]: Using redshift connection "master"
[0m22:58:10.884281 [debug] [MainThread]: On master: COMMIT
[0m22:58:10.963824 [debug] [MainThread]: SQL status: SUCCESS in 0.079 seconds
[0m22:58:10.965716 [debug] [MainThread]: On master: Close
[0m22:58:10.967735 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:58:10.969736 [debug] [MainThread]: Connection 'list_dev' was properly closed.
[0m22:58:10.970737 [debug] [MainThread]: Connection 'list_dev_public' was properly closed.
[0m22:58:10.971736 [debug] [MainThread]: Connection 'model.dbt_transformations.staging_raw_sales_data' was properly closed.
[0m22:58:10.972732 [info ] [MainThread]: 
[0m22:58:10.974732 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.56 seconds (3.56s).
[0m22:58:10.976730 [debug] [MainThread]: Command end result
[0m22:58:11.010234 [info ] [MainThread]: 
[0m22:58:11.012437 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successs, and 0 warnings:[0m
[0m22:58:11.013449 [info ] [MainThread]: 
[0m22:58:11.014445 [error] [MainThread]:   Database Error in model staging_raw_sales_data (emekamarkt/models\staging_raw_sales_data.sql)
  syntax error at or near ";" in context "WHERE schema_name = 'my_external_schema';", at line 11, column 41
  compiled code at target\run\dbt_transformations\emekamarkt/models\staging_raw_sales_data.sql
[0m22:58:11.015443 [info ] [MainThread]: 
[0m22:58:11.017450 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m22:58:11.020499 [debug] [MainThread]: Command `dbt run` failed at 22:58:11.019542 after 4.69 seconds
[0m22:58:11.021447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9E8DCE410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9ECB765F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9ECB766B0>]}
[0m22:58:11.022446 [debug] [MainThread]: Flushing usage events
[0m22:58:11.529267 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:00:21.029378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E597BAE3E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E599ADD0F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E599ADCF10>]}


============================== 23:00:21.034388 | 7fa08a6d-2c84-42fd-90c7-c6f1f3e47a04 ==============================
[0m23:00:21.034388 [info ] [MainThread]: Running with dbt=1.9.0-b1
[0m23:00:21.035292 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\User\\Desktop\\dbt-Transformations\\logs', 'profiles_dir': 'C:\\Users\\User\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:00:21.207964 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m23:00:21.208947 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m23:00:21.371838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7fa08a6d-2c84-42fd-90c7-c6f1f3e47a04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E597F4E7D0>]}
[0m23:00:21.424346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7fa08a6d-2c84-42fd-90c7-c6f1f3e47a04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E59A213340>]}
[0m23:00:21.426346 [info ] [MainThread]: Registered adapter: redshift=1.8.1
[0m23:00:21.437350 [debug] [MainThread]: checksum: 342eadeaabeb3b1e51584f606df2b5b2518c39ec1d5d83f52b4bb1c68a4f38ed, vars: {}, profile: , target: , version: 1.9.0b1
[0m23:00:21.629524 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:00:21.630524 [debug] [MainThread]: Partial parsing: updated file: dbt_transformations://emekamarkt/models\staging_raw_sales_data.sql
[0m23:00:22.012419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7fa08a6d-2c84-42fd-90c7-c6f1f3e47a04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E59A823340>]}
[0m23:00:22.088609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7fa08a6d-2c84-42fd-90c7-c6f1f3e47a04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E59A3C87F0>]}
[0m23:00:22.089614 [info ] [MainThread]: Found 1 model, 489 macros
[0m23:00:22.090612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7fa08a6d-2c84-42fd-90c7-c6f1f3e47a04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E59A3CB6A0>]}
[0m23:00:22.092611 [info ] [MainThread]: 
[0m23:00:22.094621 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:00:22.095611 [info ] [MainThread]: 
[0m23:00:22.096635 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m23:00:22.098610 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev'
[0m23:00:22.115628 [debug] [ThreadPool]: Using redshift connection "list_dev"
[0m23:00:22.117649 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.9.0b1", "profile_name": "emekamarkt", "target_name": "dev", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
[0m23:00:22.118617 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:00:22.123722 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m23:00:22.125609 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m23:00:22.876122 [debug] [ThreadPool]: SQL status: SUCCESS in 0.758 seconds
[0m23:00:22.879661 [debug] [ThreadPool]: On list_dev: Close
[0m23:00:22.882474 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev_public'
[0m23:00:22.891486 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m23:00:22.892480 [debug] [ThreadPool]: On list_dev_public: BEGIN
[0m23:00:22.892480 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:00:22.893479 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m23:00:22.894491 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m23:00:23.356378 [debug] [ThreadPool]: SQL status: SUCCESS in 0.463 seconds
[0m23:00:23.358369 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m23:00:23.359423 [debug] [ThreadPool]: On list_dev_public: /* {"app": "dbt", "dbt_version": "1.9.0b1", "profile_name": "emekamarkt", "target_name": "dev", "connection_name": "list_dev_public"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'public'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'public'
[0m23:00:23.461760 [debug] [ThreadPool]: SQL status: SUCCESS in 0.101 seconds
[0m23:00:23.463771 [debug] [ThreadPool]: On list_dev_public: ROLLBACK
[0m23:00:23.548584 [debug] [ThreadPool]: On list_dev_public: Close
[0m23:00:23.564895 [debug] [MainThread]: Using redshift connection "master"
[0m23:00:23.565904 [debug] [MainThread]: On master: BEGIN
[0m23:00:23.565904 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:00:23.566961 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m23:00:23.566961 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m23:00:24.067852 [debug] [MainThread]: SQL status: SUCCESS in 0.502 seconds
[0m23:00:24.069956 [debug] [MainThread]: Using redshift connection "master"
[0m23:00:24.070970 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0b1", "profile_name": "emekamarkt", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m23:00:24.203971 [debug] [MainThread]: SQL status: SUCCESS in 0.131 seconds
[0m23:00:24.209075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7fa08a6d-2c84-42fd-90c7-c6f1f3e47a04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E59B9654B0>]}
[0m23:00:24.210079 [debug] [MainThread]: On master: ROLLBACK
[0m23:00:24.291059 [debug] [MainThread]: Using redshift connection "master"
[0m23:00:24.293053 [debug] [MainThread]: On master: BEGIN
[0m23:00:24.334737 [debug] [MainThread]: SQL status: SUCCESS in 0.040 seconds
[0m23:00:24.336764 [debug] [MainThread]: On master: COMMIT
[0m23:00:24.337855 [debug] [MainThread]: Using redshift connection "master"
[0m23:00:24.339843 [debug] [MainThread]: On master: COMMIT
[0m23:00:24.423947 [debug] [MainThread]: SQL status: SUCCESS in 0.083 seconds
[0m23:00:24.426055 [debug] [MainThread]: On master: Close
[0m23:00:24.431966 [debug] [Thread-1 (]: Began running node model.dbt_transformations.staging_raw_sales_data
[0m23:00:24.433070 [info ] [Thread-1 (]: 1 of 1 START sql view model public.staging_raw_sales_data ...................... [RUN]
[0m23:00:24.434966 [debug] [Thread-1 (]: Acquiring new redshift connection 'model.dbt_transformations.staging_raw_sales_data'
[0m23:00:24.435967 [debug] [Thread-1 (]: Began compiling node model.dbt_transformations.staging_raw_sales_data
[0m23:00:24.439069 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_transformations.staging_raw_sales_data"
[0m23:00:24.440066 [debug] [Thread-1 (]: Began executing node model.dbt_transformations.staging_raw_sales_data
[0m23:00:24.484608 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_transformations.staging_raw_sales_data"
[0m23:00:24.486598 [debug] [Thread-1 (]: Using redshift connection "model.dbt_transformations.staging_raw_sales_data"
[0m23:00:24.487681 [debug] [Thread-1 (]: On model.dbt_transformations.staging_raw_sales_data: BEGIN
[0m23:00:24.488645 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:00:24.488645 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m23:00:24.489594 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m23:00:24.958737 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.471 seconds
[0m23:00:24.960845 [debug] [Thread-1 (]: Using redshift connection "model.dbt_transformations.staging_raw_sales_data"
[0m23:00:24.962787 [debug] [Thread-1 (]: On model.dbt_transformations.staging_raw_sales_data: /* {"app": "dbt", "dbt_version": "1.9.0b1", "profile_name": "emekamarkt", "target_name": "dev", "node_id": "model.dbt_transformations.staging_raw_sales_data"} */


  create view "dev"."public"."staging_raw_sales_data__dbt_tmp" as (
    -- models/staging_raw_sales_data.sql



WITH raw_data AS (
    SELECT *
    FROM my_external_schema."external_table"(  -- Note the quotes around the function name
        's3://emeka-market-raw-sales-data/raw_sales_data.csv',
        'arn:aws:iam::863518444424:role/service-role/AmazonRedshift-CommandsAccessRole-20241004T144721',
        'CSV',
        'IGNOREHEADER 1',
        'DELIMITER '',''',
        'REGION ''eu-north-1'''
    )
)

SELECT * FROM raw_data;
  ) ;
[0m23:00:25.005026 [debug] [Thread-1 (]: Redshift adapter: Redshift error: syntax error at or near ";" in context "* FROM raw_data;", at line 21, column 23
[0m23:00:25.007019 [debug] [Thread-1 (]: On model.dbt_transformations.staging_raw_sales_data: ROLLBACK
[0m23:00:25.087129 [debug] [Thread-1 (]: On model.dbt_transformations.staging_raw_sales_data: Close
[0m23:00:25.093130 [debug] [Thread-1 (]: Database Error in model staging_raw_sales_data (emekamarkt/models\staging_raw_sales_data.sql)
  syntax error at or near ";" in context "* FROM raw_data;", at line 21, column 23
  compiled code at target\run\dbt_transformations\emekamarkt/models\staging_raw_sales_data.sql
[0m23:00:25.095114 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7fa08a6d-2c84-42fd-90c7-c6f1f3e47a04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E59A4CA6E0>]}
[0m23:00:25.097028 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model public.staging_raw_sales_data ............. [[31mERROR[0m in 0.66s]
[0m23:00:25.098045 [debug] [Thread-1 (]: Finished running node model.dbt_transformations.staging_raw_sales_data
[0m23:00:25.099027 [debug] [Thread-4 (]: Marking all children of 'model.dbt_transformations.staging_raw_sales_data' to be skipped because of status 'error'.  Reason: Database Error in model staging_raw_sales_data (emekamarkt/models\staging_raw_sales_data.sql)
  syntax error at or near ";" in context "* FROM raw_data;", at line 21, column 23
  compiled code at target\run\dbt_transformations\emekamarkt/models\staging_raw_sales_data.sql.
[0m23:00:25.100983 [debug] [MainThread]: Using redshift connection "master"
[0m23:00:25.102075 [debug] [MainThread]: On master: BEGIN
[0m23:00:25.102075 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:00:25.103085 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m23:00:25.104075 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m23:00:25.565232 [debug] [MainThread]: SQL status: SUCCESS in 0.462 seconds
[0m23:00:25.566316 [debug] [MainThread]: On master: COMMIT
[0m23:00:25.568231 [debug] [MainThread]: Using redshift connection "master"
[0m23:00:25.569336 [debug] [MainThread]: On master: COMMIT
[0m23:00:25.656713 [debug] [MainThread]: SQL status: SUCCESS in 0.087 seconds
[0m23:00:25.657711 [debug] [MainThread]: On master: Close
[0m23:00:25.660709 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:00:25.661706 [debug] [MainThread]: Connection 'list_dev' was properly closed.
[0m23:00:25.662707 [debug] [MainThread]: Connection 'list_dev_public' was properly closed.
[0m23:00:25.663707 [debug] [MainThread]: Connection 'model.dbt_transformations.staging_raw_sales_data' was properly closed.
[0m23:00:25.664704 [info ] [MainThread]: 
[0m23:00:25.665900 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.57 seconds (3.57s).
[0m23:00:25.667016 [debug] [MainThread]: Command end result
[0m23:00:25.702878 [info ] [MainThread]: 
[0m23:00:25.703891 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successs, and 0 warnings:[0m
[0m23:00:25.705885 [info ] [MainThread]: 
[0m23:00:25.706889 [error] [MainThread]:   Database Error in model staging_raw_sales_data (emekamarkt/models\staging_raw_sales_data.sql)
  syntax error at or near ";" in context "* FROM raw_data;", at line 21, column 23
  compiled code at target\run\dbt_transformations\emekamarkt/models\staging_raw_sales_data.sql
[0m23:00:25.707931 [info ] [MainThread]: 
[0m23:00:25.709895 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m23:00:25.711887 [debug] [MainThread]: Command `dbt run` failed at 23:00:25.710890 after 4.75 seconds
[0m23:00:25.711887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E597BAE3E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E59A74B5B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E597F4E7D0>]}
[0m23:00:25.712893 [debug] [MainThread]: Flushing usage events
[0m23:00:26.215292 [debug] [MainThread]: An error was encountered while trying to flush usage events
